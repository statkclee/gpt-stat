<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko-KR" xml:lang="ko-KR"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.288">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="이광춘">
<title>GPT 통계 - 2&nbsp; 데이터베이스</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./cs_prussia.html" rel="next">
<link href="./data_mgmt.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./database_mgmt.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">데이터베이스</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">GPT 통계</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서문</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_mgmt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">데이터 관리 방법론</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./database_mgmt.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">데이터베이스</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">사례연구</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cs_prussia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">프로이센 기병</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">출판</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">중심극한정리 예시</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">참고문헌</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">목차</h2>
   
  <ul>
<li>
<a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EA%B8%B0%EB%B3%B8%EC%86%8C%EC%96%91" id="toc-데이터베이스-기본소양" class="nav-link active" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EA%B8%B0%EB%B3%B8%EC%86%8C%EC%96%91"><span class="header-section-number">2.1</span> 데이터베이스 기본소양</a>
  <ul class="collapse">
<li><a href="#classify-data" id="toc-classify-data" class="nav-link" data-scroll-target="#classify-data"><span class="header-section-number">2.1.1</span> 데이터 구분</a></li>
  <li><a href="#oltp-vs-olap" id="toc-oltp-vs-olap" class="nav-link" data-scroll-target="#oltp-vs-olap"><span class="header-section-number">2.1.2</span> OLTP vs.&nbsp;OLAP</a></li>
  <li><a href="#database-warehouse-lake" id="toc-database-warehouse-lake" class="nav-link" data-scroll-target="#database-warehouse-lake"><span class="header-section-number">2.1.3</span> DW, 데이터 호수</a></li>
  <li><a href="#etl-vs-elt" id="toc-etl-vs-elt" class="nav-link" data-scroll-target="#etl-vs-elt"><span class="header-section-number">2.1.4</span> ETL과 ELT</a></li>
  <li><a href="#database-integration" id="toc-database-integration" class="nav-link" data-scroll-target="#database-integration"><span class="header-section-number">2.1.5</span> 데이터 통합(integration)</a></li>
  <li><a href="#table-partition" id="toc-table-partition" class="nav-link" data-scroll-target="#table-partition"><span class="header-section-number">2.1.6</span> 테이블 분할과 샤딩</a></li>
  </ul>
</li>
  <li>
<a href="#db-design" id="toc-db-design" class="nav-link" data-scroll-target="#db-design"><span class="header-section-number">2.2</span> 데이터베이스 설계</a>
  <ul class="collapse">
<li><a href="#db-design-in-practice" id="toc-db-design-in-practice" class="nav-link" data-scroll-target="#db-design-in-practice"><span class="header-section-number">2.2.1</span> 데이터 모형(Data Modeling)</a></li>
  <li><a href="#data-normalization" id="toc-data-normalization" class="nav-link" data-scroll-target="#data-normalization"><span class="header-section-number">2.2.2</span> 데이터 정규화 </a></li>
  </ul>
</li>
  <li>
<a href="#dimensional-modeling" id="toc-dimensional-modeling" class="nav-link" data-scroll-target="#dimensional-modeling"><span class="header-section-number">2.3</span> OLAP 차원 모델링 </a>
  <ul class="collapse">
<li><a href="#star-schema" id="toc-star-schema" class="nav-link" data-scroll-target="#star-schema"><span class="header-section-number">2.3.1</span> 스타 스키마</a></li>
  </ul>
</li>
  <li>
<a href="#chinook-database" id="toc-chinook-database" class="nav-link" data-scroll-target="#chinook-database"><span class="header-section-number">2.4</span> <code>chinook</code> 데이터베이스</a>
  <ul class="collapse">
<li><a href="#chinook-database-erd" id="toc-chinook-database-erd" class="nav-link" data-scroll-target="#chinook-database-erd"><span class="header-section-number">2.4.1</span> <code>chinook</code> ERD</a></li>
  <li><a href="#chinook-helloworld" id="toc-chinook-helloworld" class="nav-link" data-scroll-target="#chinook-helloworld"><span class="header-section-number">2.4.2</span> 헬로 월드</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">데이터베이스</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="데이터베이스-기본소양" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="데이터베이스-기본소양">
<span class="header-section-number">2.1</span> 데이터베이스 기본소양</h2>
<section id="classify-data" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="classify-data">
<span class="header-section-number">2.1.1</span> 데이터 구분</h3>
<p>데이터는 정형데이터(RDBMS), 비정형 데이터, 반정형 데이터로 크게 나눌 수 있다. 각 자료형에 따라 장단점이 있는 것은 명확하다. 정형데이터는 분석하기 용이한 반면 확장성과 유연성이 떨어지고, 비정형 데이터는 분석하기는 다소 어려움이 있으나 확장성과 용이성에서는 장점을 갖는다. <code>.csv</code>, <code>.xml</code>, <code>.json</code> 파일은 그 중간적인 특성을 갖는 반정형 데이터로 분류도힌다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_classification.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="정형, 반정형, 비정형 데이터"><img src="images/database_classification.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">정형, 반정형, 비정형 데이터</figcaption></figure>
</div>
</section><section id="oltp-vs-olap" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="oltp-vs-olap">
<span class="header-section-number">2.1.2</span> OLTP vs.&nbsp;OLAP</h3>
<p><strong>OLTP</strong> (OnLine Transaction Processing)는 데이터 자체 처리에 중점을 둔 개념인데 반해, <strong>OLAP</strong> (OnLine Analytical Processing)은 저장된 데이터를 분석하여 꿰뚤어 볼 수 있는 능력(Insight)를 도출하는데 중심을 두고 있다.</p>
<p>OLAP의 대표적인 예로 편의점 판매시점 정보관리(Point-Of-Sales, POS) 기계를 들어보자. 편의점에서 물건을 구매한 경우 다음과 같은 거래가 발생된다.</p>
<ul>
<li>고객 카드에서 현금 10,000원 인출</li>
<li>편의점 통장에 10,000 지급</li>
<li>명세표 출력</li>
</ul>
<p>상기 3건의 작업 프로세스가 하나의 트랜잭션(transaction) 묶어 모두 성공적으로 처리가 되어야 편의점 물건구매가 완료되도록 개발한다.</p>
<p>반면에 OLAP은 데이터를 체계적으로 저장하여 데이터에 기반한 의사결정지원을 할 수 있도록 주안점을 두고 있다.</p>
<table class="table">
<colgroup>
<col style="width: 19%">
<col style="width: 40%">
<col style="width: 40%">
</colgroup>
<thead><tr class="header">
<th></th>
<th style="text-align: left;">OLAP</th>
<th style="text-align: left;">OLTP</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>목적</td>
<td style="text-align: left;">트랜젝션 처리</td>
<td style="text-align: left;">데이터 분석과 보고서 작성, 대쉬보드 시각화</td>
</tr>
<tr class="even">
<td>설계</td>
<td style="text-align: left;">앱 기능 지향</td>
<td style="text-align: left;">비즈니스 주제 지향</td>
</tr>
<tr class="odd">
<td>데이터</td>
<td style="text-align: left;">운영계, 실시간 최신 데이터</td>
<td style="text-align: left;">정보계, 통합/이력 데이터</td>
</tr>
<tr class="even">
<td>크기</td>
<td style="text-align: left;">기가 바이트, 스냅샷</td>
<td style="text-align: left;">테라데이터, 아카이브</td>
</tr>
<tr class="odd">
<td>SQL 쿼리</td>
<td style="text-align: left;">단순 트랜잭션, 빈번한 갱신</td>
<td style="text-align: left;">복잡한 집계 쿼리</td>
</tr>
<tr class="even">
<td>사용자</td>
<td style="text-align: left;">아주 많음</td>
<td style="text-align: left;">분석가 포함 일부</td>
</tr>
</tbody>
</table>
<p>따라서, OLTP는 운영 데이터베이스(Operational Database)로 적합하여 쓰기 업무(Write-intensive)가 많은 경우 빠르고 안전하게 레코드를 삽입(insert)하는데 특화된 반면, OLAP은 데이터 창고(Data Warehouse) 업무에 적합한데 다양한 분석업무를 수행할 때 쿼리 작업을 속도감있게 진행할 수 있어 읽기 업무(Read-intensive)에 특화되어 있다.</p>
</section><section id="database-warehouse-lake" class="level3" data-number="2.1.3"><h3 data-number="2.1.3" class="anchored" data-anchor-id="database-warehouse-lake">
<span class="header-section-number">2.1.3</span> DW, 데이터 호수</h3>
<p>전통적인 데이터베이스(Database)는 관계형 데이터베이스를 통해서 실시간 정형데이터를 빠르고 신뢰성있게 처리하는데 운영계를 지탱하는 주된 쓰임새가 있으며, 데이터 창고(Data Warehouse)는 이력 데이터를 통합하여 꿰뚤어 볼 수 있는 능력(Insight)을 제공함은 물론 보고서와 전체적인 현황을 대쉬보드를 통해 제공하는데 큰 의미가 있다. <strong>데이터 호수(Data Lake)</strong>는 정형, 반정형, 비정형 데이터를 모두 저장하고 관리한다는 측면에서 유연성과 확장성을 내재하고 있으며 빅데이터를 분석하여 OLAP에서 추구하는 바를 한단계 더 넓혔다는 점에서 의의를 둘 수 있다. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_data_lake.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/database_data_lake.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>데이터 호수(Data Lake)는 특정한 구조가 없기 때문에 접근하기 용이하고 쉽게 수정하기도 용이한 반면에 데이터 창고(Data Warehouse)는 상대적으로 유연성이 떨어진다. 뿐만 아니라 데이터 과학자는 아직 결정되지 않는 비즈니스 활용 사례를 데이터 문제로 바꿔 모형을 만들고 시각화를 하는데 데이터 호수를 적합한 데 반해 비즈니스 현업전문가는 일단 전처리가 된 데이터를 데이터 창고에 넣어 특정 목적을 달성하는데 활용된다는 점에서 비교가 된다.</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 39%">
<col style="width: 39%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">데이터 호수</th>
<th style="text-align: center;">데이터 창고</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">자료구조</td>
<td style="text-align: center;">원천 데이터 (Raw Data)</td>
<td style="text-align: center;">전처리 된 데이터</td>
</tr>
<tr class="even">
<td style="text-align: center;">데이터 활용 목적</td>
<td style="text-align: center;">미결정 상태</td>
<td style="text-align: center;">현재 사용 중</td>
</tr>
<tr class="odd">
<td style="text-align: center;">사용자</td>
<td style="text-align: center;">데이터 과학자</td>
<td style="text-align: center;">비즈니스 현업전문가</td>
</tr>
<tr class="even">
<td style="text-align: center;">접근성</td>
<td style="text-align: center;">접근성 높고 신속한 업데이트</td>
<td style="text-align: center;">변경하기 쉽지 않고 비용도 많이 소요됨.</td>
</tr>
</tbody>
</table>
<p>클라우드 서비스도 데이터 창고(Data Warehouse)를 기능으로 제공하고 있는데 상품명은 다음과 같다.</p>
<ul>
<li>AWS: 아마존 Redshift</li>
<li>MS Azure: Azure SQL Data Warehouse</li>
<li>구글: 구글 빅쿼리(Big Query)</li>
</ul>
<p>데이터 호수도 클라우드 서비스에서 제공된다. Object Storage와 함께 하둡/스파크 빅데이터 소프트웨어와 함께 검토된다.</p>
<ul>
<li>AWS: AWS S3</li>
<li>MS Azure: Blob Storage / Azure Data Lake Storage</li>
<li>구글: Cloud Storage</li>
<li>네이버: Object Storage</li>
</ul></section><section id="etl-vs-elt" class="level3" data-number="2.1.4"><h3 data-number="2.1.4" class="anchored" data-anchor-id="etl-vs-elt">
<span class="header-section-number">2.1.4</span> ETL과 ELT</h3>
<p>ETL은 추출, 변환, 적재(Extract, Transform, Load)의 약자로 동일 기종 혹은 이기종의 원천데이터로부터 데이터 웨어하우스에서 쌓는 과정을 뜻하는데 변환(Transform) 과정이 무척 많은 노력이 투여된다. 반면에 ELT는 데이터를 먼저 적재한 후에 필요에 따라 변환과정을 거쳐 후속 작업에 사용한다. 데이터 호수 ELT 프로세스가 매력적으로 보이지만 데이터 카탈로그가 잘 관리되지 않는다면 <strong>데이터 늪(Data Swamp)</strong>가 될 수 있다. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/databse_etl.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="ETL과 ELT 비교"><img src="images/databse_etl.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">ETL과 ELT 비교</figcaption></figure>
</div>
<p>데이터 호수를 잘 관리하지 않는다면 데이터 늪에 빠질 수 있는데 메타데이터를 잘 관리하고 거버넌스를 확립해야 되고 비정형데이터도 많이 다루기 때문에 데이터 전문가 과학자를 확보하여 효율성을 높인다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_swamp.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="데이터 호수와 늪"><img src="images/database_swamp.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">데이터 호수와 늪</figcaption></figure>
</div>
</section><section id="database-integration" class="level3" data-number="2.1.5"><h3 data-number="2.1.5" class="anchored" data-anchor-id="database-integration">
<span class="header-section-number">2.1.5</span> 데이터 통합(integration)</h3>
<p>원천데이터가 서로 다른 형태로 다양하게 존재하는 상황에서 데이터를 통합한다는 것은 시스템을 맞추는 것을 넘어 개념적인 데이터 모델로 정립하여야 하고 관련하여 파생된느 다양한 문제를 조화롭게 해결하는 것으로 정의할 수 있다.</p>
<p>먼저 데이터를 한곳에 모은다고 하면 어떤 데이터를 모을 것인지 정의하고 클라우드 서비스를 사용한다고 하면 AWS Redshift 혹은 S3를 상정하고 혹시나 포함될 수 있는 개인정보도 사전에 식별하여 마스킹 등을 통해 익명화시켜야 되며 데이터 혈통(Data Lineage)도 구축하여 투명성과 가시성도 확보한다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_lineage.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="데이터 계통도"><img src="images/database_lineage.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">데이터 계통도</figcaption></figure>
</div>
</section><section id="table-partition" class="level3" data-number="2.1.6"><h3 data-number="2.1.6" class="anchored" data-anchor-id="table-partition">
<span class="header-section-number">2.1.6</span> 테이블 분할과 샤딩</h3>
<p>지금은 빅데이터 시대라 데이터가 커지게 되면 테이블에 담을 수 없는 상황이 온다. 이런 문제를 해결하기 위해 도입된 개념이 <strong>분할(Partition)</strong> 이다. 테이블 크기가 예를 들어 100GB 혹은 1TB가 되면 인덱스도 커져서 메모리에 적재가 되지 않아 쿼리 속도와 업데이트 속도가 현격히 늦어지게 된다. 이런 경우 테이블을 더 작은 단위로 쪼개는데 이를 <strong>분할(Partition)</strong>이라고 한다.</p>
<p>테이블을 분할하게 될 경우 개념과 논리 데이터 모형은 동일하지만 물리 데이터 모형이 분할에 영향을 받게 된다.</p>
<ol type="1">
<li>개념 데이터 모형(Concept Data Model): Entity, Relationship, Attributes
<ul>
<li>ERD(Entity Relational Diagram), UML 다이어그램</li>
</ul>
</li>
<li>논리 데이터 모형(Logical Data Model): 테이블, 칼럼, 관계
<ul>
<li>데이터베이스 스키마와 모형: 관계형 모형, 스타 스키마(Star Sceman)</li>
<li>
<strong>분할(Partition)</strong> 혹은 <strong>샤딩(Sharding)</strong>에 영향을 받음</li>
</ul>
</li>
<li>물리 데이터 모형(Physical Data Model): 물리적 저장장치
<ul>
<li>백업 시스템, 파티션, CPU, 저장공간 등</li>
<li>
<strong>분할(Partition)</strong> 혹은 <strong>샤딩(Sharding)</strong>의 영향을 받음.</li>
</ul>
</li>
</ol>
<p>테이블을 분할하는 방법은 수평 분할 (Horizontal Partitioning)과 수직 분할 (Vertical Partitioning) 두가지 방법이 있다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_partition.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="데이터 수평 및 수직 분할"><img src="images/database_partition.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">데이터 수평 및 수직 분할</figcaption></figure>
</div>
<p><strong>데이터베이스 샤딩(databae sharding)</strong>은 테이블이 동일한 데이터베이스에 있지 않고 다른 기계에 있다는 점에서 차이가 난다. <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_sharding.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="데이터베이스 샤딩(Sharding)"><img src="images/database_sharding.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">데이터베이스 샤딩(Sharding)</figcaption></figure>
</div>
</section></section><section id="db-design" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="db-design">
<span class="header-section-number">2.2</span> 데이터베이스 설계</h2>
<p>데이터베이스 설계(Database Design)는 데이터를 논리적으로 저장하는 방식으로 데이터베이스 모델(Database Model)을 사용한다. 데이터베이스 모델(Database Model)은 데이터베이스 구조에 대한 최상위 사양서의 역할을 한다. 일반적으로 관계형 데이터베이스 모형(Relational Database Model)을 사용하지만 NoSQL, 객체지향 DB 모형, 네트워크 DB 모델 등이 있다. 데이터베이스의 청사진으로 스키마를 사용해서 테이블, 필드, 관계, 인덱스, 뷰로 구성하여 작성한다.</p>
<ol type="1">
<li>데이터 (Data) ← 논리 모형</li>
<li>데이터베이스 모형 ← 데이터 구조에 대한 사양서</li>
<li>스키마 ← 레고 블럭(Table, Field, Relation, Index, View 등)으로 데이터베이스 설계</li>
</ol>
<p>즉, 데이터를 체계적으로 구조화하는 논리모형을 먼저 구상하고 나서 사양서를 작성하고 실제 데이터베이스 설계로 들어간다.</p>
<section id="db-design-in-practice" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="db-design-in-practice">
<span class="header-section-number">2.2.1</span> 데이터 모형(Data Modeling)</h3>
<p>데이터를 저장하는 방식에 대해 데이터 모형(Data Model)을 제작하는 단계는 다음과 같다.</p>
<ol type="1">
<li>개념 데이터 모형(Concept Data Model): Entity, Relationship, Attributes
<ul>
<li>ERD(Entity Relational Diagram), UML 다이어그램</li>
</ul>
</li>
<li>논리 데이터 모형(Logical Data Model): 테이블, 칼럼, 관계
<ul>
<li>데이터베이스 스키마와 모형: 관계형 모형, 스타 스키마(Star Sceman)</li>
</ul>
</li>
<li>물리 데이터 모형(Physical Data Model): 물리적 저장장치
<ul>
<li>백업 시스템, 파티션, CPU, 저장공간 등</li>
</ul>
</li>
</ol></section><section id="data-normalization" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="data-normalization">
<span class="header-section-number">2.2.2</span> 데이터 정규화 <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>
</h3>
<p>관계형 데이터베이스의 설계에서 <strong>정규화(normalization)</strong>는 중복을 최소화하도록 데이터를 구조화하는 프로세스를 지칭한다. 관계형 모델의 발견자인 에드거 F. 커드는 1970년에 제 1 정규형(1NF)로 알려진 정규화의 개념을 도입하였고, 에드거 F. 커드는 이어서 제 2 정규형(2NF)과 제 3 정규형(3NF)을 1971년에 정의하였으며, 1974년에는 레이먼드 F. 보이스와 함께 보이스-코드 정규화(BCNF)를 정의하였다. 통상 관계형 데이터베이스 테이블이 제 3 정규(3NF)형이 되었으면 <strong>정규화(Normalization)</strong> 되었다고 한다. 따라서, 데이터 정규형(Normal Forms)은 1NF 부터 3NF까지가 많이 회자된다.</p>
<ul>
<li>제 1 정규형 (1 NF)
<ul>
<li>각 레코드는 유일무이(unique)해야 한다. 즉, 중복(duplication)이 없어야 함.</li>
<li>각 셀은 하나의 값만 가져야 함.</li>
</ul>
</li>
<li>제 2 정규형 (2 NF)
<ul>
<li>제 1 정규형을 만족한다.</li>
<li>기본키(primary key)가 한 칼럼이면 자동으로 제 2 정규형을 만족한다.</li>
<li>기본키가 아닌 모든 속성이 기본키에 완전 함수 종속되어야 한다.</li>
</ul>
</li>
<li>제 3 정규형 (3 NF)
<ul>
<li>제 2 정규형을 만족한다.</li>
<li>기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않아야 한다.</li>
<li>즉, 이행(移行)적 함수 종속 (Transitive Functional Dependency)이 없어야 한다.</li>
<li>함수 종속 사례로 X, Y, Z 에 대해 X → Y 이고 Y → Z 이면 X → Z 가 성립한다. 이를 Z 가 X 에 이행적으로 함수 종속되었다고 함.</li>
</ul>
</li>
</ul></section></section><section id="dimensional-modeling" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="dimensional-modeling">
<span class="header-section-number">2.3</span> OLAP 차원 모델링 <a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>
</h2>
<p>데이터베이스 모델이은 크게 탑다운(top-down) ERD 방법론과 함께 “데이터 창고(Data Warehouse)”에서 차원 모델링(DM, Dimensional Modeling)으로 나눠진다. 좀더 쉽게 이해를 하기 위해 GURU99에 나온 사례를 살펴보자. OLAP 차원 모델링은 다음 5단계로 이뤄진다.</p>
<ol type="1">
<li>가장 먼저 비즈니스 프로세스를 하나 선택한다.
<ul>
<li>마케팅, 영업, 인사 등</li>
</ul>
</li>
<li>얼마나 자세히 볼 것인지 상세화 수준(grain)을 정의한다.
<ul>
<li>연도별, 분기별, 월별, 주별, 일별 등</li>
</ul>
</li>
<li>차원을 정의한다.
<ul>
<li>차원은 날짜, 지점, 공장 등을 지칭한다.</li>
</ul>
</li>
<li>사실(Fact)을 정의한다.
<ul>
<li>일자별 지점별 제품별 판매금액과 같이 숫자값이 된다.</li>
</ul>
</li>
<li>스키마를 제작한다.
<ul>
<li>상기 정보를 바탕으로 스타 스키마(Star Schema) 혹은 눈꽃 스키마(Snowflake Schema) 를 작성한다.</li>
</ul>
</li>
</ol>
<p>상기 작업결과 사장님이 원하는 월별 지점별 직급별 판매실적을 스타 스키마로 제작하게 된다</p>
<p><a href="fig/dimensional_model.png"></a></p>
<section id="star-schema" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="star-schema">
<span class="header-section-number">2.3.1</span> 스타 스키마</h3>
<p>차원 모델링을 방법론으로 스타 스키마를 채택하게 되면 차원 테이블(dimensional table)과 사실 테이블(fact table)을 정의해야 되는데 차원 테이블은 되도록이면 변하지 않는 속성(attributes)을 갖게 되는 반면, 차원 테이블은 측정값에 대한 레코드가 축적되며 자주 변경되게 되고 차원 테이블과 외래키(foreign key)로 연결된다.</p>
</section></section><section id="chinook-database" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="chinook-database">
<span class="header-section-number">2.4</span> <code>chinook</code> 데이터베이스</h2>
<p>치눅(<a href="https://archive.codeplex.com/?p=chinookdatabase"><code>chinook</code></a>) 데이터베이스는 Northwind 데이터베이스에서 유래되었으며, <a href="https://en.wikipedia.org/wiki/Chinook_wind">치눅(chinooks)</a>은 캐나다 프레리(Canadian Prairies)과 미국 대평원(Great Plains)에서 발생되는 푄 바람(fohn winds)라고 한다. <a href="https://github.com/lerocha/chinook-database"><code>lerocha/chinook-database</code></a> GitHub 저장소에 다양한 데이터베이스에 사용될 수 있도록 교육용으로 잘 준비되어 있다.</p>
<section id="chinook-database-erd" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="chinook-database-erd">
<span class="header-section-number">2.4.1</span> <code>chinook</code> ERD</h3>
<p>치눅 데이터베이스는 디지털 미디어 상점의 가상 데이터를 기반으로 한 공개 데이터베이스다. 치눅 데이터베이스는 앨범, 아티스트, 장르, 트랙, 재생 목록, 고객, 직원, 공급 업체를 담고 있는 테이블로 구성되어 있다.</p>
<ul>
<li>
<strong>Artists</strong>: 아티스트의 이름과 정보를 포함합니다.</li>
<li>
<strong>Albums</strong>: 각 앨범과 관련된 아티스트 정보를 포함합니다.</li>
<li>
<strong>Tracks</strong>: 각 트랙의 이름, 앨범 ID, 장르 ID, 미디어 형식 및 가격과 같은 정보를 포함합니다.</li>
<li>
<strong>Genres</strong>: 음악의 장르(예: 록, 재즈, 팝 등) 정보를 포함합니다.</li>
<li>
<strong>Media</strong> Types: 미디어 형식(예: MPEG 오디오 파일, ACC 오디오 파일 등) 정보를 포함합니다.</li>
<li>
<strong>Playlists</strong>: 재생 목록과 그에 관련된 트랙 정보를 포함합니다.</li>
<li>
<strong>Customers</strong>: 고객의 세부 정보와 구매 이력 정보를 포함합니다.</li>
<li>
<strong>Invoices &amp; InvoiceItems</strong>: 고객의 청구서와 청구서 항목에 대한 정보를 포함합니다.</li>
<li>
<strong>Employees</strong>: 직원 정보와 그들의 역할, 매니저, 고용 일자 등의 정보를 포함합니다.</li>
<li>
<strong>Suppliers</strong>: 공급 업체 정보를 포함합니다.</li>
<li>
<strong>Chinook</strong> 데이터베이스는 실제 비즈니스 시나리오를 모방하여 복잡한 쿼리, 프로시저 및 다른 데이터베이스 작업을 수행하기 위한 교육용 플랫폼으로 사용됩니다.</li>
</ul>
<p>각 테이블간의 관계는 <code>chinook</code> ERD를 통해서 <a href="https://docs.yugabyte.com/latest/sample-data/chinook/">YugaByte DB</a>에서 확인할 수 있다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/database_chinook.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="치눅 데이터베이스 ERD"><img src="images/database_chinook.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">치눅 데이터베이스 ERD</figcaption></figure>
</div>
</section><section id="chinook-helloworld" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="chinook-helloworld">
<span class="header-section-number">2.4.2</span> 헬로 월드</h3>
<p>먼저, <a href="https://github.com/lerocha/chinook-database">sqlite3 chinooks</a> 데이터베이스를 다운로드 한다. <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://raw.githubusercontent.com/lerocha/chinook-database/master/ChinookDatabase/DataSources/Chinook_Sqlite.sql"</span>, destfile <span class="op">=</span> <span class="st">"data/Chinook_Sqlite.sql"</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>쉘에서 아래 명령어로 sqlite3 데이터베이스를 생성시킨다. 제법 시간이 걸리기 때문에 <code>chinook.db</code> 생성이 완료된 후에 후속 분석 작업을 수행한다.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> sqlite3 chinook.db <span class="op">&lt;</span> Chinook_Sqlite.sql</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>DBI</code> 연결시켜 <code>chinook.db</code>를 R에서 작업할 수 있도록 준비시킨다.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rsqlite.r-dbi.org">RSQLite</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">chinook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span><span class="op">(</span><span class="op">)</span>, dbname <span class="op">=</span> <span class="st">"data/chinook.db"</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>R 마크다운에서 제대로 되는지 테스트 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> Artist <span class="kw">LIMIT</span> <span class="dv">10</span>;</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="knitsql-table">
<table class="table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead><tr class="header">
<th style="text-align: left;">ArtistId</th>
<th style="text-align: left;">Name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">AC/DC</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Accept</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Aerosmith</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Alanis Morissette</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Alice In Chains</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Antônio Carlos Jobim</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Apocalyptica</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Audioslave</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">BackBeat</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">Billy Cobham</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>SQLite에서는 모든 테이블, 인덱스, 트리거 및 뷰에 대한 메타데이터를 저장하는 특별한 <code>sqlite_master</code> 테이블이 존재한다. SQLite 데이터베이스에서 테이블 목록을 다음 쿼리를 사용하여 확인한다.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html">dbGetQuery</a></span><span class="op">(</span><span class="va">chinook</span>, <span class="st">'</span></span>
<span><span class="st">SELECT name, type </span></span>
<span><span class="st">         FROM sqlite_master </span></span>
<span><span class="st">        WHERE type IN ("table", "view")</span></span>
<span><span class="st">'</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            name  type
1          Album table
2         Artist table
3       Customer table
4       Employee table
5          Genre table
6        Invoice table
7    InvoiceLine table
8      MediaType table
9       Playlist table
10 PlaylistTrack table
11         Track table</code></pre>
</div>
</div>
<p>미국에서 가장 많이 팔리는 장르는 무엇인가? 라는 질의문에 대한 SQL 쿼리를 다음과 같이 작성할 수 있다. 다음 SQL 쿼리는 <a href="https://rpubs.com/qzeng1/case_questions_SQL_R">SQLite in R - Answering Questions with Data</a>에서 가져왔다.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tracks_usa</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">WITH usa_tracks_sold AS</span></span>
<span><span class="st">   (</span></span>
<span><span class="st">    SELECT il.* </span></span>
<span><span class="st">      FROM InvoiceLine  il</span></span>
<span><span class="st">     INNER JOIN Invoice i on i.InvoiceId = il.InvoiceId</span></span>
<span><span class="st">     INNER JOIN Customer c on c.CustomerId = i.CustomerId</span></span>
<span><span class="st">     WHERE c.Country = "USA"</span></span>
<span><span class="st">   )</span></span>
<span><span class="st">SELECT g.name AS genre_name,</span></span>
<span><span class="st">       COUNT(uts.InvoiceLineId) AS no_of_tracks_sold,</span></span>
<span><span class="st">       CAST(COUNT(uts.InvoiceLineId) AS FLOAT) / (</span></span>
<span><span class="st">                                                    SELECT COUNT(*) </span></span>
<span><span class="st">                                                      FROM usa_tracks_sold</span></span>
<span><span class="st">                                                    ) AS percentage_sold</span></span>
<span><span class="st">  FROM usa_tracks_sold uts</span></span>
<span><span class="st"> INNER JOIN Track  t on t.TrackId = uts.TrackId</span></span>
<span><span class="st"> INNER JOIN Genre  g on g.GenreId = t.GenreId</span></span>
<span><span class="st"> GROUP BY 1</span></span>
<span><span class="st"> ORDER BY 2 DESC</span></span>
<span><span class="st"> LIMIT 10;</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html">dbGetQuery</a></span><span class="op">(</span><span class="va">chinook</span>, <span class="va">tracks_usa</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           genre_name no_of_tracks_sold percentage_sold
1                Rock               157      0.31781377
2               Latin                91      0.18421053
3               Metal                64      0.12955466
4  Alternative &amp; Punk                50      0.10121457
5                Jazz                22      0.04453441
6               Blues                15      0.03036437
7            TV Shows                14      0.02834008
8            R&amp;B/Soul                12      0.02429150
9              Comedy                 8      0.01619433
10          Classical                 8      0.01619433</code></pre>
</div>
</div>
<p>챗GPT를 사용하여 다음과 같이 질의를 하게 되면 SQL 쿼리문을 생성해준다.</p>
<blockquote class="blockquote">
<p>프롬프트: 매출 상위 10개 국가 목록을 뽑아주세요.</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html">dbGetQuery</a></span><span class="op">(</span><span class="va">chinook</span>, <span class="st">'</span></span>
<span><span class="st">  SELECT </span></span>
<span><span class="st">      c.Country,</span></span>
<span><span class="st">      SUM(il.UnitPrice * il.Quantity) AS TotalRevenue</span></span>
<span><span class="st">  FROM Invoice i</span></span>
<span><span class="st">  JOIN InvoiceLine il ON i.InvoiceId = il.InvoiceId</span></span>
<span><span class="st">  JOIN Customer c ON i.CustomerId = c.CustomerId</span></span>
<span><span class="st">  GROUP BY c.Country</span></span>
<span><span class="st">  ORDER BY TotalRevenue DESC</span></span>
<span><span class="st">  LIMIT 10;</span></span>
<span><span class="st">'</span><span class="op">)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Country TotalRevenue
1             USA       523.06
2          Canada       303.96
3          France       195.10
4          Brazil       190.10
5         Germany       156.48
6  United Kingdom       112.86
7  Czech Republic        90.24
8        Portugal        77.24
9           India        75.26
10          Chile        46.62</code></pre>
</div>
</div>


</section></section><aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p><a href="https://www.talend.com/resources/data-lake-vs-data-warehouse/">talend, ““Four key differences between a data lake and a data warehouse</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://medium.com/@thenortonsetup/dont-let-your-data-lake-turn-into-a-data-swamp-44dba717126b">thenortonsetup (Jan 10, 2017), “Don’t Let Your Data Lake Turn Into A Data Swamp”</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://www.cubrid.org/manual/ko/9.3.0/shard.html">CUBRID SHARD, “Database Sharding”</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p><a href="https://ko.wikipedia.org/wiki/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4_%EC%A0%95%EA%B7%9C%ED%99%94">위키 백과, “데이터베이스 정규화”</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p><a href="https://yaboong.github.io/database/2018/03/09/database-normalization-1/">YABOONG (MARCH 9, 2018), “데이터베이스 정규화 - 1NF, 2NF, 3NF”</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><a href="https://www.guru99.com/dimensional-model-data-warehouse.html">Guru99, “What is Dimensional Modeling in Data Warehouse?”</a><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p><a href="http://johnatten.com/2014/12/07/installing-and-using-sqlite-on-windows/">John Atten (2014-12-07), “Installing and Using SQLite on Windows”</a><a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></aside></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./data_mgmt.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">데이터 관리 방법론</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./cs_prussia.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">프로이센 기병</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","closeEffect":"zoom","selector":".lightbox","descPosition":"bottom","loop":true});</script>


</body></html>