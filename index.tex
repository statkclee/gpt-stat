% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  chapter,a4paper,showtrims,openright,hidelinks]{oblivoir}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
  \setmainfont[]{NanumGothic}
  \setsansfont[]{NanumGothic}
  \setmonofont[]{D2Coding}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{booktabs}
\usepackage{caption}
\usepackage{longtable}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{목차}
\else
  \newcommand\contentsname{목차}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{그림 목록}
\else
  \newcommand\listfigurename{그림 목록}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{표 목록}
\else
  \newcommand\listtablename{표 목록}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{그림}
\else
  \newcommand\figurename{그림}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{표}
\else
  \newcommand\tablename{표}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{목록}
\newcommand*\listoflistings{\listof{codelisting}{코드 목록}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{sidenotes}{}{\usepackage{sidenotes}}
\@ifpackageloaded{marginnote}{}{\usepackage{marginnote}}
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
\usepackage[bidi=basic]{babel}
\else
\usepackage[bidi=default]{babel}
\fi
\babelprovide[main,import]{korean}
\ifPDFTeX
\else
\babelfont{rm}[]{NanumGothic}
\fi
% get rid of language-specific shorthands (see #6817):
\let\LanguageShortHands\languageshorthands
\def\languageshorthands#1{}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{biblatex}
\addbibresource{references.bib}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={GPT 통계},
  pdfauthor={이광춘},
  pdflang={ko-KR},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{GPT 통계}
\author{이광춘}
\date{2023년 09월 05일}

\begin{document}
\maketitle
\renewcommand*\contentsname{목차}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\bookmarksetup{startatroot}

\hypertarget{uxc11cuxbb38}{%
\chapter*{서문}\label{uxc11cuxbb38}}
\addcontentsline{toc}{chapter}{서문}

\markboth{서문}{서문}

\hypertarget{uxc81c23-2uxcc28-uxacf5uxacf5-uxbe45uxb370uxc774uxd130-uxbd84uxc11duxd65cuxc6a9uxad50uxc721-9.1819}{%
\section*{제23-2차 공공 빅데이터 분석활용교육
(9.18\textasciitilde19)}\label{uxc81c23-2uxcc28-uxacf5uxacf5-uxbe45uxb370uxc774uxd130-uxbd84uxc11duxd65cuxc6a9uxad50uxc721-9.1819}}
\addcontentsline{toc}{section}{제23-2차 공공 빅데이터 분석활용교육
(9.18\textasciitilde19)}

\markright{제23-2차 공공 빅데이터 분석활용교육 (9.18\textasciitilde19)}

\begin{figure}

{\centering \includegraphics{images/kdefense_timetable.jpg}

}

\caption{방위사업교육원 실습 강의}

\end{figure}

\hypertarget{uxcc38uxace0-uxc790uxb8cc}{%
\section*{참고 자료}\label{uxcc38uxace0-uxc790uxb8cc}}
\addcontentsline{toc}{section}{참고 자료}

\markright{참고 자료}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  인공지능 기초

  \begin{itemize}
  \tightlist
  \item
    데이터 과학 언플러그드 : \url{https://r2bit.com/book_unplugged/}
  \item
    리보그 세상 - 블록 언어 → R/파이썬 :
    \url{https://statkclee.github.io/reeborg/}
  \item
    데이터 과학 프로그래밍 : \url{https://r2bit.com/book_programming/}
  \end{itemize}
\item
  데이터 사이언스

  \begin{itemize}
  \tightlist
  \item
    GS 칼텍스 디지털 아카데미: \url{https://r2bit.com/curriculum/}
  \item
    연세대학교 데이터 과학: \url{https://statkclee.github.io/yonsei/}
    \url{https://statkclee.github.io/yonsei2/}
  \end{itemize}
\item
  챗GPT 데이터 사이언스

  \begin{itemize}
  \tightlist
  \item
    챗GPT PPT: \url{https://r2bit.com/bitSlide/}
  \item
    챗GPT 디지털 글쓰기: \url{https://r2bit.com/quarto/}
  \item
    챗GPT 디지털 출판: \url{https://r2bit.com/bitPublish/}
  \item
    챗GPT 실습: \url{https://r2bit.com/gpt-edu/}
  \item
    챗GPT 자료: \url{https://r2bit.com/chatGPT/}
  \end{itemize}
\item
  커뮤니티

  \begin{itemize}
  \tightlist
  \item
    공익법인 한국 R 사용자회: \url{https://r2bit.com/}
  \item
    서울 R 미트업: \url{https://r2bit.com/seoul-r/}
  \item
    한국 R 컨퍼런스: \url{https://use-r.kr/}
  \end{itemize}
\end{enumerate}

\hypertarget{uxc2e0uxac04uxb3c4uxc11c-uxcc57gpt-uxc720uxb2c9uxc2a4-uxc258}{%
\section*{{[}신간도서{]} 챗GPT 유닉스
쉘}\label{uxc2e0uxac04uxb3c4uxc11c-uxcc57gpt-uxc720uxb2c9uxc2a4-uxc258}}
\addcontentsline{toc}{section}{{[}신간도서{]} 챗GPT 유닉스 쉘}

\markright{{[}신간도서{]} 챗GPT 유닉스 쉘}

\begin{figure}

{\centering \includegraphics[width=2.94792in,height=\textheight]{images/unix_shell.jpeg}

}

\end{figure}

``챗GPT 유닉스 쉘''은 단순한 기술서적이 아니고 지금 챗GPT AI 시대를
지탱하는 사고체계다. 컴퓨터의 대부인 IBM이 새로운 제국의 시대를
열었지만, 그 제국을 흔들었던 힘은 바로 '유닉스'였다.

유닉스는 레고와 닮았다. 한가지 기능에 특화된 레고블록 각각은 별볼일
없지만 레고블록을 조합하면 명작으로 재탄생한다. 레고를 이해하면 유닉스도
쉽게 이해되고 강력한 소프트웨어를 제작할 수 있다.

피터 파커(스파이더맨)의 삼촌 벤자민 파커는 ``큰 힘에는 큰 책임이
따른다.''는 명언을 남겼다. 자연어를 이해하는 챗GPT가 등장하며 큰 책임을
다하면서 큰 힘을 쓸 수 있는 여건이 마련되었다.

이 책은 21세기 가장 섹시한 직업으로 불리는 `데이터 과학' 분야를 주로
다루고 있지만, 챗GPT와 유닉스의 조합이 얼마나 강력한지 직접 체험함으로써
앞으로 펼쳐질 미래를 예측하는데도 도움을 줄 것이다.

\begin{itemize}
\tightlist
\item
  📚 종이책: \url{https://product.kyobobook.co.kr/detail/S000208801484}
\item
  📱 전자책:
  \url{https://ebook-product.kyobobook.co.kr/dig/epd/ebook/E000005358063}
\end{itemize}

\part{데이터 관리}

\hypertarget{uxb370uxc774uxd130-uxad00uxb9ac-uxbc29uxbc95uxb860}{%
\chapter{데이터 관리
방법론}\label{uxb370uxc774uxd130-uxad00uxb9ac-uxbc29uxbc95uxb860}}

\hypertarget{uxce21uxc815-uxbcc0uxc218uxc758-uxad6cuxbd84}{%
\section{측정 변수의
구분}\label{uxce21uxc815-uxbcc0uxc218uxc758-uxad6cuxbd84}}

자료가 갖는 고유한 특성을 숫자료 표현한 측정 척도에 따라, 명목형,
순서형, 구간형, 비율형 네가지로 구분된다. 측정 척도에 따라 유의미한
통계량도 함께 정해진다. \autocite{wiener1921new}
\autocite{lee2020godeung,stevens1946theory}

\begin{itemize}
\tightlist
\item
  명목척도(Nominal): 단순히 개체 특성 분류를 위해 숫자나 부호를 부여한
  척도

  \begin{itemize}
  \tightlist
  \item
    남자: M, 여자: F 혹은 월: 1, 화: 2, \ldots{} 일:7, 혈액형: A형, B형,
    AB형, O형
  \end{itemize}
\item
  순서척도(Ordinal): 명목척도에 부가적으로 ``순서(서열)'' 정보가 추가된
  척도

  \begin{itemize}
  \tightlist
  \item
    군대계급: 사병, 장교, 장군 등
  \end{itemize}
\item
  구간척도(Interval): 순서척도에 부가적으로 ``등간격'' 정보가 추가된
  척도

  \begin{itemize}
  \tightlist
  \item
    구간척도는 절대 영점이 없음. 측정된 값들 간의 상대적인 차이만을
    의미.
  \item
    섭씨 온도 척도에서 0도는 온도 부재를 의미하지 않음.
  \item
    덧셈과 뺄셈은 가능하지만, 곱셈과 나눗셈은 의미가 없음. 온도가 서울
    10도, 제주 20도는 제주가 서울보다 온도가 2배 높다고 할 수 없음.
  \item
    온도(섭씨 20도, 화씨 68도), 시력, IQ 지수(90, 100, 110),
    물가지수(기준 연도 대비 105, 110, 115) 등
  \end{itemize}
\item
  비율척도(Ratio): 구간척도에 ``비율'' 비교특성이 추가된 척도로 ``비율
  등간격'' 특성이 포함됨.

  \begin{itemize}
  \tightlist
  \item
    절대 영점은 해당 측정의 부재를 의미. 길이가 0cm는 길이가 없음을
    의미. 무게 0kg는 무게가 없음을 의미.
  \item
    절대 '0'을 가지고 사칙연산이 가능함. 10kg은 5kg의 2배.
  \item
    연령(20세, 30세, 40세), 월소득(2백만원, 3백만원, 4백만원`), TV
    시청률 등.
  \end{itemize}
\end{itemize}

\begin{figure}

{\centering \includegraphics{images/stevens_measurement.png}

}

\caption{측정 분류}

\end{figure}

변동계수(Coefficient of Variation, CV)는 표준편차와 평균값의 비율로
계산되는 통계값으로 다음과 같이 정의된다. 다음에서, \(\sigma\)는
표준편차이고, \$\mu\$ 평균이다.

\[CV = \frac{\sigma}{\mu} \times 100\%\]

CV는 데이터의 변동성을 상대적으로 표현할 때 주로 사용된다. 특히, 두 개
이상의 변수 변동성을 비교할 때 편리하고, 변수 단위가 다르거나 평균값이
크게 다를 경우에도 CV를 사용하면 변동성을 공정하게 비교할 수 있는 장점이
있다.

비율척도는 0이 절대적인 의미를 갖고, 모든 사칙연산이 가능한 척도 특징을
갖고 있다. CV가 0\%이면, 변동성이 전혀 없다는 것을 의미하고, CV에서
0\%는 절대적인 부재를 의미하며, 이것은 비율척도의 특징 중 하나다.
따라서, CV는 비율로 표현되므로, 어떤 변수의 CV가 다른 변수 CV의 2배라면,
변동성이 2배 크다는 것을 의미한다.

\hypertarget{data-type-basics}{%
\section{R 자료구조}\label{data-type-basics}}

R에서 기본으로 사용하는 벡터 자료형은 \textbf{원자 벡터(Atomic Vector)}
와 \textbf{리스트(List)} 로 나눠진다. 원자 벡터에는 6가지 자료형이 있고,
logical, integer, double, character, complex, raw, 총 6 개가 있으며
주로, 논리형, 정수형, 부동소수점형, 범주형, 4가지를 많이 사용한다.
\autocite{wickham2023r}

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
자료형(Type) & 모드(Mode) & 저장모드(Storage Mode) \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
logical & logical & logical \\
\textbf{integer} & numeric & integer \\
\textbf{double} & numeric & double \\
complex & complex & complex \\
character & character & character \\
raw & raw & raw \\
\end{longtable}

\hypertarget{uxce21uxc815uxcc99uxb3c4uxc640-uxc790uxb8ccuxd615}{%
\section{측정척도와
자료형}\label{uxce21uxc815uxcc99uxb3c4uxc640-uxc790uxb8ccuxd615}}

측정 척도는 크게 명목척도(Nominal), 순서척도(Ordinal),
구간척도(Interval), 그리고 비율척도(Ratio)로 분류할 수 있다.

\begin{itemize}
\tightlist
\item
  \textbf{명목척도(Nominal)}는 순서정보가 없는 범주로, \texttt{logical},
  \texttt{character}나 \texttt{factor} 자료형으로 표현한다.
\item
  \textbf{순서척도(Ordinal)}는 순서 정보가 추가된 명목척도로
  \texttt{ordered\ factor}로 표현한다.
\item
  \textbf{구간척도(Interval)}에서는 덧셈과 뺄셈은 가능하지만, 곱셈과
  나눗셈은 의미가 없고 절대 영점도 없다. 주로 \texttt{double} 또는
  \texttt{integer} 자료형으로 표현한다.
\item
  \textbf{비율척도(Ratio)}에서는 모든 사칙연산이 가능하며, 절대 '0'을
  포함된다. 주로 \texttt{double} 또는 \texttt{integer} 자료형으로
  표현한다.
\end{itemize}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2055}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.5890}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2055}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
측정 척도
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
설명
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
R 자료형
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
명목척도(Nominal) & 숫자나 문자로 개체 특성 분류 & \texttt{character},
\texttt{factor} \\
순서척도(Ordinal) & 순서 정보가 추가된 명목척도 &
\texttt{ordered\ factor} \\
구간척도(Interval) & 덧셈, 뺄셈 가능 but 곱셈, 나눗셈 의미 없음. 절대
영점 없음 & \texttt{double}, \texttt{integer} \\
비율척도(Ratio) & 모든 사칙연산 가능. 절대 `0' 포함 & \texttt{double},
\texttt{integer} \\
\end{longtable}

\hypertarget{extended-data-type}{%
\section{자료형 확장}\label{extended-data-type}}

범주(요인), 텍스트, 날짜와 시간도 중요한 R에서 자주 사용되는 중요한
데이터 자료형으로 별도로 다뤄진다. 이를 위해서 \texttt{stringr},
\texttt{lubridate}, \texttt{forcats} 팩키지를 사용해서 데이터 정제작업은
물론 기계학습 예측모형 개발에 활용한다.

\begin{longtable}[]{@{}lll@{}}
\toprule\noalign{}
R 자료형 & 자료형 & 예제 \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{logical} & 부울 & 부도여부(Y/N), 남여 \\
\texttt{integer} & 정수 & 코로나19 감염자수 \\
\texttt{factor} & 범주 & 정당, 색상 \\
\texttt{numeric} & 실수 & 키, 몸무게, 주가, 환율 \\
\texttt{character} & 텍스트 & 주소, 이름, 책제목 \\
\texttt{Date} & 날짜 & 생일, 투표일 \\
\end{longtable}

\begin{figure}

{\centering \includegraphics{images/data_vectors.jpg}

}

\caption{자료형 확장}

\end{figure}

\hypertarget{uxbca1uxd130uxc640-uxb9acuxc2a4uxd2b8}{%
\section{벡터와 리스트}\label{uxbca1uxd130uxc640-uxb9acuxc2a4uxd2b8}}

리스트는 재귀 벡터(recursive vector)라고도 불리는데 리스트는 다른
리스트를 포함할 수 있기 때문이다.

따라서, 원자벡터는 동질적(homogeneous)이고, 리스트는 상대적으로
이질적(heterogeneous)이다.

모든 벡터는 두가지 성질(Property)을 갖는데, 자료형과 길이로 이를
확인하는데 \texttt{typeof()}와 \texttt{length()} 함수를 사용해서
확인한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}

\NormalTok{a }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{,}
            \AttributeTok{b =} \StringTok{"a string"}\NormalTok{,}
            \AttributeTok{c =}\NormalTok{ pi,}
            \AttributeTok{d =} \FunctionTok{list}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{) )}
  
\FunctionTok{cat}\NormalTok{(}\StringTok{"자료형:"}\NormalTok{, }\FunctionTok{typeof}\NormalTok{(a), }\StringTok{" 길이: "}\NormalTok{, }\FunctionTok{length}\NormalTok{(a) ) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
자료형: list  길이:  4
\end{verbatim}

\hypertarget{is-na-null}{%
\section{\texorpdfstring{\texttt{NULL}과 \texttt{NA}
결측값}{NULL과 NA 결측값}}\label{is-na-null}}

결측되었다는 없다는 것을 표시하는 방법이 두가지 필요하다. 하나는 벡터가
없다는 \texttt{NULL}이고, 벡터 내부에 값이 결측되었다는 \texttt{NA} 다.
\texttt{dataframe\$variable\ \textless{}-\ NULL} 명령문을 사용하면
데이터프레임(\texttt{dataframe})에 변수(\texttt{variable})를 날려보내는
효과가 있다. 예를 들어 책장이 아예 없다는 의미(\texttt{NULL})와 책장에
책이 없다(\texttt{NA})는 다른 개념을 지칭하고 쓰임새가 다르다.

\textbf{\texttt{NULL}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# NULL 자료형과 길이}
\FunctionTok{typeof}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "NULL"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0
\end{verbatim}

\textbf{\texttt{NA}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# NA 자료형과 길이}
\FunctionTok{typeof}\NormalTok{(}\ConstantTok{NA}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "logical"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\ConstantTok{NA}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
\end{verbatim}

\texttt{NA}의 중요한 특징은 전염된다는 것이다. 즉, \texttt{NA}에 연산을
가하면 연산결과는 무조건 \texttt{NA}가 된다. \texttt{NA}가 7보다 큰지,
7을 더하고 빼고, 부울 연산을 하든 \texttt{NA}와 연산결과는 무조건
\texttt{NA}가 된다.

\begin{Shaded}
\begin{Highlighting}[]
\ConstantTok{NA} \SpecialCharTok{+} \DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ConstantTok{NA} \SpecialCharTok{/} \DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ConstantTok{NA} \SpecialCharTok{\textgreater{}} \DecValTok{7}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{7} \SpecialCharTok{==} \ConstantTok{NA}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\ConstantTok{NA} \SpecialCharTok{==} \ConstantTok{NA}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
\end{verbatim}

\hypertarget{uxb370uxc774uxd130uxd504uxb808uxc784}{%
\chapter{데이터프레임}\label{uxb370uxc774uxd130uxd504uxb808uxc784}}

\textbf{R} 은 6가지 기본 벡터로 자료를 저장하지만, 이외에 행렬(matrix),
데이터프레임(data.frame), 리스트(list) 자료구조가 있다. 하지만,
자료분석을 위해서 데이터를 데이터셋의 형태로 구성을 해야한다. 데이터셋이
중요한 이유는 자료를 분석하기 위해서 다양한 형태의 개별 자료를
통합적으로 분석하기 위해서다. 이를 위해서 리스트 자료구조로 일단 모으게
된다. 예를 들어 개인 신용분석을 위해서는 개인의 소득, 부채, 성별, 학력
등등의 숫자형, 문자형, 요인(Factor)형 등의 자료를 데이터셋에 담아야
한다. 특히 변수와-관측값 (Variable-Observation) 형식의 자료를 분석하기
위해서는 데이터프레임(\texttt{data.frame})을 사용한다. 데이터프레임은
모든 변수에 대해서 관측값이 같은 길이를 갖도록 만들어 놓은 것이다.

\begin{figure}

{\centering \includegraphics{images/data_structure.jpg}

}

\caption{통계 자료구조}

\end{figure}

데이터프레임은 \texttt{data.frame} 함수를 사용해서 생성한다. R 객체 구조
파악을 위해서는 간단한 자료의 경우 데이터 형식을 확인할 수 있는 1--2줄
정도의 간단한 스크립트와 명령어를 통해서 확인이 가능하지만, 복잡한
데이터의 구조를 파악하기 위해서는 \texttt{summary} 함수와 \texttt{str}
함수를 통해서 확인해야 한다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 벡터를 정의한다.}
\NormalTok{name }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Mercury"}\NormalTok{, }\StringTok{"Venus"}\NormalTok{, }\StringTok{"Earth"}\NormalTok{, }\StringTok{"Mars"}\NormalTok{, }\StringTok{"Jupiter"}\NormalTok{, }\StringTok{"Saturn"}\NormalTok{, }\StringTok{"Uranus"}\NormalTok{, }\StringTok{"Neptune"}\NormalTok{)}
\NormalTok{type }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Terrestrial planet"}\NormalTok{, }\StringTok{"Terrestrial planet"}\NormalTok{, }\StringTok{"Terrestrial planet"}\NormalTok{, }
          \StringTok{"Terrestrial planet"}\NormalTok{, }\StringTok{"Gas giant"}\NormalTok{, }\StringTok{"Gas giant"}\NormalTok{, }\StringTok{"Gas giant"}\NormalTok{, }\StringTok{"Gas giant"}\NormalTok{)}
\NormalTok{diameter }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{0.382}\NormalTok{, }\FloatTok{0.949}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{0.532}\NormalTok{, }\FloatTok{11.209}\NormalTok{, }\FloatTok{9.449}\NormalTok{, }\FloatTok{4.007}\NormalTok{, }\FloatTok{3.883}\NormalTok{)}
\NormalTok{rotation }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{58.64}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{243.02}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{1.03}\NormalTok{, }\FloatTok{0.41}\NormalTok{, }\FloatTok{0.43}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.72}\NormalTok{, }\FloatTok{0.67}\NormalTok{)}
\NormalTok{rings }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# 벡터를 합쳐서 데이터프레임을 생성}
\NormalTok{planets\_df }\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(name, type, diameter, rotation, rings)}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-type-factor}{%
\section{범주형, 순서형 자료형}\label{data-type-factor}}

범주형, 순서형 자료형을 생성하는 경우 주의를 기울여야 한다.
\texttt{factor} 함수를 사용해서 요인형 자료형을 생성하는데, 내부적으로
저장공간을 효율적으로 사용하고 속도를 빠르게 하는데 유용한다. 순서를
갖는 범주형의 경우 \texttt{factor} 함수 내부에 \texttt{levels} 인자를
넣어 정의하면 순서 정보가 유지된다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 범주형}
\NormalTok{animals\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Elephant"}\NormalTok{, }\StringTok{"Giraffe"}\NormalTok{, }\StringTok{"Donkey"}\NormalTok{, }\StringTok{"Horse"}\NormalTok{)}
\NormalTok{factor\_animals\_vector }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(animals\_vector)}
\NormalTok{factor\_animals\_vector}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] Elephant Giraffe  Donkey   Horse   
Levels: Donkey Elephant Giraffe Horse
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 순위형}
\NormalTok{temperature\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"High"}\NormalTok{, }\StringTok{"Low"}\NormalTok{, }\StringTok{"High"}\NormalTok{,}\StringTok{"Low"}\NormalTok{, }\StringTok{"Medium"}\NormalTok{)}
\NormalTok{factor\_temperature\_vector }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(temperature\_vector, }\AttributeTok{order =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Low"}\NormalTok{, }\StringTok{"Medium"}\NormalTok{, }\StringTok{"High"}\NormalTok{))}
\NormalTok{factor\_temperature\_vector}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] High   Low    High   Low    Medium
Levels: Low < Medium < High
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# "M", "F" 수준}
\NormalTok{survey\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"M"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"M"}\NormalTok{, }\StringTok{"M"}\NormalTok{)}
\NormalTok{factor\_survey\_vector }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(survey\_vector)}
\FunctionTok{levels}\NormalTok{(factor\_survey\_vector)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "F" "M"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# "Female", "Male" 로 변환}
\FunctionTok{levels}\NormalTok{(factor\_survey\_vector) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Female"}\NormalTok{, }\StringTok{"Male"}\NormalTok{)}
\FunctionTok{levels}\NormalTok{(factor\_survey\_vector)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Female" "Male"  
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 문자형 벡터와 요인 벡터}
\NormalTok{survey\_vector }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"M"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"F"}\NormalTok{, }\StringTok{"M"}\NormalTok{, }\StringTok{"M"}\NormalTok{)}
\NormalTok{factor\_survey\_vector }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(survey\_vector)}

\CommentTok{\# 문자형 벡터 요약}
\FunctionTok{summary}\NormalTok{(survey\_vector)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Length     Class      Mode 
        5 character character 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 요인 벡터 요약}
\FunctionTok{summary}\NormalTok{(factor\_survey\_vector)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
F M 
2 3 
\end{verbatim}

\hypertarget{uxb370uxc774uxd130uxbca0uxc774uxc2a4}{%
\chapter{데이터베이스}\label{uxb370uxc774uxd130uxbca0uxc774uxc2a4}}

\hypertarget{uxb370uxc774uxd130uxbca0uxc774uxc2a4-uxae30uxbcf8uxc18cuxc591}{%
\section{데이터베이스
기본소양}\label{uxb370uxc774uxd130uxbca0uxc774uxc2a4-uxae30uxbcf8uxc18cuxc591}}

\hypertarget{classify-data}{%
\subsection{데이터 구분}\label{classify-data}}

데이터는 정형데이터(RDBMS), 비정형 데이터, 반정형 데이터로 크게 나눌 수
있다. 각 자료형에 따라 장단점이 있는 것은 명확하다. 정형데이터는
분석하기 용이한 반면 확장성과 유연성이 떨어지고, 비정형 데이터는
분석하기는 다소 어려움이 있으나 확장성과 용이성에서는 장점을 갖는다.
\texttt{.csv}, \texttt{.xml}, \texttt{.json} 파일은 그 중간적인 특성을
갖는 반정형 데이터로 분류도힌다.

\begin{figure}

{\centering \includegraphics{images/database_classification.png}

}

\caption{정형, 반정형, 비정형 데이터}

\end{figure}

\hypertarget{oltp-vs-olap}{%
\subsection{OLTP vs.~OLAP}\label{oltp-vs-olap}}

\textbf{OLTP} (OnLine Transaction Processing)는 데이터 자체 처리에
중점을 둔 개념인데 반해, \textbf{OLAP} (OnLine Analytical Processing)은
저장된 데이터를 분석하여 꿰뚤어 볼 수 있는 능력(Insight)를 도출하는데
중심을 두고 있다.

OLAP의 대표적인 예로 편의점 판매시점 정보관리(Point-Of-Sales, POS)
기계를 들어보자. 편의점에서 물건을 구매한 경우 다음과 같은 거래가
발생된다.

\begin{itemize}
\tightlist
\item
  고객 카드에서 현금 10,000원 인출
\item
  편의점 통장에 10,000 지급
\item
  명세표 출력
\end{itemize}

상기 3건의 작업 프로세스가 하나의 트랜잭션(transaction) 묶어 모두
성공적으로 처리가 되어야 편의점 물건구매가 완료되도록 개발한다.

반면에 OLAP은 데이터를 체계적으로 저장하여 데이터에 기반한
의사결정지원을 할 수 있도록 주안점을 두고 있다.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.1944}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.4028}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.4028}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
OLAP
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
OLTP
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
목적 & 트랜젝션 처리 & 데이터 분석과 보고서 작성, 대쉬보드 시각화 \\
설계 & 앱 기능 지향 & 비즈니스 주제 지향 \\
데이터 & 운영계, 실시간 최신 데이터 & 정보계, 통합/이력 데이터 \\
크기 & 기가 바이트, 스냅샷 & 테라데이터, 아카이브 \\
SQL 쿼리 & 단순 트랜잭션, 빈번한 갱신 & 복잡한 집계 쿼리 \\
사용자 & 아주 많음 & 분석가 포함 일부 \\
\end{longtable}

따라서, OLTP는 운영 데이터베이스(Operational Database)로 적합하여 쓰기
업무(Write-intensive)가 많은 경우 빠르고 안전하게 레코드를
삽입(insert)하는데 특화된 반면, OLAP은 데이터 창고(Data Warehouse)
업무에 적합한데 다양한 분석업무를 수행할 때 쿼리 작업을 속도감있게
진행할 수 있어 읽기 업무(Read-intensive)에 특화되어 있다.

\hypertarget{database-warehouse-lake}{%
\subsection{DW, 데이터 호수}\label{database-warehouse-lake}}

전통적인 데이터베이스(Database)는 관계형 데이터베이스를 통해서 실시간
정형데이터를 빠르고 신뢰성있게 처리하는데 운영계를 지탱하는 주된
쓰임새가 있으며, 데이터 창고(Data Warehouse)는 이력 데이터를 통합하여
꿰뚤어 볼 수 있는 능력(Insight)을 제공함은 물론 보고서와 전체적인 현황을
대쉬보드를 통해 제공하는데 큰 의미가 있다. \textbf{데이터 호수(Data
Lake)}는 정형, 반정형, 비정형 데이터를 모두 저장하고 관리한다는 측면에서
유연성과 확장성을 내재하고 있으며 빅데이터를 분석하여 OLAP에서 추구하는
바를 한단계 더 넓혔다는 점에서 의의를 둘 수 있다. \footnote{\href{https://www.talend.com/resources/data-lake-vs-data-warehouse/}{talend,
  ``\,``Four key differences between a data lake and a data warehouse}}

\includegraphics{images/database_data_lake.png}

데이터 호수(Data Lake)는 특정한 구조가 없기 때문에 접근하기 용이하고
쉽게 수정하기도 용이한 반면에 데이터 창고(Data Warehouse)는 상대적으로
유연성이 떨어진다. 뿐만 아니라 데이터 과학자는 아직 결정되지 않는
비즈니스 활용 사례를 데이터 문제로 바꿔 모형을 만들고 시각화를 하는데
데이터 호수를 적합한 데 반해 비즈니스 현업전문가는 일단 전처리가 된
데이터를 데이터 창고에 넣어 특정 목적을 달성하는데 활용된다는 점에서
비교가 된다.

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2055}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3973}}
  >{\centering\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3973}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
데이터 호수
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
데이터 창고
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
자료구조 & 원천 데이터 (Raw Data) & 전처리 된 데이터 \\
데이터 활용 목적 & 미결정 상태 & 현재 사용 중 \\
사용자 & 데이터 과학자 & 비즈니스 현업전문가 \\
접근성 & 접근성 높고 신속한 업데이트 & 변경하기 쉽지 않고 비용도 많이
소요됨. \\
\end{longtable}

클라우드 서비스도 데이터 창고(Data Warehouse)를 기능으로 제공하고 있는데
상품명은 다음과 같다.

\begin{itemize}
\tightlist
\item
  AWS: 아마존 Redshift
\item
  MS Azure: Azure SQL Data Warehouse
\item
  구글: 구글 빅쿼리(Big Query)
\end{itemize}

데이터 호수도 클라우드 서비스에서 제공된다. Object Storage와 함께
하둡/스파크 빅데이터 소프트웨어와 함께 검토된다.

\begin{itemize}
\tightlist
\item
  AWS: AWS S3
\item
  MS Azure: Blob Storage / Azure Data Lake Storage
\item
  구글: Cloud Storage
\item
  네이버: Object Storage
\end{itemize}

\hypertarget{etl-vs-elt}{%
\subsection{ETL과 ELT}\label{etl-vs-elt}}

ETL은 추출, 변환, 적재(Extract, Transform, Load)의 약자로 동일 기종 혹은
이기종의 원천데이터로부터 데이터 웨어하우스에서 쌓는 과정을 뜻하는데
변환(Transform) 과정이 무척 많은 노력이 투여된다. 반면에 ELT는 데이터를
먼저 적재한 후에 필요에 따라 변환과정을 거쳐 후속 작업에 사용한다.
데이터 호수 ELT 프로세스가 매력적으로 보이지만 데이터 카탈로그가 잘
관리되지 않는다면 \textbf{데이터 늪(Data Swamp)}가 될 수 있다.
\footnote{\href{https://medium.com/@thenortonsetup/dont-let-your-data-lake-turn-into-a-data-swamp-44dba717126b}{thenortonsetup
  (Jan 10, 2017), ``Don't Let Your Data Lake Turn Into A Data Swamp''}}

\begin{figure}

{\centering \includegraphics{images/databse_etl.png}

}

\caption{ETL과 ELT 비교}

\end{figure}

데이터 호수를 잘 관리하지 않는다면 데이터 늪에 빠질 수 있는데
메타데이터를 잘 관리하고 거버넌스를 확립해야 되고 비정형데이터도 많이
다루기 때문에 데이터 전문가 과학자를 확보하여 효율성을 높인다.

\begin{figure}

{\centering \includegraphics{images/database_swamp.png}

}

\caption{데이터 호수와 늪}

\end{figure}

\hypertarget{database-integration}{%
\subsection{데이터 통합(integration)}\label{database-integration}}

원천데이터가 서로 다른 형태로 다양하게 존재하는 상황에서 데이터를
통합한다는 것은 시스템을 맞추는 것을 넘어 개념적인 데이터 모델로
정립하여야 하고 관련하여 파생된느 다양한 문제를 조화롭게 해결하는 것으로
정의할 수 있다.

먼저 데이터를 한곳에 모은다고 하면 어떤 데이터를 모을 것인지 정의하고
클라우드 서비스를 사용한다고 하면 AWS Redshift 혹은 S3를 상정하고 혹시나
포함될 수 있는 개인정보도 사전에 식별하여 마스킹 등을 통해 익명화시켜야
되며 데이터 혈통(Data Lineage)도 구축하여 투명성과 가시성도 확보한다.

\begin{figure}

{\centering \includegraphics{images/database_lineage.png}

}

\caption{데이터 계통도}

\end{figure}

\hypertarget{table-partition}{%
\subsection{테이블 분할과 샤딩}\label{table-partition}}

지금은 빅데이터 시대라 데이터가 커지게 되면 테이블에 담을 수 없는 상황이
온다. 이런 문제를 해결하기 위해 도입된 개념이 \textbf{분할(Partition)}
이다. 테이블 크기가 예를 들어 100GB 혹은 1TB가 되면 인덱스도 커져서
메모리에 적재가 되지 않아 쿼리 속도와 업데이트 속도가 현격히 늦어지게
된다. 이런 경우 테이블을 더 작은 단위로 쪼개는데 이를
\textbf{분할(Partition)}이라고 한다.

테이블을 분할하게 될 경우 개념과 논리 데이터 모형은 동일하지만 물리
데이터 모형이 분할에 영향을 받게 된다.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  개념 데이터 모형(Concept Data Model): Entity, Relationship, Attributes

  \begin{itemize}
  \tightlist
  \item
    ERD(Entity Relational Diagram), UML 다이어그램
  \end{itemize}
\item
  논리 데이터 모형(Logical Data Model): 테이블, 칼럼, 관계

  \begin{itemize}
  \tightlist
  \item
    데이터베이스 스키마와 모형: 관계형 모형, 스타 스키마(Star Sceman)
  \item
    \textbf{분할(Partition)} 혹은 \textbf{샤딩(Sharding)}에 영향을 받음
  \end{itemize}
\item
  물리 데이터 모형(Physical Data Model): 물리적 저장장치

  \begin{itemize}
  \tightlist
  \item
    백업 시스템, 파티션, CPU, 저장공간 등
  \item
    \textbf{분할(Partition)} 혹은 \textbf{샤딩(Sharding)}의 영향을 받음.
  \end{itemize}
\end{enumerate}

테이블을 분할하는 방법은 수평 분할 (Horizontal Partitioning)과 수직 분할
(Vertical Partitioning) 두가지 방법이 있다.

\begin{figure}

{\centering \includegraphics{images/database_partition.png}

}

\caption{데이터 수평 및 수직 분할}

\end{figure}

\textbf{데이터베이스 샤딩(databae sharding)}은 테이블이 동일한
데이터베이스에 있지 않고 다른 기계에 있다는 점에서 차이가 난다.
\footnote{\href{https://www.cubrid.org/manual/ko/9.3.0/shard.html}{CUBRID
  SHARD, ``Database Sharding''}}

\begin{figure}

{\centering \includegraphics{images/database_sharding.png}

}

\caption{데이터베이스 샤딩(Sharding)}

\end{figure}

\hypertarget{db-design}{%
\section{데이터베이스 설계}\label{db-design}}

데이터베이스 설계(Database Design)는 데이터를 논리적으로 저장하는
방식으로 데이터베이스 모델(Database Model)을 사용한다. 데이터베이스
모델(Database Model)은 데이터베이스 구조에 대한 최상위 사양서의 역할을
한다. 일반적으로 관계형 데이터베이스 모형(Relational Database Model)을
사용하지만 NoSQL, 객체지향 DB 모형, 네트워크 DB 모델 등이 있다.
데이터베이스의 청사진으로 스키마를 사용해서 테이블, 필드, 관계, 인덱스,
뷰로 구성하여 작성한다.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  데이터 (Data) ← 논리 모형
\item
  데이터베이스 모형 ← 데이터 구조에 대한 사양서
\item
  스키마 ← 레고 블럭(Table, Field, Relation, Index, View 등)으로
  데이터베이스 설계
\end{enumerate}

즉, 데이터를 체계적으로 구조화하는 논리모형을 먼저 구상하고 나서
사양서를 작성하고 실제 데이터베이스 설계로 들어간다.

\hypertarget{db-design-in-practice}{%
\subsection{데이터 모형(Data Modeling)}\label{db-design-in-practice}}

데이터를 저장하는 방식에 대해 데이터 모형(Data Model)을 제작하는 단계는
다음과 같다.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  개념 데이터 모형(Concept Data Model): Entity, Relationship, Attributes

  \begin{itemize}
  \tightlist
  \item
    ERD(Entity Relational Diagram), UML 다이어그램
  \end{itemize}
\item
  논리 데이터 모형(Logical Data Model): 테이블, 칼럼, 관계

  \begin{itemize}
  \tightlist
  \item
    데이터베이스 스키마와 모형: 관계형 모형, 스타 스키마(Star Sceman)
  \end{itemize}
\item
  물리 데이터 모형(Physical Data Model): 물리적 저장장치

  \begin{itemize}
  \tightlist
  \item
    백업 시스템, 파티션, CPU, 저장공간 등
  \end{itemize}
\end{enumerate}

\hypertarget{data-normalization}{%
\subsection[데이터 정규화 ]{\texorpdfstring{데이터 정규화 \footnote{\href{https://ko.wikipedia.org/wiki/\%EB\%8D\%B0\%EC\%9D\%B4\%ED\%84\%B0\%EB\%B2\%A0\%EC\%9D\%B4\%EC\%8A\%A4_\%EC\%A0\%95\%EA\%B7\%9C\%ED\%99\%94}{위키
  백과, ``데이터베이스 정규화''}}
\footnote{\href{https://yaboong.github.io/database/2018/03/09/database-normalization-1/}{YABOONG
  (MARCH 9, 2018), ``데이터베이스 정규화 - 1NF, 2NF, 3NF''}}}{데이터 정규화  }}\label{data-normalization}}

관계형 데이터베이스의 설계에서 \textbf{정규화(normalization)}는 중복을
최소화하도록 데이터를 구조화하는 프로세스를 지칭한다. 관계형 모델의
발견자인 에드거 F. 커드는 1970년에 제 1 정규형(1NF)로 알려진 정규화의
개념을 도입하였고, 에드거 F. 커드는 이어서 제 2 정규형(2NF)과 제 3
정규형(3NF)을 1971년에 정의하였으며, 1974년에는 레이먼드 F. 보이스와
함께 보이스-코드 정규화(BCNF)를 정의하였다. 통상 관계형 데이터베이스
테이블이 제 3 정규(3NF)형이 되었으면 \textbf{정규화(Normalization)}
되었다고 한다. 따라서, 데이터 정규형(Normal Forms)은 1NF 부터 3NF까지가
많이 회자된다.

\begin{itemize}
\tightlist
\item
  제 1 정규형 (1 NF)

  \begin{itemize}
  \tightlist
  \item
    각 레코드는 유일무이(unique)해야 한다. 즉, 중복(duplication)이
    없어야 함.
  \item
    각 셀은 하나의 값만 가져야 함.
  \end{itemize}
\item
  제 2 정규형 (2 NF)

  \begin{itemize}
  \tightlist
  \item
    제 1 정규형을 만족한다.
  \item
    기본키(primary key)가 한 칼럼이면 자동으로 제 2 정규형을 만족한다.
  \item
    기본키가 아닌 모든 속성이 기본키에 완전 함수 종속되어야 한다.
  \end{itemize}
\item
  제 3 정규형 (3 NF)

  \begin{itemize}
  \tightlist
  \item
    제 2 정규형을 만족한다.
  \item
    기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않아야
    한다.
  \item
    즉, 이행(移行)적 함수 종속 (Transitive Functional Dependency)이
    없어야 한다.
  \item
    함수 종속 사례로 X, Y, Z 에 대해 X → Y 이고 Y → Z 이면 X → Z 가
    성립한다. 이를 Z 가 X 에 이행적으로 함수 종속되었다고 함.
  \end{itemize}
\end{itemize}

\hypertarget{dimensional-modeling}{%
\section[OLAP 차원 모델링 ]{\texorpdfstring{OLAP 차원 모델링
\footnote{\href{https://www.guru99.com/dimensional-model-data-warehouse.html}{Guru99,
  ``What is Dimensional Modeling in Data Warehouse?''}}}{OLAP 차원 모델링 }}\label{dimensional-modeling}}

데이터베이스 모델이은 크게 탑다운(top-down) ERD 방법론과 함께 ``데이터
창고(Data Warehouse)''에서 차원 모델링(DM, Dimensional Modeling)으로
나눠진다. 좀더 쉽게 이해를 하기 위해 GURU99에 나온 사례를 살펴보자. OLAP
차원 모델링은 다음 5단계로 이뤄진다.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  가장 먼저 비즈니스 프로세스를 하나 선택한다.

  \begin{itemize}
  \tightlist
  \item
    마케팅, 영업, 인사 등
  \end{itemize}
\item
  얼마나 자세히 볼 것인지 상세화 수준(grain)을 정의한다.

  \begin{itemize}
  \tightlist
  \item
    연도별, 분기별, 월별, 주별, 일별 등
  \end{itemize}
\item
  차원을 정의한다.

  \begin{itemize}
  \tightlist
  \item
    차원은 날짜, 지점, 공장 등을 지칭한다.
  \end{itemize}
\item
  사실(Fact)을 정의한다.

  \begin{itemize}
  \tightlist
  \item
    일자별 지점별 제품별 판매금액과 같이 숫자값이 된다.
  \end{itemize}
\item
  스키마를 제작한다.

  \begin{itemize}
  \tightlist
  \item
    상기 정보를 바탕으로 스타 스키마(Star Schema) 혹은 눈꽃
    스키마(Snowflake Schema) 를 작성한다.
  \end{itemize}
\end{enumerate}

상기 작업결과 사장님이 원하는 월별 지점별 직급별 판매실적을 스타
스키마로 제작하게 된다

\href{fig/dimensional_model.png}{}

\hypertarget{star-schema}{%
\subsection{스타 스키마}\label{star-schema}}

차원 모델링을 방법론으로 스타 스키마를 채택하게 되면 차원
테이블(dimensional table)과 사실 테이블(fact table)을 정의해야 되는데
차원 테이블은 되도록이면 변하지 않는 속성(attributes)을 갖게 되는 반면,
차원 테이블은 측정값에 대한 레코드가 축적되며 자주 변경되게 되고 차원
테이블과 외래키(foreign key)로 연결된다.

\hypertarget{chinook-database}{%
\section{\texorpdfstring{\texttt{chinook}
데이터베이스}{chinook 데이터베이스}}\label{chinook-database}}

치눅(\href{https://archive.codeplex.com/?p=chinookdatabase}{\texttt{chinook}})
데이터베이스는 Northwind 데이터베이스에서 유래되었으며,
\href{https://en.wikipedia.org/wiki/Chinook_wind}{치눅(chinooks)}은
캐나다 프레리(Canadian Prairies)과 미국 대평원(Great Plains)에서
발생되는 푄 바람(fohn winds)라고 한다.
\href{https://github.com/lerocha/chinook-database}{\texttt{lerocha/chinook-database}}
GitHub 저장소에 다양한 데이터베이스에 사용될 수 있도록 교육용으로 잘
준비되어 있다.

\hypertarget{chinook-database-erd}{%
\subsection{\texorpdfstring{\texttt{chinook}
ERD}{chinook ERD}}\label{chinook-database-erd}}

치눅 데이터베이스는 디지털 미디어 상점의 가상 데이터를 기반으로 한 공개
데이터베이스다. 치눅 데이터베이스는 앨범, 아티스트, 장르, 트랙, 재생
목록, 고객, 직원, 공급 업체를 담고 있는 테이블로 구성되어 있다.

\begin{itemize}
\tightlist
\item
  \textbf{Artists}: 아티스트의 이름과 정보를 포함합니다.
\item
  \textbf{Albums}: 각 앨범과 관련된 아티스트 정보를 포함합니다.
\item
  \textbf{Tracks}: 각 트랙의 이름, 앨범 ID, 장르 ID, 미디어 형식 및
  가격과 같은 정보를 포함합니다.
\item
  \textbf{Genres}: 음악의 장르(예: 록, 재즈, 팝 등) 정보를 포함합니다.
\item
  \textbf{Media} Types: 미디어 형식(예: MPEG 오디오 파일, ACC 오디오
  파일 등) 정보를 포함합니다.
\item
  \textbf{Playlists}: 재생 목록과 그에 관련된 트랙 정보를 포함합니다.
\item
  \textbf{Customers}: 고객의 세부 정보와 구매 이력 정보를 포함합니다.
\item
  \textbf{Invoices \& InvoiceItems}: 고객의 청구서와 청구서 항목에 대한
  정보를 포함합니다.
\item
  \textbf{Employees}: 직원 정보와 그들의 역할, 매니저, 고용 일자 등의
  정보를 포함합니다.
\item
  \textbf{Suppliers}: 공급 업체 정보를 포함합니다.
\item
  \textbf{Chinook} 데이터베이스는 실제 비즈니스 시나리오를 모방하여
  복잡한 쿼리, 프로시저 및 다른 데이터베이스 작업을 수행하기 위한 교육용
  플랫폼으로 사용됩니다.
\end{itemize}

각 테이블간의 관계는 \texttt{chinook} ERD를 통해서
\href{https://docs.yugabyte.com/latest/sample-data/chinook/}{YugaByte
DB}에서 확인할 수 있다.

\begin{figure}

{\centering \includegraphics{images/database_chinook.png}

}

\caption{치눅 데이터베이스 ERD}

\end{figure}

\hypertarget{chinook-helloworld}{%
\subsection{헬로 월드}\label{chinook-helloworld}}

먼저, \href{https://github.com/lerocha/chinook-database}{sqlite3
chinooks} 데이터베이스를 다운로드 한다. \footnote{\href{http://johnatten.com/2014/12/07/installing-and-using-sqlite-on-windows/}{John
  Atten (2014-12-07), ``Installing and Using SQLite on Windows''}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{download.file}\NormalTok{(}\AttributeTok{url =} \StringTok{"https://raw.githubusercontent.com/lerocha/chinook{-}database/master/ChinookDatabase/DataSources/Chinook\_Sqlite.sql"}\NormalTok{, }\AttributeTok{destfile =} \StringTok{"data/Chinook\_Sqlite.sql"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

쉘에서 아래 명령어로 sqlite3 데이터베이스를 생성시킨다. 제법 시간이
걸리기 때문에 \texttt{chinook.db} 생성이 완료된 후에 후속 분석 작업을
수행한다.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{$}\NormalTok{ sqlite3 chinook.db }\OperatorTok{\textless{}}\NormalTok{ Chinook\_Sqlite.sql}
\end{Highlighting}
\end{Shaded}

\texttt{DBI} 연결시켜 \texttt{chinook.db}를 R에서 작업할 수 있도록
준비시킨다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(DBI)}
\FunctionTok{library}\NormalTok{(RSQLite)}

\NormalTok{chinook }\OtherTok{\textless{}{-}} \FunctionTok{dbConnect}\NormalTok{(RSQLite}\SpecialCharTok{::}\FunctionTok{SQLite}\NormalTok{(), }\AttributeTok{dbname =} \StringTok{"data/chinook.db"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

R 마크다운에서 제대로 되는지 테스트 한다.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{SELECT} \OperatorTok{*} \KeywordTok{FROM}\NormalTok{ Artist }\KeywordTok{LIMIT} \DecValTok{10}\NormalTok{;}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{Displaying records 1 - 10}\tabularnewline
\toprule\noalign{}
ArtistId & Name \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
ArtistId & Name \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1 & AC/DC \\
2 & Accept \\
3 & Aerosmith \\
4 & Alanis Morissette \\
5 & Alice In Chains \\
6 & Antônio Carlos Jobim \\
7 & Apocalyptica \\
8 & Audioslave \\
9 & BackBeat \\
10 & Billy Cobham \\
\end{longtable}

SQLite에서는 모든 테이블, 인덱스, 트리거 및 뷰에 대한 메타데이터를
저장하는 특별한 \texttt{sqlite\_master} 테이블이 존재한다. SQLite
데이터베이스에서 테이블 목록을 다음 쿼리를 사용하여 확인한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbGetQuery}\NormalTok{(chinook, }\StringTok{\textquotesingle{}}
\StringTok{SELECT name, type }
\StringTok{         FROM sqlite\_master }
\StringTok{        WHERE type IN ("table", "view")}
\StringTok{\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
            name  type
1          Album table
2         Artist table
3       Customer table
4       Employee table
5          Genre table
6        Invoice table
7    InvoiceLine table
8      MediaType table
9       Playlist table
10 PlaylistTrack table
11         Track table
\end{verbatim}

미국에서 가장 많이 팔리는 장르는 무엇인가? 라는 질의문에 대한 SQL 쿼리를
다음과 같이 작성할 수 있다. 다음 SQL 쿼리는
\href{https://rpubs.com/qzeng1/case_questions_SQL_R}{SQLite in R -
Answering Questions with Data}에서 가져왔다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tracks\_usa }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}
\StringTok{WITH usa\_tracks\_sold AS}
\StringTok{   (}
\StringTok{    SELECT il.* }
\StringTok{      FROM InvoiceLine  il}
\StringTok{     INNER JOIN Invoice i on i.InvoiceId = il.InvoiceId}
\StringTok{     INNER JOIN Customer c on c.CustomerId = i.CustomerId}
\StringTok{     WHERE c.Country = "USA"}
\StringTok{   )}
\StringTok{SELECT g.name AS genre\_name,}
\StringTok{       COUNT(uts.InvoiceLineId) AS no\_of\_tracks\_sold,}
\StringTok{       CAST(COUNT(uts.InvoiceLineId) AS FLOAT) / (}
\StringTok{                                                    SELECT COUNT(*) }
\StringTok{                                                      FROM usa\_tracks\_sold}
\StringTok{                                                    ) AS percentage\_sold}
\StringTok{  FROM usa\_tracks\_sold uts}
\StringTok{ INNER JOIN Track  t on t.TrackId = uts.TrackId}
\StringTok{ INNER JOIN Genre  g on g.GenreId = t.GenreId}
\StringTok{ GROUP BY 1}
\StringTok{ ORDER BY 2 DESC}
\StringTok{ LIMIT 10;}
\StringTok{\textquotesingle{}}

\FunctionTok{dbGetQuery}\NormalTok{(chinook, tracks\_usa)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
           genre_name no_of_tracks_sold percentage_sold
1                Rock               157      0.31781377
2               Latin                91      0.18421053
3               Metal                64      0.12955466
4  Alternative & Punk                50      0.10121457
5                Jazz                22      0.04453441
6               Blues                15      0.03036437
7            TV Shows                14      0.02834008
8            R&B/Soul                12      0.02429150
9              Comedy                 8      0.01619433
10          Classical                 8      0.01619433
\end{verbatim}

챗GPT를 사용하여 다음과 같이 질의를 하게 되면 SQL 쿼리문을 생성해준다.

\begin{quote}
프롬프트: 매출 상위 10개 국가 목록을 뽑아주세요.
\end{quote}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbGetQuery}\NormalTok{(chinook, }\StringTok{\textquotesingle{}}
\StringTok{  SELECT }
\StringTok{      c.Country,}
\StringTok{      SUM(il.UnitPrice * il.Quantity) AS TotalRevenue}
\StringTok{  FROM Invoice i}
\StringTok{  JOIN InvoiceLine il ON i.InvoiceId = il.InvoiceId}
\StringTok{  JOIN Customer c ON i.CustomerId = c.CustomerId}
\StringTok{  GROUP BY c.Country}
\StringTok{  ORDER BY TotalRevenue DESC}
\StringTok{  LIMIT 10;}
\StringTok{\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
          Country TotalRevenue
1             USA       523.06
2          Canada       303.96
3          France       195.10
4          Brazil       190.10
5         Germany       156.48
6  United Kingdom       112.86
7  Czech Republic        90.24
8        Portugal        77.24
9           India        75.26
10          Chile        46.62
\end{verbatim}

\hypertarget{uxbb38uxc11c}{%
\chapter{문서}\label{uxbb38uxc11c}}

Robert Gentleman과 Duncan Temple Lang이 2004년 발표한 논문에서 공식적인
시작점을 찾을 수 있다.\footnote{``Statistical Analyses and Reproducible
  Research'' Bioconductor Project Working Papers} \footnote{``Reproducible
  Research: A Bioinformatics Case Study'' in Statistical Applications in
  Genetics and Molecular Biology}

\begin{quote}
We introduce the concept of a compendium as both a container for the
different elements that make up the document and its computations
(i.e.~text, code, data,\ldots), and as a means for distributing,
managing and updating the collection. - Gentleman, R. and Temple Lang,
D. (2004)
\end{quote}

\begin{tcolorbox}[enhanced jigsaw, leftrule=.75mm, toptitle=1mm, opacitybacktitle=0.6, rightrule=.15mm, toprule=.15mm, colbacktitle=quarto-callout-note-color!10!white, titlerule=0mm, left=2mm, arc=.35mm, bottomtitle=1mm, coltitle=black, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{노트}, opacityback=0, colframe=quarto-callout-note-color-frame, breakable, bottomrule=.15mm, colback=white]

R 팩키지는 재현가능한 데이터 분석 프로젝트를 위한 \textbf{연구
개요서(research compendia)}로 훌륭한 대안으로 역할을 수행할 수 있다.
연구 개요서는 코드, 데이터, 출력결과물 등이 포함된다.

R packages can serve as \textbf{research compendia} (including code,
data and outputs) for reproducible data analysis projects

\end{tcolorbox}

\hypertarget{papers-ropensci}{%
\section{\texorpdfstring{논문과 \texttt{ropensci}
진행경과}{논문과 ropensci 진행경과}}\label{papers-ropensci}}

\autocite{marwick2018packaging}

\begin{figure}

{\centering \includegraphics{images/compendium-rrtools.png}

}

\caption{재현가능한 과학연구를 위한 저작 방법}

\end{figure}

\begin{itemize}
\tightlist
\item
  \href{https://ropensci.org/commcalls/2019-07-30/}{\texttt{ropensci},
  ``Community Call: Reproducible Research with R''}
\end{itemize}

\hypertarget{compendium-intro}{%
\section{R 팩키지와 개요서}\label{compendium-intro}}

R 프로젝트, R 팩키지, 개요서(compendium)가 서로 동일한 목표를 가지고
있지만, 다소 차이가 있는 것도 사실이다. 데이터 사이언스를 하면서 코드,
데이터, 결과물을 하나의 개요서(compendium) 아래 묶어 이를 통해
재현가능한 과학기술 발전을 도모하는 것이 무엇보다 필요하다. \footnote{\href{https://github.com/ropensci/rrrpkg}{jennybc,
  ``Use of an R package to facilitate reproducible research''}}
\footnote{\href{https://github.com/Pakillo/template/blob/master/slides/Projects_as_Packages.pdf}{Francisco
  Rodriguez-Sanchez ``Structuring data anlaysis projects as R
  packages''}}

\begin{itemize}
\tightlist
\item
  좋은 데이터 사이언스 프로젝트 구성

  \begin{itemize}
  \tightlist
  \item
    모든 파일은 동일한 디렉토리 아래 정돈되어 있음
  \item
    원본 데이터(raw data)는 별도 폴더에 잘 저장되어 있어야 함.
  \item
    정제된 데이터는 R 스크립트를 통해서 만들어져야 함.
  \item
    함수는 분석 스크립트와 독립되어 저장되어야 함.
  \item
    함수는 문서화가 잘 되어야 하면 (단위) 테스트도 되어 ㅎ함.
  \item
    산출물은 코드와 격리되어야 하며 일회용으로 한번 사용하고 버림.
  \item
    \texttt{Makefile}은 적절한 순서로 분석을 실행해야 함.
  \item
    README 파일은 프로젝트 개요를 담고 있어야 함.
  \item
    \texttt{git}을 사용해서 R 코드와 Rmd 문서 파일은 버전 제어를 해야
    함.
  \end{itemize}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{project/}
\KeywordTok{|}\ExtensionTok{{-}+}\NormalTok{ data{-}raw/   }\CommentTok{\# 원본 데이터}
\KeywordTok{|}\ExtensionTok{{-}+}\NormalTok{ data/       }\CommentTok{\# (R 스크립트로부터 생성된) 정제된 데이터}
\KeywordTok{|}\ExtensionTok{{-}+}\NormalTok{ R/          }\CommentTok{\# 함수(Functions)}
\KeywordTok{|}\ExtensionTok{{-}+}\NormalTok{ man/        }\CommentTok{\# (Roxygen으로 생성된) 함수 문서(Function documentation)}
\KeywordTok{|}\ExtensionTok{{-}+}\NormalTok{ tests/      }\CommentTok{\# 테스트 (functions, Rmd)}
\KeywordTok{|}\ExtensionTok{{-}+}\NormalTok{ vignettes/  }\CommentTok{\# (Rmd로 작성된) 분석결과, 원고, 보고서 등}
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ Makefile    }\CommentTok{\# 자동화 시키는 마스터 스크립트}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ DESCRIPTION }\CommentTok{\# 메타데이터와 의존성}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ README      }\CommentTok{\# 프로젝트 개요서}
\end{Highlighting}
\end{Shaded}

상기와 같이 개요서를 R 팩키지를 통해 구현하게 되면 어떤 점이 좋은지
살펴보자.

\begin{itemize}
\tightlist
\item
  재현가능성: Reproducibility
\item
  일관되고, 표준적이며, 물흐르는 듯한 프로젝트 구조: Consistent,
  standard, streamlined organisation
\item
  모듈화, 문서화, 테스트 주도 철학을 증진: Promotes modular,
  well-documented and tested code
\item
  공유하기 쉬움: Easy to share (zip, GitHub repo)
\item
  설치와 실행이 쉬움: Easy to install \& run (Dependencies)
\item
  R 팩키지 제작 기계: Use R package development machinery:
\item
  R CMD CHECK
\item
  지속 개발/지속 배포: Continuous integration (Travis-CI)
\item
  \href{https://github.com/MangoTheCat/goodpractice}{goodpractice}로
  자동화된 코드리뷰: Automatic code review with goodpractice
\item
  \href{https://github.com/r-lib/pkgdown}{pkgdown}으로 프로젝트 웹사이트
  제작: Easily create project websites with pkgdown
\end{itemize}

\hypertarget{start-small}{%
\section{시작이 반이다}\label{start-small}}

\begin{itemize}
\tightlist
\item
  \href{cd-start-small.html}{시작이 반이다 - \texttt{start\ small}}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{project}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ DESCRIPTION}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ README.md  }
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ Metadata.txt}
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ data/                }
\KeywordTok{|}   \ExtensionTok{+{-}}\NormalTok{ 2014ParasiteSurveyJustBrood.csv}
\KeywordTok{|}   \ExtensionTok{+{-}}\NormalTok{ CedarBPLifeTable2014.csv}
\KeywordTok{|}   \ExtensionTok{+{-}}\NormalTok{ NorthBPLifeTable2013.txt}
\KeywordTok{|}   \ExtensionTok{+{-}}\NormalTok{ NorthBPLifeTable2014.csv}\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ analysis/}
\KeywordTok{|}   \ExtensionTok{+{-}}\NormalTok{ CodeforBPpaper.R}
\end{Highlighting}
\end{Shaded}

\hypertarget{pkg-development}{%
\section{팩키지 개발}\label{pkg-development}}

\begin{itemize}
\tightlist
\item
  \href{cd-pkg-development.html}{팩키지 개발}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{project}
\SpecialCharTok{|{-}}\NormalTok{ DESCRIPTION}
\SpecialCharTok{|{-}}\NormalTok{ NAMESPACE}
\SpecialCharTok{|{-}}\NormalTok{ README.md}
\SpecialCharTok{|{-}}\NormalTok{ LakeTrophicModelling.Rproj}
\SpecialCharTok{|}
\ErrorTok{|}\SpecialCharTok{{-}}\NormalTok{ R}\SpecialCharTok{/}
\ErrorTok{|}   \SpecialCharTok{+{-}}\NormalTok{ LakeTrophicModelling}\SpecialCharTok{{-}}\NormalTok{package.r}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ class\_prob\_rf.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ condAccuracy.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ crossval\_rf.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ density\_plot.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ ecdf\_ks\_ci.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ ecor\_map.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ getCyanoAbund.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ getLakeIDs.R}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ importancePlot.R}
\SpecialCharTok{|}
\ErrorTok{|}\SpecialCharTok{{-}}\NormalTok{ man}\SpecialCharTok{/}
\ErrorTok{|}   \SpecialCharTok{+{-}}\NormalTok{ class\_prob\_rf.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ condAccuracy.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ crossval\_rf.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ density\_plot.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ ecdf\_ks\_ci.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ ecor\_map.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ getCyanoAbund.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ getLakeIDs.Rd}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ importancePlot.Rd}
\SpecialCharTok{|}
\ErrorTok{|}\SpecialCharTok{{-}}\NormalTok{ data}\SpecialCharTok{/}                
\ErrorTok{|}   \SpecialCharTok{+{-}}\NormalTok{ LakeTrophicModelling.rda}
\SpecialCharTok{|}
\ErrorTok{|}\SpecialCharTok{{-}}\NormalTok{ vignettes}\SpecialCharTok{/}
\ErrorTok{|}
\ErrorTok{|}\SpecialCharTok{{-}}\NormalTok{ inst}\SpecialCharTok{/}
\ErrorTok{|}   \SpecialCharTok{+{-}}\NormalTok{ doc}\SpecialCharTok{/}
\ErrorTok{|}      \SpecialCharTok{+{-}}\NormalTok{ manuscript.pdf}
\SpecialCharTok{|}   \SpecialCharTok{+{-}}\NormalTok{ extdata}\SpecialCharTok{/}
\ErrorTok{|}      \SpecialCharTok{+{-}}\NormalTok{ ltmData.csv}
\SpecialCharTok{|}      \SpecialCharTok{+{-}}\NormalTok{ data\_def.csv}
\end{Highlighting}
\end{Shaded}

\hypertarget{cicd-docker}{%
\section{CI/CD와 도커}\label{cicd-docker}}

\texttt{Dockerfile} 파일을 추가하여 환경도 재현가능하게 만들 수 있고,
\texttt{.travis.yml}을 추가하여 CI/CD 환경도 구축할 수 있다.
\texttt{tests/}를 추가하여 테스트 주도 개발(test-driven development,
TDD)를 시도할 수 있고, 이를 통해 수작업 검증을 자동화하여 생산성과
품질을 대폭 향상시킬 수도 있다.

\begin{Shaded}
\begin{Highlighting}[]
\ExtensionTok{project}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ DESCRIPTION          }\CommentTok{\# project metadata and dependencies }
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ README.md            }\CommentTok{\# top{-}level description of content and guide to users}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ NAMESPACE            }\CommentTok{\# exports R functions in the package for repeated use}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ LICENSE              }\CommentTok{\# specify the conditions of use and reuse of the code, data \& text}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ .travis.yml          }\CommentTok{\# continuous integration service hook for auto{-}testing at each commit}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ Dockerfile           }\CommentTok{\# makes a custom isolated computational environment for the project}
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ data/                }\CommentTok{\# raw data, not changed once created}
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ my\_data.csv       }\CommentTok{\# data files in open formats such as TXT, CSV, TSV, etc.}
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ analysis/            }\CommentTok{\# any programmatic code}
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ my\_report.Rmd     }\CommentTok{\# R markdown file with narrative text interwoven with code chunks }
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ makefile          }\CommentTok{\# builds a PDF/HTML/DOCX file from the Rmd, code, and data files}
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ scripts/          }\CommentTok{\# code files (R, shell, etc.) used for data cleaning, analysis and visualisation }
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ R/                     }
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ my\_functions.R    }\CommentTok{\# custom R functions that are used more than once throughout the project}
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ man/}
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ my\_functions.Rd   }\CommentTok{\# documentation for the R functions (auto{-}generated when using devtools)}
\KeywordTok{|}
\KeywordTok{|}\ExtensionTok{{-}}\NormalTok{ tests/}
\KeywordTok{|}  \ExtensionTok{+{-}}\NormalTok{ testthat.R        }\CommentTok{\# unit tests of R functions to ensure they perform as expected}
\end{Highlighting}
\end{Shaded}

\hypertarget{case-by-case-template}{%
\section{각 사례별 템플릿}\label{case-by-case-template}}

\begin{itemize}
\tightlist
\item
  \href{https://github.com/jhollist/manuscriptPackage}{Jeff Hollister's
  manuscriptPackage}
\item
  \href{https://github.com/cboettig/template}{Carl Boettiger's template}
\item
  \href{https://github.com/Pakillo/template}{Francisco
  Rodriguez-Sanchez's template}
\item
  \href{https://github.com/benmarwick/researchcompendium}{Ben Marwick's
  researchcompendium}

  \begin{itemize}
  \tightlist
  \item
    \href{https://github.com/benmarwick/rrtools}{\texttt{rrtools}: Tools
    for Writing Reproducible Research in R}
  \end{itemize}
\end{itemize}

\hypertarget{uxbcf4uxace0uxc11c-uxc790uxb3d9uxd654}{%
\chapter{보고서 자동화}\label{uxbcf4uxace0uxc11c-uxc790uxb3d9uxd654}}

\hypertarget{uxbcf4uxace0uxc11c-uxc791uxc131-uxc791uxc5c5uxd750uxb984}{%
\section{보고서 작성
작업흐름}\label{uxbcf4uxace0uxc11c-uxc791uxc131-uxc791uxc5c5uxd750uxb984}}

일반적인 보고서 작성을 위한 작업흐름과 필요한 요소는 다음과 같다. 데이터
기반 보고서를 작성할 때 데이터와 데이터를 처리하는데 필요한
R/SAS/SPSS/파이썬 스크립트, 마크다운으로 작성한 문서가 포함된다. 즉,
데이터를 데이터베이스, 웹, 파일형태로 가져오면 R 스크립트를 통해
전처리를 하고 필요한 통계량을 뽑아내고 시각적으로 히스토그램,
막대그래프, 원그래프, 시계열 추세 선 그래프 등이 포함된다. 그리고,
데이터에서 나온 다양한 통계량 및 시각적 산출물에 대한 견해와 함께 최종
보고서 작성자의 의견을 덧붙여 마무리하고 보고서 작성자, 참고문헌, 목차,
각주 등을 붙여 보고서를 완성한다.

GUI가 아닌 CLI 방식으로 데이터를 분석한 후에 이를 \texttt{.R} 파일로
저장하고 나서 이를 \texttt{.Rmd} 파일(코드와 문서)로 함께 작성한 뒤에
이를 기계에 던져 원하는 형태의 문서 \texttt{.pdf}, \texttt{.html},
\texttt{.docx} 파일을 뽑아내서 웹, PC 배포문서, 저작 가능한 문서 형태로
배포한다.

\begin{figure}

{\centering \includegraphics{images/report-single-automation.png}

}

\caption{일별 통계보고서 자동화}

\end{figure}

\hypertarget{uxb2e4uxc218-uxbcf4uxace0uxc11c-uxc790uxb3d9-uxc0dduxc131}{%
\section{다수 보고서 자동
생성}\label{uxb2e4uxc218-uxbcf4uxace0uxc11c-uxc790uxb3d9-uxc0dduxc131}}

하루일과는 아침에 일어나서 밥을 먹고, 학교나 회사에 출근하고, 점심먹고,
오후에 놀거나 추가 작업을 하고, 퇴근을 하고 저녁을 먹고, 쉬고 잠을 자는
과정이 일반적인 일상이다. 이런 과정이 매일 매일 반복된다. 마찬가지로
보고서도 이런 일상적인 과정을 담아내야 한다. 즉, 일별로 생성되는
데이터를 동일한 형태의 보고서로 작성하게 된다. 이를 위해 상기 ``일반적인
보고서 작성 흐름''을 복사해서 붙여넣기 신공을 발휘하기 보다는 데이터를
바꿔넣고 해당 데이터를 매개변수(parameter)로 던져서 일별 보고서를
자동화시킨다.

따라서, 일자 정보를 \texttt{.Rmd} 파일에 전달하는 과정을 거치는 것이
필요하고, 통계보고서를 자동생성시키는 과정을 별도 스크립트로 만들어서
실행시킨다.

\begin{figure}

{\centering \includegraphics{images/report-many-automation.png}

}

\caption{주간/월간 통계보고서 자동화}

\end{figure}

\hypertarget{uxbcf4uxace0uxc11c-uxc0dduxc131-uxc790uxb3d9uxd654-r}{%
\section{보고서 생성 자동화
(R)}\label{uxbcf4uxace0uxc11c-uxc0dduxc131-uxc790uxb3d9uxd654-r}}

보고서 생성 자동화 프로세스를 구현하는 방법은 다양하다. RStudio
통합개발도구를 바탕으로 운영체제 쉘로 내려가지 않고 R 스크립트 내에서
작업하는 업무 구현사례는 다음과 같다.

즉, 다양한 보고서 템프릿을 생성시켜놓는다. 일별, 주별, 월별, 년도별
보고서를 템플릿형태로 작성하고 나서 내용을 채워 넣는다.

보고서 내용보다 변하는 것이 데이터가 된다. 2017-01-01 데이터부터 일별로
데이터가 쭉 생성된다. 이를 일자별로, 주별, 월별, 연도별로 인식한 후 이에
대한 적절한 데이터 분석결과를 담아내는 분석 R 스크립트를 활용한다.

데이터, 보고서 콘텐츠, 데이터분석 스크립트가 모두 준비되면 이를
리포트보고서(.Rmd)가 담고 있어야 한다. 마지막으로
\texttt{make\_report.r}을 실행하여 보고서를 자동생성 시킨다.

\begin{figure}

{\centering \includegraphics{images/report-automation-before-after.png}

}

\caption{주간/월간 통계보고서 자동화 구현사례}

\end{figure}

\hypertarget{uxbcf4uxace0uxc11c-make-uxd30cuxc77c}{%
\subsection{보고서 Make
파일}\label{uxbcf4uxace0uxc11c-make-uxd30cuxc77c}}

일자별로 보고서를 생성시키기 위해서 보고서에 일자를 \texttt{.Rmd} 파일에
넘겨야 한다. 우선 일자 정보를 보고서에 전달할 수 있는 형태로 만들기
위해서 다음과정을 거친다.

\begin{itemize}
\tightlist
\item
  리포트 생성일자를 자동 생성
\item
  월, 일을 뽑아내고 0을 덧붙여 일자를 두자리로 생성
\item
  해당 리포트는 \texttt{daily\_cars\_report.Rmd} 파일에 \texttt{params}
  리스트로 월(\texttt{dmonth})과 일(\texttt{dday})을 넘김.
\item
  출력결과는 \texttt{html\_document} 형식으로 지정
\item
  한국어가 깨지는 문제가 있어 인코딩은 \texttt{UTF-8}으로 필히 지정
\item
  1월1일부터 5월18일까지 일별로 돌리게 되면 오류가 생겨는 경우 이를
  무시하고 계속 보고서 생성시키도록 \texttt{try}, \texttt{silent=TRUE}를
  지정하여 넘김.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(stringr)}
\FunctionTok{library}\NormalTok{(lubridate)}

\NormalTok{reporting\_date }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(}\StringTok{"2017{-}01{-}01"}\NormalTok{), }\FunctionTok{as.Date}\NormalTok{(}\StringTok{"2017{-}05{-}18"}\NormalTok{), }\AttributeTok{by =} \StringTok{"day"}\NormalTok{)}


\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in}\NormalTok{ reporting\_date) \{}
    \DocumentationTok{\#\# 날짜뽑아내기}
\NormalTok{    xmonth }\OtherTok{\textless{}{-}} \FunctionTok{month}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(i, }\AttributeTok{origin=}\StringTok{"1970{-}01{-}01"}\NormalTok{))}
\NormalTok{    xday }\OtherTok{\textless{}{-}} \FunctionTok{day}\NormalTok{(}\FunctionTok{as.Date}\NormalTok{(i, }\AttributeTok{origin=}\StringTok{"1970{-}01{-}01"}\NormalTok{))}
\NormalTok{    dmonth }\OtherTok{\textless{}{-}}\NormalTok{ stringr}\SpecialCharTok{::}\FunctionTok{str\_pad}\NormalTok{(xmonth, }\DecValTok{2}\NormalTok{, }\AttributeTok{pad=}\StringTok{"0"}\NormalTok{)}
\NormalTok{    dday }\OtherTok{\textless{}{-}}\NormalTok{ stringr}\SpecialCharTok{::}\FunctionTok{str\_pad}\NormalTok{(xday, }\DecValTok{2}\NormalTok{, }\AttributeTok{pad=}\StringTok{"0"}\NormalTok{)}
    \DocumentationTok{\#\# 보고서 생성}
    \FunctionTok{try}\NormalTok{(}
\NormalTok{        rmarkdown}\SpecialCharTok{::}\FunctionTok{render}\NormalTok{(}\StringTok{\textquotesingle{}./report/daily\_cars\_report.Rmd\textquotesingle{}}\NormalTok{,}
                      \AttributeTok{params =} \FunctionTok{list}\NormalTok{(}
                          \AttributeTok{dmonth =}\NormalTok{ dmonth,}
                          \AttributeTok{dday   =}\NormalTok{ dday),}
                      \AttributeTok{output\_format=}\StringTok{"html\_document"}\NormalTok{,}
                      \AttributeTok{output\_file =}\FunctionTok{paste0}\NormalTok{ (}\StringTok{"daily\_cars\_2017"}\NormalTok{, dmonth, dday, }\StringTok{".html"}\NormalTok{),}
                      \AttributeTok{encoding =} \StringTok{\textquotesingle{}UTF{-}8\textquotesingle{}}
\NormalTok{        ),}
    \AttributeTok{silent =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxb9e4uxac1cuxbcc0uxc218uxb97c-uxbc1buxb294-uxbcf4uxace0uxc11c}{%
\subsection{매개변수를 받는
보고서}\label{uxb9e4uxac1cuxbcc0uxc218uxb97c-uxbc1buxb294-uxbcf4uxace0uxc11c}}

\texttt{make\_report.r} 파일에서 정의된 매개변수(parameter)를 받는
\texttt{.Rmd} 파일은 다음과 같은 모양이 된다. 즉, YAML 헤더에 params에
\texttt{dmonth}, \texttt{dday}를 정의하고 이를
\texttt{params\$dmonth,\ params\$dday}로 문서의 변수로 적용한다. 이를
통해 일자별로 생성되는 데이터를 자동으로 분석하여 보고서를
자동생성시키게 된다.

\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{{-}{-}{-}}
\NormalTok{title}\SpecialCharTok{:}\NormalTok{ 보고서 예제}
\NormalTok{date}\SpecialCharTok{:} \StringTok{\textquotesingle{}\textasciigrave{}r strftime(Sys.time(), format = "\%B \%d, \%Y")\textasciigrave{}\textquotesingle{}}
\NormalTok{output}\SpecialCharTok{:}
\NormalTok{  html\_document}\SpecialCharTok{:}
\NormalTok{    toc}\SpecialCharTok{:}\NormalTok{ yes}
\NormalTok{    toc\_depth}\SpecialCharTok{:} \DecValTok{2}
\NormalTok{params}\SpecialCharTok{:}
\NormalTok{    dmonth}\SpecialCharTok{:}
\NormalTok{        value}\SpecialCharTok{:}\NormalTok{ x}
\NormalTok{    dday}\SpecialCharTok{:}
\NormalTok{        value}\SpecialCharTok{:}\NormalTok{ x}
\SpecialCharTok{{-}{-}{-}}

\CommentTok{\#\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r, include = F\}}
\NormalTok{knitr}\SpecialCharTok{::}\NormalTok{opts\_chunk}\SpecialCharTok{$}\FunctionTok{set}\NormalTok{(}\AttributeTok{echo =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{warning =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{message =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{library}\NormalTok{(tidyverse)}

\FunctionTok{options}\NormalTok{(}\AttributeTok{scipen =} \DecValTok{999}\NormalTok{, }\AttributeTok{stringsAsFactors =} \ConstantTok{FALSE}\NormalTok{)}
\CommentTok{\#\textasciigrave{}\textasciigrave{}\textasciigrave{}}

\DocumentationTok{\#\#\# 3.3. 보고서 시작합니다.}

\CommentTok{\#\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r, sample{-}report\}}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(params}\SpecialCharTok{$}\NormalTok{directory, params}\SpecialCharTok{$}\NormalTok{file, }\AttributeTok{sep =} \StringTok{\textquotesingle{}/\textquotesingle{}}\NormalTok{))}
\FunctionTok{getwd}\NormalTok{()}
\NormalTok{dataset }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"../data/cars\_2017"}\NormalTok{, params}\SpecialCharTok{$}\NormalTok{dmonth, params}\SpecialCharTok{$}\NormalTok{dday, }\StringTok{".rds"}\NormalTok{))}
\FunctionTok{glimpse}\NormalTok{(dataset)}
\CommentTok{\#\textasciigrave{}\textasciigrave{}\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxc608uxce21uxbaa8uxd615-uxbcf4uxace0uxc11c}{%
\section{예측모형
보고서}\label{uxc608uxce21uxbaa8uxd615-uxbcf4uxace0uxc11c}}

R 스크립트로 데이터 분석과정을 프로그래밍하게 되면, 이를 다양한 R
팩키지와 조합하여 예측모형을 담은 보고서도 손쉽게 작성할 수 있다.

\begin{figure}

{\centering \includegraphics{images/predictive_model_automation.png}

}

\caption{예측모형 보고서 자동화}

\end{figure}

\begin{itemize}
\tightlist
\item
  데이터

  \begin{itemize}
  \tightlist
  \item
    원본작업데이터: 로그파일, 엑셀파일, RDBMS 등
  \item
    R 바이너리 파일: 아스키 형태 데이터(.csv 등)로 저장할 경우 메타
    정보가 증발하여 R 작업흐름에 태워서 사용할 경우 \texttt{.rds}와 같은
    R 바이너리 파일이 유용하다.
  \item
    보고서 HTML 파일: 최종 산출물 보고서
  \end{itemize}
\item
  R 스크립트

  \begin{itemize}
  \tightlist
  \item
    원본 데이터를 정제하는 R 스크립트
  \item
    보고서 혹은 예측모형을 산출하는 R 스크립트
  \end{itemize}
\end{itemize}

\hypertarget{uxc6d0uxbcf8uxb370uxc774uxd130-uxc815uxc81c}{%
\subsection{원본데이터
정제}\label{uxc6d0uxbcf8uxb370uxc774uxd130-uxc815uxc81c}}

윈도우 터미널을 열고 \texttt{RScript} 명령어를 실행한다.

\begin{itemize}
\tightlist
\item
  R 정제 파일: \texttt{cleansing\_code.R}
\item
  데이터 디렉토리: \texttt{../data}
\item
  채팅 로그 파일: \texttt{abc.txt}
\item
  처리결과 저장 디렉토리: \texttt{../data\_processed}
\item
  처리결과 파일명: \texttt{abc\_clean.rds}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{C}\SpecialCharTok{:}\NormalTok{\textbackslash{}xwMOOC\_project\textbackslash{}code}\SpecialCharTok{\textgreater{}}\NormalTok{ RScript cleansing\_code.R }\StringTok{"../data"} \StringTok{"abc.txt"} \StringTok{"../data\_processed"}

\NormalTok{[}\DecValTok{1}\NormalTok{] }\StringTok{"../data\_processed}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{abc\_clean.rds"}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxbcf4uxace0uxc11c-uxc0dduxc131}{%
\subsection{보고서 생성}\label{uxbcf4uxace0uxc11c-uxc0dduxc131}}

정제된 데이터(\texttt{.rds})를 통계분석하여 예측모형이 포함된 보고서를
생성한다.

\begin{itemize}
\tightlist
\item
  R make 파일: \texttt{make\_report.R}
\item
  보고서 Rmd 파일: \texttt{report\_automation.Rmd} 은
  \texttt{make\_report.R} 파일 내 지정됨
\item
  정제된 데이터 디렉토리: \texttt{data\_processed}
\item
  정제된 데이터 파일: \texttt{abc\_clean.rds}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{C}\SpecialCharTok{:}\NormalTok{\textbackslash{}xwMOOC\_project\textbackslash{}report}\SpecialCharTok{\textgreater{}}\NormalTok{ RScript make\_report.R }\StringTok{"data\_processed"} \StringTok{"abc\_clean.rds"}

\NormalTok{processing file}\SpecialCharTok{:}\NormalTok{ report\_automation.Rmd}
\NormalTok{output file}\SpecialCharTok{:}\NormalTok{ report\_automation.knit.md}

\NormalTok{Output created}\SpecialCharTok{:}\NormalTok{ report\_abc\_clean\_file.html}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxbaa8uxd615-uxad00uxb9ac}{%
\chapter{모형 관리}\label{uxbaa8uxd615-uxad00uxb9ac}}

\hypertarget{uxbaa8uxd615-uxce74uxb4dc}{%
\section{모형 카드}\label{uxbaa8uxd615-uxce74uxb4dc}}

모형 카드(``Model Card'')는 기계 학습 모델의 성능, 사용 사례, 제한 사항
및 이상적인 운영 조건 등의 중요한 세부 사항을 기술하는 문서를 지칭한다.
Model Card의 주요 목적은 기계학습 모형 사용자에게 모형 특성과 제한
사항을 명확하게 알려주어, 모형이 적절하게 사용할 수 있도록 돕는 것이다.

모형 카드(Model Card)는 기계 학습 모델의 다양한 측면을 설명하기 위해
다음 정보를 포함하고 있다.

\begin{itemize}
\tightlist
\item
  모델 정보(Model Information)

  \begin{itemize}
  \tightlist
  \item
    모델 이름
  \item
    버전
  \item
    사용 사례
  \item
    모델 아키텍처
  \item
    학습 알고리즘
  \item
    라이센스 정보 등
  \end{itemize}
\item
  데이터셋 정보(Dataset Information)

  \begin{itemize}
  \tightlist
  \item
    학습 데이터셋 설명
  \item
    검증 데이터셋 설명
  \item
    테스트 데이터셋 설명
  \item
    데이터 수집 방법
  \item
    데이터 처리 방법 등
  \end{itemize}
\item
  모델 성능(Metrics)

  \begin{itemize}
  \tightlist
  \item
    전체 성능 지표
  \item
    하위그룹별 성능 지표
  \item
    가능한 경우, 편향(bias) 분석 결과
  \end{itemize}
\item
  편향 및 공정성 평가(Bias \& Fairness Evaluation)

  \begin{itemize}
  \tightlist
  \item
    고려된 편향 요소
  \item
    평가 방법
  \item
    결과 및 해석
  \end{itemize}
\item
  사용 상황 및 제한 사항(Use-case \& Limitations)

  \begin{itemize}
  \tightlist
  \item
    추천되는 사용 사례
  \item
    추천되지 않는 사용 사례
  \item
    알려진 제한 사항
  \end{itemize}
\item
  모델 관리 및 업데이트(Model Management)

  \begin{itemize}
  \tightlist
  \item
    업데이트 빈도
  \item
    업데이트 메커니즘
  \item
    모델의 사용 기간
  \end{itemize}
\item
  추가 정보(Additional Information)

  \begin{itemize}
  \tightlist
  \item
    연구 논문 또는 참조 자료
  \item
    문의처
  \item
    관련 웹사이트 링크 등
  \end{itemize}
\end{itemize}

\hypertarget{uxd3aduxadc4-uxc131uxbcc4uxc608uxce21}{%
\section{펭귄 성별예측}\label{uxd3aduxadc4-uxc131uxbcc4uxc608uxce21}}

파머펭귄 데이터셋에서 결측값을 제거하고 기계학습모형을 훈련, 시험
데이터로 나누고 모형성능을 평가한 후 펭귄 암수성별 예측 모형을 배포한다.
\texttt{Code\ Interpreter}를 사용해서 코드를 작성한다.

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{from}\NormalTok{ sklearn.model\_selection }\ImportTok{import}\NormalTok{ train\_test\_split}
\ImportTok{from}\NormalTok{ sklearn.preprocessing }\ImportTok{import}\NormalTok{ OneHotEncoder}
\ImportTok{from}\NormalTok{ sklearn.linear\_model }\ImportTok{import}\NormalTok{ LogisticRegression}
\ImportTok{from}\NormalTok{ sklearn.metrics }\ImportTok{import}\NormalTok{ accuracy\_score, classification\_report}

\CommentTok{\# Load the dataset}
\NormalTok{penguins }\OperatorTok{=}\NormalTok{ pd.read\_csv(}\StringTok{\textquotesingle{}data/penguins.csv\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Preprocessing}
\NormalTok{penguins[}\StringTok{\textquotesingle{}bill\_length\_mm\textquotesingle{}}\NormalTok{].fillna(penguins[}\StringTok{\textquotesingle{}bill\_length\_mm\textquotesingle{}}\NormalTok{].median(), inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{penguins[}\StringTok{\textquotesingle{}bill\_depth\_mm\textquotesingle{}}\NormalTok{].fillna(penguins[}\StringTok{\textquotesingle{}bill\_depth\_mm\textquotesingle{}}\NormalTok{].median(), inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{penguins[}\StringTok{\textquotesingle{}flipper\_length\_mm\textquotesingle{}}\NormalTok{].fillna(penguins[}\StringTok{\textquotesingle{}flipper\_length\_mm\textquotesingle{}}\NormalTok{].median(), inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{penguins[}\StringTok{\textquotesingle{}body\_mass\_g\textquotesingle{}}\NormalTok{].fillna(penguins[}\StringTok{\textquotesingle{}body\_mass\_g\textquotesingle{}}\NormalTok{].median(), inplace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{penguins }\OperatorTok{=}\NormalTok{ penguins.dropna(subset}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}sex\textquotesingle{}}\NormalTok{])}

\CommentTok{\# Splitting the data into training and testing sets}
\NormalTok{X }\OperatorTok{=}\NormalTok{ penguins.drop(columns}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}rowid\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}sex\textquotesingle{}}\NormalTok{])}
\NormalTok{y }\OperatorTok{=}\NormalTok{ penguins[}\StringTok{\textquotesingle{}sex\textquotesingle{}}\NormalTok{]}
\NormalTok{X\_train, X\_test, y\_train, y\_test }\OperatorTok{=}\NormalTok{ train\_test\_split(X, y, test\_size}\OperatorTok{=}\FloatTok{0.2}\NormalTok{, random\_state}\OperatorTok{=}\DecValTok{42}\NormalTok{)}

\CommentTok{\# One{-}hot encoding categorical variables}
\NormalTok{encoder }\OperatorTok{=}\NormalTok{ OneHotEncoder(drop}\OperatorTok{=}\StringTok{\textquotesingle{}first\textquotesingle{}}\NormalTok{)}
\NormalTok{encoded\_train }\OperatorTok{=}\NormalTok{ encoder.fit\_transform(X\_train[[}\StringTok{\textquotesingle{}species\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}island\textquotesingle{}}\NormalTok{]])}
\NormalTok{encoded\_test }\OperatorTok{=}\NormalTok{ encoder.transform(X\_test[[}\StringTok{\textquotesingle{}species\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}island\textquotesingle{}}\NormalTok{]])}
\NormalTok{X\_train\_encoded }\OperatorTok{=}\NormalTok{ pd.concat([X\_train.drop(columns}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}species\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}island\textquotesingle{}}\NormalTok{]), pd.DataFrame(encoded\_train.toarray(), index}\OperatorTok{=}\NormalTok{X\_train.index)], axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}
\NormalTok{X\_test\_encoded }\OperatorTok{=}\NormalTok{ pd.concat([X\_test.drop(columns}\OperatorTok{=}\NormalTok{[}\StringTok{\textquotesingle{}species\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}island\textquotesingle{}}\NormalTok{]), pd.DataFrame(encoded\_test.toarray(), index}\OperatorTok{=}\NormalTok{X\_test.index)], axis}\OperatorTok{=}\DecValTok{1}\NormalTok{)}

\CommentTok{\# 데이터 프레임의 모든 열 이름을 문자열로 변환}
\NormalTok{X\_train\_encoded.columns }\OperatorTok{=}\NormalTok{ X\_train\_encoded.columns.astype(}\BuiltInTok{str}\NormalTok{)}
\NormalTok{X\_test\_encoded.columns }\OperatorTok{=}\NormalTok{ X\_test\_encoded.columns.astype(}\BuiltInTok{str}\NormalTok{)}


\CommentTok{\# Training a logistic regression model}
\NormalTok{clf }\OperatorTok{=}\NormalTok{ LogisticRegression(max\_iter}\OperatorTok{=}\DecValTok{1000}\NormalTok{)}
\NormalTok{clf.fit(X\_train\_encoded, y\_train)}

\CommentTok{\# Predictions}
\NormalTok{y\_pred }\OperatorTok{=}\NormalTok{ clf.predict(X\_test\_encoded)}

\CommentTok{\# Model evaluation}
\NormalTok{accuracy }\OperatorTok{=}\NormalTok{ accuracy\_score(y\_test, y\_pred)}
\NormalTok{classification\_rep }\OperatorTok{=}\NormalTok{ classification\_report(y\_test, y\_pred)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Accuracy:"}\NormalTok{, accuracy)}
\BuiltInTok{print}\NormalTok{(}\StringTok{"Classification Report:"}\NormalTok{, classification\_rep)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Accuracy: 0.8955223880597015
Classification Report:               precision    recall  f1-score   support

      female       0.94      0.86      0.90        36
        male       0.85      0.94      0.89        31

    accuracy                           0.90        67
   macro avg       0.90      0.90      0.90        67
weighted avg       0.90      0.90      0.90        67
\end{verbatim}

\hypertarget{uxc131uxbcc4uxc608uxce21-uxbaa8uxd615uxce74uxb4dc}{%
\section{성별예측
모형카드}\label{uxc131uxbcc4uxc608uxce21-uxbaa8uxd615uxce74uxb4dc}}

펭귄 암수성별 예측 모형에 대한 모델 카드를 다음과 같이 작성할 수 있다.
모형 카드는 펭귄 성별 예측 모델의 기본 정보와 성능, 사용 상황 및 제한
사항 등을 포함하고 있고, 필요한 경우 추가적인 정보나 세부 사항을
포함시킬 수 있다.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{model-card-uxd3aduxadc4-uxc131uxbcc4-uxc608uxce21-uxbaa8uxb378}{%
\subsection{Model Card: 펭귄 성별 예측
모델}\label{model-card-uxd3aduxadc4-uxc131uxbcc4-uxc608uxce21-uxbaa8uxb378}}

\begin{itemize}
\tightlist
\item
  \textbf{모델 정보(Model Information)}

  \begin{itemize}
  \tightlist
  \item
    \textbf{모델 이름}: 펭귄 성별 예측 모델
  \item
    \textbf{버전}: 1.0
  \item
    \textbf{사용 사례}: 펭귄의 특성(부리 크기, 날개 길이, 몸무게 등)을
    기반으로 성별을 예측
  \item
    \textbf{모델 아키텍처}: 로지스틱 회귀
  \item
    \textbf{학습 알고리즘}: 로지스틱 회귀 학습 알고리즘
  \item
    \textbf{라이센스 정보}: Open Source
  \end{itemize}
\item
  \textbf{데이터셋 정보(Dataset Information)}

  \begin{itemize}
  \tightlist
  \item
    \textbf{데이터셋 출처}: 제공되지 않음
  \item
    \textbf{특성}: species, island, bill\_length\_mm, bill\_depth\_mm,
    flipper\_length\_mm, body\_mass\_g, year
  \item
    \textbf{대상 변수}: sex (male, female)
  \end{itemize}
\item
  \textbf{모델 성능(Metrics)}

  \begin{itemize}
  \tightlist
  \item
    \textbf{정확도(Accuracy)}: 89.5\%
  \item
    \textbf{여성 펭귄 정밀도(Precision for Female)}: 94\%
  \item
    \textbf{여성 펭귄 재현율(Recall for Female)}: 86\%
  \item
    \textbf{남성 펭귄 정밀도(Precision for Male)}: 85\%
  \item
    \textbf{남성 펭귄 재현율(Recall for Male)}: 94\%
  \end{itemize}
\item
  \textbf{편향 및 공정성 평가(Bias \& Fairness Evaluation)}

  \begin{itemize}
  \tightlist
  \item
    해당 정보가 제공되지 않았으므로, 해당 항목은 생략합니다.
  \end{itemize}
\item
  \textbf{사용 상황 및 제한 사항(Use-case \& Limitations)}

  \begin{itemize}
  \tightlist
  \item
    \textbf{추천되는 사용 사례}: 연구 목적, 펭귄의 성별을 빠르게 예측
  \item
    \textbf{추천되지 않는 사용 사례}: 실제 환경에서의 중요한 의사 결정
  \item
    \textbf{알려진 제한 사항}: 제공된 데이터셋에만 최적화됨
  \end{itemize}
\item
  \textbf{모델 관리 및 업데이트(Model Management)}

  \begin{itemize}
  \tightlist
  \item
    \textbf{업데이트 빈도}: 없음 (첫 버전)
  \item
    \textbf{업데이트 메커니즘}: 모델을 다시 훈련하여 업데이트
  \item
    \textbf{모델의 사용 기간}: 데이터가 변하지 않는 한 계속 사용 가능
  \end{itemize}
\item
  \textbf{추가 정보(Additional Information)}

  \begin{itemize}
  \tightlist
  \item
    \textbf{연구 논문 또는 참조 자료}: https://arxiv.org/abs/1810.03993
  \item
    \textbf{문의처}: admin@r2bit.com
  \item
    \textbf{관련 웹사이트 링크}: https://r2bit.com/
  \end{itemize}
\end{itemize}

\hypertarget{predictive-model}{%
\chapter{예측모형 가치}\label{predictive-model}}

예측모형을 잘 활용하여 사업적 효과를 내는 것은 AUC 값이 높은 성능 좋은
예측모형을 개발하는 것과 다른 문제가 된다. 예측모형개발이 수월해지고
사업에 활용이 많이 지면서 예측모형을 사업쪽에 설명하고 사업쪽의 의견을
반영하는 방법에 대한 연구와 활용이 빈번해지고 있다. 이를 위해서 먼저
예측모형을 의사결정나무 모형과 일반화 선형모형으로 예측모형을 개발하여
포르투갈 은행에서 개발된 상품에 가입을 하는지 예측하는 은행 마케팅
캠페인 데이터다. \footnote{\href{https://archive.ics.uci.edu/ml/datasets/bank+marketing\#}{Bank
  Marketing Data Set, The data is related with direct marketing
  campaigns (phone calls) of a Portuguese banking institution. The
  classification goal is to predict if the client will subscribe a term
  deposit (variable y)}} \footnote{\href{http://api.rpubs.com/jurrr/411810}{Jurriaan
  Nagelkerke and Pieter Marcus (2018-09-20), ``Introducing modelplotr:
  Plots to evaluate the business value of predictive models''}}

\hypertarget{predictive-model-x}{%
\section{데이터 준비}\label{predictive-model-x}}

먼저 UCI 웹사이트에서 데이터를 다운로드 받아 압축을 풀고, 예측모형에
사용될 수 있도록 데이터를 가공한다. 약 11.3\% 고객이 은행상품에 가입한
것이 파악된다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 0. 환경설정 {-}{-}{-}{-}{-}}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(caret)}
\FunctionTok{library}\NormalTok{(modelplotr) }\CommentTok{\# devtools::install\_github("modelplot/modelplotr")}

\CommentTok{\# 1. 데이터 다운로드 {-}{-}{-}{-}{-}}
\FunctionTok{download.file}\NormalTok{(}\AttributeTok{url =} \StringTok{"https://archive.ics.uci.edu/ml/machine{-}learning{-}databases/00222/bank{-}additional.zip"}\NormalTok{, }\AttributeTok{destfile =} \StringTok{"data//bank{-}additional.zip"}\NormalTok{, }\AttributeTok{mode=}\StringTok{\textquotesingle{}wb\textquotesingle{}}\NormalTok{)}

\CommentTok{\# 1.1. 압축풀기 {-}{-}{-}{-}{-}}
\FunctionTok{unzip}\NormalTok{(}\StringTok{"data/bank{-}additional.zip"}\NormalTok{, }\AttributeTok{exdir=}\StringTok{"./data"}\NormalTok{)}

\CommentTok{\# 1.2. 불러오기 {-}{-}{-}{-}{-}}
\NormalTok{bank\_dat }\OtherTok{\textless{}{-}} \FunctionTok{read\_delim}\NormalTok{(}\StringTok{"data/bank{-}additional/bank{-}additional{-}full.csv"}\NormalTok{, }\AttributeTok{delim=}\StringTok{";"}\NormalTok{,}
                      \AttributeTok{col\_types =} \FunctionTok{cols}\NormalTok{(}
                              \AttributeTok{.default =} \FunctionTok{col\_character}\NormalTok{(),}
                              \AttributeTok{age =} \FunctionTok{col\_integer}\NormalTok{(),}
                              \AttributeTok{duration =} \FunctionTok{col\_integer}\NormalTok{(),}
                              \AttributeTok{campaign =} \FunctionTok{col\_integer}\NormalTok{(),}
                              \AttributeTok{pdays =} \FunctionTok{col\_integer}\NormalTok{(),}
                              \AttributeTok{previous =} \FunctionTok{col\_integer}\NormalTok{(),}
                              \AttributeTok{emp.var.rate =} \FunctionTok{col\_double}\NormalTok{(),}
                              \AttributeTok{cons.price.idx =} \FunctionTok{col\_double}\NormalTok{(),}
                              \AttributeTok{cons.conf.idx =} \FunctionTok{col\_double}\NormalTok{(),}
                              \AttributeTok{euribor3m =} \FunctionTok{col\_double}\NormalTok{(),}
                              \AttributeTok{nr.employed =} \FunctionTok{col\_double}\NormalTok{()))}


\NormalTok{bank\_df }\OtherTok{\textless{}{-}}\NormalTok{ bank\_dat }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{select\_}\NormalTok{(}\StringTok{\textquotesingle{}y\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}duration\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}campaign\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pdays\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}previous\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}euribor3m\textquotesingle{}}\NormalTok{)}


\NormalTok{bank\_df }\OtherTok{\textless{}{-}}\NormalTok{ bank\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{y =} \FunctionTok{factor}\NormalTok{(y, }\AttributeTok{levels=}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}no\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}yes\textquotesingle{}}\NormalTok{)))}

\NormalTok{bank\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{count}\NormalTok{(y) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{pcnt =}\NormalTok{ scales}\SpecialCharTok{::}\FunctionTok{percent}\NormalTok{(n }\SpecialCharTok{/}\FunctionTok{sum}\NormalTok{(n)))}
\end{Highlighting}
\end{Shaded}

\hypertarget{predictive-model-caret}{%
\section{예측모형}\label{predictive-model-caret}}

\texttt{caret} 팩키지를 통해서 예측모형을 개발한다.
\texttt{createDataPartition()} 함수로 훈련/시험 데이터를 나누고, CV
방법을 통해서 최적의 모형을 개발하도록 \texttt{doSNOW} 팩키지로
멀티코어를 활용한 병렬처리를 가능하도록 해서 RPART, GLM, RF 모형에 따른
최적 모형을 개발한다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 2. 예측모형 {-}{-}{-}{-}{-}}
\DocumentationTok{\#\# 2.1. 훈련/시험 데이터 분할 {-}{-}{-}{-}{-}{-}}
\FunctionTok{library}\NormalTok{(caret)}

\NormalTok{bank\_index }\OtherTok{\textless{}{-}} \FunctionTok{createDataPartition}\NormalTok{(bank\_df}\SpecialCharTok{$}\NormalTok{y, }\AttributeTok{times =}\DecValTok{1}\NormalTok{, }\AttributeTok{p=}\FloatTok{0.3}\NormalTok{, }\AttributeTok{list=}\ConstantTok{FALSE}\NormalTok{)}

\NormalTok{train\_df }\OtherTok{\textless{}{-}}\NormalTok{ bank\_df[bank\_index, ]}
\NormalTok{test\_df  }\OtherTok{\textless{}{-}}\NormalTok{ bank\_df[}\SpecialCharTok{{-}}\NormalTok{bank\_index, ]}

\DocumentationTok{\#\# 2.2. 모형 개발/검증 데이터셋 준비 {-}{-}{-}{-}{-}{-}}

\NormalTok{cv\_folds }\OtherTok{\textless{}{-}} \FunctionTok{createMultiFolds}\NormalTok{(train\_df}\SpecialCharTok{$}\NormalTok{y, }\AttributeTok{k =} \DecValTok{10}\NormalTok{, }\AttributeTok{times =} \DecValTok{3}\NormalTok{)}

\NormalTok{cv\_cntrl }\OtherTok{\textless{}{-}} \FunctionTok{trainControl}\NormalTok{(}\AttributeTok{method =} \StringTok{"repeatedcv"}\NormalTok{, }\AttributeTok{number =} \DecValTok{10}\NormalTok{,}
                         \AttributeTok{repeats =} \DecValTok{3}\NormalTok{, }\AttributeTok{index =}\NormalTok{ cv\_folds)}


\DocumentationTok{\#\# 2.2. 모형 개발/검증 데이터셋 준비 {-}{-}{-}{-}{-}{-}}

\FunctionTok{library}\NormalTok{(doSNOW)}
\CommentTok{\# 실행시간}
\NormalTok{start.time }\OtherTok{\textless{}{-}} \FunctionTok{Sys.time}\NormalTok{()}

\NormalTok{cl }\OtherTok{\textless{}{-}} \FunctionTok{makeCluster}\NormalTok{(}\DecValTok{4}\NormalTok{, }\AttributeTok{type =} \StringTok{"SOCK"}\NormalTok{)}
\FunctionTok{registerDoSNOW}\NormalTok{(cl)}

\NormalTok{bank\_rpart }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train\_df, }
                    \AttributeTok{method =} \StringTok{"rpart"}\NormalTok{, }
                    \AttributeTok{trControl =}\NormalTok{ cv\_cntrl, }
                    \AttributeTok{tuneLength =} \DecValTok{7}\NormalTok{)}

\NormalTok{bank\_glm   }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train\_df, }
                    \AttributeTok{method =} \StringTok{"glm"}\NormalTok{,}
                    \AttributeTok{family =} \StringTok{"binomial"}\NormalTok{,}
                    \AttributeTok{trControl =}\NormalTok{ cv\_cntrl, }
                    \AttributeTok{tuneLength =} \DecValTok{7}\NormalTok{)}

\NormalTok{bank\_rf    }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train\_df, }
                   \AttributeTok{method =} \StringTok{"rf"}\NormalTok{,}
                   \AttributeTok{trControl =}\NormalTok{ cv\_cntrl, }
                   \AttributeTok{tuneLength =} \DecValTok{7}\NormalTok{,}
                   \AttributeTok{importance =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{stopCluster}\NormalTok{(cl)}

\NormalTok{total.time }\OtherTok{\textless{}{-}} \FunctionTok{Sys.time}\NormalTok{() }\SpecialCharTok{{-}}\NormalTok{ start.time}
\NormalTok{total.time}

\CommentTok{\# bank\_rpart\_m \textless{}{-} bank\_rpart$finalModel}
\CommentTok{\# bank\_glm\_m \textless{}{-} bank\_glm$finalModel}
\end{Highlighting}
\end{Shaded}

\hypertarget{predictive-model-caret-business}{%
\chapter[예측모형 사업활용 ]{\texorpdfstring{예측모형 사업활용
\footnote{\href{http://mlwiki.org/index.php/Cumulative_Gain_Chart}{Cumulative
  Gain Chart}} \footnote{\href{http://dni-institute.in/blogs/model-validation-using-r-german-credit-data/}{DnI
  institute, ``Model Validation using R- German Credit Data''}}
\footnote{\href{https://www.listendata.com/2014/08/excel-template-gain-and-lift-charts.html}{LISTEN
  DATA, ``UNDERSTAND GAIN AND LIFT CHARTS''}}}{예측모형 사업활용   }}\label{predictive-model-caret-business}}

예측모형을 사업에 활용하기 위해서 AUC, 민감도, 특이도와 같은 예측모형
성능파악 지표 대신에 다음과 같은 그래프와 측도를 많이 사용한다.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{누적 이득 그래프(Cumulative gains plot)}: 예측모형을 적용해서
  십분위 X까지 선택하게 되면, 실제 목표 라벨을 실제 몇 \%까지 기대할 수
  있는지에 대한 답을 제공한다.
\item
  \textbf{누적 향상도 그래프(Cumulative Lift Chart)}: 예측모형을
  적용해서 십분위수 X까지 누적 선택하게 되면, 예측모형을 전혀 사용하지
  않을 때 대비하여 몇배나 더 효과가 있는지에 대한 대답을 제공한다.
\item
  \textbf{반응 그래프(Response Plot)}: 예측모형을 적합시켜서 십분위수
  X를 선택하게 되면, 해당 십분위수에서 기대되는 예상 반응율을 몇 \%가
  되는지에 대한 답을 제공한다.
\item
  \textbf{누적 반응 그래프(Cumulative Response Plot)}: 예측모형을
  적합시켜서 해당 십분위수 X까지 누적하여 선택하게 되면, 해당
  십분위수에서 기대되는 예상 반응율을 몇 \%가 되는지에 대한 답을
  제공한다.
\end{enumerate}

\hypertarget{predictive-model-caret-business-dataset}{%
\section{이득과 향상도
데이터}\label{predictive-model-caret-business-dataset}}

이득(gain), 향상도(lift) 계산을 위해서 먼저 예측모형에서 데이터를
준비한다. 필요한 데이터는 예측값(확률/스코어 점수)과 라벨이 된다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bank\_rpart\_pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(bank\_rpart, }\AttributeTok{newdata=}\NormalTok{test\_df, }\AttributeTok{type=}\StringTok{"prob"}\NormalTok{)[,}\DecValTok{2}\NormalTok{] }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ tbl\_df}
\NormalTok{bank\_glm\_pred   }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(bank\_glm, }\AttributeTok{newdata=}\NormalTok{test\_df, }\AttributeTok{type=}\StringTok{"prob"}\NormalTok{)[,}\DecValTok{2}\NormalTok{] }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ tbl\_df}
\NormalTok{bank\_rf\_pred    }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(bank\_rf, }\AttributeTok{newdata=}\NormalTok{test\_df, }\AttributeTok{type=}\StringTok{"prob"}\NormalTok{)[,}\DecValTok{2}\NormalTok{] }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ tbl\_df}

\NormalTok{bank\_pred\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(bank\_glm\_pred, bank\_rpart\_pred, bank\_rf\_pred, test\_df}\SpecialCharTok{$}\NormalTok{y) }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ tbl\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{rename}\NormalTok{(}\AttributeTok{prob\_glm =}\NormalTok{value,}
           \AttributeTok{prob\_rpart =} \StringTok{\textasciigrave{}}\AttributeTok{value.1}\StringTok{\textasciigrave{}}\NormalTok{, }
           \AttributeTok{prob\_rf =} \StringTok{\textasciigrave{}}\AttributeTok{value.2}\StringTok{\textasciigrave{}}\NormalTok{, }
           \AttributeTok{y =} \StringTok{\textasciigrave{}}\AttributeTok{test\_df.y}\StringTok{\textasciigrave{}}\NormalTok{)}

\NormalTok{bank\_pred\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{sample\_n}\NormalTok{(}\DecValTok{100}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{    DT}\SpecialCharTok{::}\FunctionTok{datatable}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{predictive-model-caret-business-dataset-compute}{%
\section{이득과 향상도
계산}\label{predictive-model-caret-business-dataset-compute}}

예측모형에서 이득과 향상도 계산을 위한 데이터가 준비되었다면 다음 단계로
이득(gain), 향상도(lift)를 계산하여 데이터프레임으로 준비한다.

\hypertarget{predictive-model-caret-business-dataset-compute-caret}{%
\subsection{\texorpdfstring{\texttt{caret} 팩키지 - \texttt{lift()}
함수}{caret 팩키지 - lift() 함수}}\label{predictive-model-caret-business-dataset-compute-caret}}

\texttt{caret} 팩키지 \texttt{lift()} 함수를 통해 이득과 향상도를 계산할
수 있으나 총 표본 대비 비율로 나눠져서 사용시 주의가 요망된다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lift\_df }\OtherTok{\textless{}{-}}\NormalTok{ caret}\SpecialCharTok{::}\FunctionTok{lift}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ prob\_glm }\SpecialCharTok{+}\NormalTok{ prob\_rf }\SpecialCharTok{+}\NormalTok{ prob\_rpart, }\AttributeTok{data=}\NormalTok{bank\_pred\_df, }\AttributeTok{cuts=}\DecValTok{11}\NormalTok{, }\AttributeTok{class=}\StringTok{"yes"}\NormalTok{)}

\NormalTok{lift\_df}\SpecialCharTok{$}\NormalTok{data }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{filter}\NormalTok{(liftModelVar }\SpecialCharTok{==} \StringTok{\textquotesingle{}prob\_rf\textquotesingle{}}\NormalTok{)  }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{    DT}\SpecialCharTok{::}\FunctionTok{datatable}\NormalTok{()}

\CommentTok{\# ggplot(lift\_df, value=10)}
\end{Highlighting}
\end{Shaded}

\hypertarget{predictive-model-caret-business-dataset-compute-gains}{%
\subsection{\texorpdfstring{\texttt{gains} 팩키지 - \texttt{gains()}
함수}{gains 팩키지 - gains() 함수}}\label{predictive-model-caret-business-dataset-compute-gains}}

\texttt{gains} 팩키지 \texttt{gains()} 함수를 통해 이득과 향상도를
계산할 수 있으나, 그 다음 후속 작업을 위해서 데이터프레임 변환작업을
수행하면 되는데 기본적으로 향상도와 이득에 대한 중요정보를 십분위수에
맞춰 모두 계산되어 있어 이를 참조값으로 사용한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gains)}

\NormalTok{gains\_tbl }\OtherTok{\textless{}{-}} \FunctionTok{gains}\NormalTok{(}\AttributeTok{actual    =} \FunctionTok{as.integer}\NormalTok{(bank\_pred\_df}\SpecialCharTok{$}\NormalTok{y)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}
                   \AttributeTok{predicted =}\NormalTok{ bank\_pred\_df}\SpecialCharTok{$}\NormalTok{prob\_glm, }
                   \AttributeTok{groups=}\DecValTok{10}\NormalTok{)}

\NormalTok{gains\_df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{x =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{depth,}
    \AttributeTok{obs =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{obs,}
    \AttributeTok{cume.obs =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{cume.obs,}
    \AttributeTok{mean.resp =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{mean.resp, }
    \AttributeTok{cume.mean.resp =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{cume.mean.resp,}
    \AttributeTok{cume.pct.of.total =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{cume.pct.of.total,}
    \AttributeTok{lift =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{lift, }
    \AttributeTok{cume.lift =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{cume.lift,}
    \AttributeTok{mean.prediction =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{mean.prediction,}
    \AttributeTok{min.prediction =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{mean.prediction, }
    \AttributeTok{max.prediction =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{max.prediction, }
    \AttributeTok{conf =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{conf, }
    \AttributeTok{optimal =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{optimal, }
    \AttributeTok{num.groups =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{num.groups,}
    \AttributeTok{percents =}\NormalTok{ gains\_tbl}\SpecialCharTok{$}\NormalTok{percents}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{add\_row}\NormalTok{(}\AttributeTok{x=}\DecValTok{0}\NormalTok{, }\AttributeTok{obs=}\DecValTok{0}\NormalTok{, }\AttributeTok{cume.obs=}\DecValTok{0}\NormalTok{, }\AttributeTok{mean.resp=}\DecValTok{0}\NormalTok{, }\AttributeTok{cume.mean.resp=}\DecValTok{0}\NormalTok{, }\AttributeTok{cume.pct.of.total=}\DecValTok{0}\NormalTok{, }\AttributeTok{lift=}\DecValTok{0}\NormalTok{,}
            \AttributeTok{cume.lift=}\DecValTok{0}\NormalTok{, }\AttributeTok{mean.prediction=}\DecValTok{0}\NormalTok{, }\AttributeTok{min.prediction=}\DecValTok{0}\NormalTok{, }\AttributeTok{max.prediction=}\DecValTok{0}\NormalTok{, }\AttributeTok{conf=}\StringTok{"none"}\NormalTok{,}
            \AttributeTok{optimal =} \StringTok{"false"}\NormalTok{,}\AttributeTok{num.groups=}\DecValTok{10}\NormalTok{, }\AttributeTok{percents=}\StringTok{"false"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{arrange}\NormalTok{(x)}

\NormalTok{DT}\SpecialCharTok{::}\FunctionTok{datatable}\NormalTok{(gains\_df)}

\CommentTok{\# gains\_df \%\textgreater{}\% }
\CommentTok{\#     ggplot(aes(x=x, y=cume.pct.of.total)) +}
\CommentTok{\#       geom\_line() +}
\CommentTok{\#       geom\_point() +}
\CommentTok{\#       scale\_y\_continuous(limits=c(0,1)) +}
\CommentTok{\#       geom\_abline(slope=1, intercept = 0)}
\end{Highlighting}
\end{Shaded}

\hypertarget{predictive-model-caret-business-dataset-compute-custom}{%
\subsection{사용자 정의
함수}\label{predictive-model-caret-business-dataset-compute-custom}}

\href{https://www.listendata.com/2014/08/excel-template-gain-and-lift-charts.html}{LISTEN
DATA, ``UNDERSTAND GAIN AND LIFT CHARTS''}를 참조해서 직접 사용자 정의
함수를 작성해도 가능하다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{custom\_lift }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(label\_var, prob\_var, }\AttributeTok{groups=}\DecValTok{10}\NormalTok{) \{}
    
\NormalTok{    tmp\_df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(label\_var, prob\_var))}
    
\NormalTok{    tmp\_df }\OtherTok{\textless{}{-}}\NormalTok{ tmp\_df }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{mutate}\NormalTok{(}\AttributeTok{decile =} \FunctionTok{ntile}\NormalTok{(}\FunctionTok{desc}\NormalTok{(prob\_var), groups))}

\NormalTok{    gain\_table }\OtherTok{\textless{}{-}}\NormalTok{ tmp\_df }\SpecialCharTok{\%\textgreater{}\%} 
        \FunctionTok{group\_by}\NormalTok{(decile) }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{summarise\_at}\NormalTok{(}\FunctionTok{vars}\NormalTok{(label\_var), }\FunctionTok{funs}\NormalTok{(}\AttributeTok{total =} \FunctionTok{n}\NormalTok{(),}
                                           \AttributeTok{total\_resp =} \FunctionTok{sum}\NormalTok{(., }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}
        \FunctionTok{mutate}\NormalTok{(}\AttributeTok{cum\_resp =} \FunctionTok{cumsum}\NormalTok{(total\_resp),}
               \AttributeTok{gain     =}\NormalTok{ cum\_resp }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(total\_resp) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{,}
               \AttributeTok{cum\_lift =}\NormalTok{ gain }\SpecialCharTok{/}\NormalTok{ (decile}\SpecialCharTok{*}\NormalTok{(}\DecValTok{100}\SpecialCharTok{/}\NormalTok{groups)))}
    \FunctionTok{return}\NormalTok{(gain\_table)}
\NormalTok{\}}

\NormalTok{custom\_lift\_df }\OtherTok{\textless{}{-}} \FunctionTok{custom\_lift}\NormalTok{(}\FunctionTok{as.integer}\NormalTok{(bank\_pred\_df}\SpecialCharTok{$}\NormalTok{y)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, bank\_pred\_df}\SpecialCharTok{$}\NormalTok{prob\_glm, }\DecValTok{10}\NormalTok{)}

\NormalTok{DT}\SpecialCharTok{::}\FunctionTok{datatable}\NormalTok{(custom\_lift\_df)}
\end{Highlighting}
\end{Shaded}

\hypertarget{predictive-model-caret-business-cumulative-gains}{%
\section{누적 이득
그래프}\label{predictive-model-caret-business-cumulative-gains}}

\textbf{누적 이득 그래프(Cumulative gains plot)}는 예측모형을 적용해서
십분위 X 까지 선택하게 되면, 실제 목표 라벨을 실제 몇 \% 까지
예측/기대할 수 있는지에 대한 답을 제공한다.

RF가 최종 예측모형으로 선정되었다면 이를 활용하여 ``누적 이득 그래프''로
시각화해보고 예측모형의 사업성과를 추정해보자.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(extrafont)}
\FunctionTok{loadfonts}\NormalTok{()}

\NormalTok{(gains\_glm\_tbl }\OtherTok{\textless{}{-}} \FunctionTok{gains}\NormalTok{(}\AttributeTok{actual    =} \FunctionTok{as.integer}\NormalTok{(bank\_pred\_df}\SpecialCharTok{$}\NormalTok{y)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}
                       \AttributeTok{predicted =}\NormalTok{ bank\_pred\_df}\SpecialCharTok{$}\NormalTok{prob\_glm, }
                       \AttributeTok{groups=}\DecValTok{10}\NormalTok{))}

\NormalTok{gains\_glm\_df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{x =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{depth,}
    \AttributeTok{obs =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{obs,}
    \AttributeTok{cume.obs =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{cume.obs,}
    \AttributeTok{mean.resp =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{mean.resp, }
    \AttributeTok{cume.mean.resp =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{cume.mean.resp,}
    \AttributeTok{cume.pct.of.total =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{cume.pct.of.total,}
    \AttributeTok{lift =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{lift, }
    \AttributeTok{cume.lift =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{cume.lift,}
    \AttributeTok{mean.prediction =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{mean.prediction,}
    \AttributeTok{min.prediction =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{mean.prediction, }
    \AttributeTok{max.prediction =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{max.prediction, }
    \AttributeTok{conf =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{conf, }
    \AttributeTok{optimal =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{optimal, }
    \AttributeTok{num.groups =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{num.groups,}
    \AttributeTok{percents =}\NormalTok{ gains\_glm\_tbl}\SpecialCharTok{$}\NormalTok{percents}
\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{add\_row}\NormalTok{(}\AttributeTok{x=}\DecValTok{0}\NormalTok{, }\AttributeTok{obs=}\DecValTok{0}\NormalTok{, }\AttributeTok{cume.obs=}\DecValTok{0}\NormalTok{, }\AttributeTok{mean.resp=}\DecValTok{0}\NormalTok{, }\AttributeTok{cume.mean.resp=}\DecValTok{0}\NormalTok{, }\AttributeTok{cume.pct.of.total=}\DecValTok{0}\NormalTok{, }\AttributeTok{lift=}\DecValTok{0}\NormalTok{,}
            \AttributeTok{cume.lift=}\DecValTok{0}\NormalTok{, }\AttributeTok{mean.prediction=}\DecValTok{0}\NormalTok{, }\AttributeTok{min.prediction=}\DecValTok{0}\NormalTok{, }\AttributeTok{max.prediction=}\DecValTok{0}\NormalTok{, }\AttributeTok{conf=}\StringTok{"none"}\NormalTok{,}
            \AttributeTok{optimal =} \StringTok{"false"}\NormalTok{,}\AttributeTok{num.groups=}\DecValTok{10}\NormalTok{, }\AttributeTok{percents=}\StringTok{"false"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{arrange}\NormalTok{(x) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{decile =}\NormalTok{ x }\SpecialCharTok{/} \DecValTok{10} \SpecialCharTok{\%\textgreater{}\%}\NormalTok{ as.integer)}



\NormalTok{gains\_glm\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{decile, }\AttributeTok{y=}\NormalTok{cume.pct.of.total)) }\SpecialCharTok{+}
      \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size=}\FloatTok{1.3}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{slope=}\FloatTok{0.1}\NormalTok{, }\AttributeTok{intercept =} \DecValTok{0}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
      \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{percent) }\SpecialCharTok{+}
      \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
      \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"십분위"}\NormalTok{, }\AttributeTok{y=}\StringTok{"누적 이득(Cumulative Gains)"}\NormalTok{, }\AttributeTok{title=}\StringTok{"포르투칼 마케팅 캠페인 누적 이득 그래프"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{images/model_value_gain.png}

}

\caption{포르투칼 마케팅 캠페인 누적 이득 그래프}

\end{figure}

\hypertarget{predictive-model-caret-business-lift}{%
\section{향상 리프트(Lift)
그래프}\label{predictive-model-caret-business-lift}}

\textbf{누적 향상(리프트) 그래프(Cumulative lift plot)}는 예측모형을
적용해서 십분위수 X까지 선택하게 되면, 예측모형을 전혀 사용하지 않을 때
대비하여 몇배나 더 효과가 있는지에 대한 대답을 제공한다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gains\_glm\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{!=}\DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{decile, }\AttributeTok{y=}\NormalTok{cume.lift}\SpecialCharTok{/}\DecValTok{100}\NormalTok{)) }\SpecialCharTok{+}
      \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size=}\FloatTok{1.3}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\DecValTok{1}\NormalTok{, }\AttributeTok{size=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{color=}\StringTok{"darkgray"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
      \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{,}\DecValTok{6}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
      \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_family =} \StringTok{"NanumGothic"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"십분위"}\NormalTok{, }\AttributeTok{y=}\StringTok{"누적 향상도(Cumulative Lift)"}\NormalTok{, }\AttributeTok{title=}\StringTok{"포르투칼 마케팅 캠페인 누적 향상도 그래프"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{images/model_value_lift.png}

}

\caption{포르투칼 마케팅 캠페인 누적 향상도 그래프}

\end{figure}

\hypertarget{predictive-model-caret-business-response-plot}{%
\section{반응 그래프(Reponse
Plot)}\label{predictive-model-caret-business-response-plot}}

\textbf{반응 그래프(Response Plot)}는 예측모형을 적합시켜서 십분위수 X를
선택하게 되면, 해당 십분위수에서 기대되는 예상 반응율을 몇 \%가 되는지에
대한 답을 제공한다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg\_response\_pcnt }\OtherTok{\textless{}{-}}\NormalTok{ gains\_glm\_df}\SpecialCharTok{$}\NormalTok{cume.mean.resp[}\DecValTok{11}\NormalTok{]}

\NormalTok{gains\_glm\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{!=}\DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{decile, }\AttributeTok{y=}\NormalTok{mean.resp)) }\SpecialCharTok{+}
      \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size=}\FloatTok{1.3}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\NormalTok{avg\_response\_pcnt, }\AttributeTok{size=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{color=}\StringTok{"darkgray"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
      \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.6}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.6}\NormalTok{,}\FloatTok{0.1}\NormalTok{), }\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{percent) }\SpecialCharTok{+}
      \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_family =} \StringTok{"NanumGothic"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"십분위"}\NormalTok{, }\AttributeTok{y=}\StringTok{"평균 반응율(\%)"}\NormalTok{, }\AttributeTok{title=}\StringTok{"포르투칼 마케팅 캠페인 반응율 그래프"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{images/model_value_response.png}

}

\caption{포르투칼 마케팅 캠페인 반응율 그래프}

\end{figure}

\hypertarget{predictive-model-caret-business-cumulative-response-plot}{%
\section{누적 반응 그래프(Cumulative Reponse
Plot)}\label{predictive-model-caret-business-cumulative-response-plot}}

\textbf{누적 반응 그래프(Cumulative Response Plot)}는 예측모형을
적합시켜서 해당 십분위수 X까지 누적하여 선택하게 되면, 해당 십분위수에서
기대되는 예상 반응율을 몇 \%가 되는지에 대한 답을 제공한다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gains\_glm\_df }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{!=}\DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{decile, }\AttributeTok{y=}\NormalTok{cume.mean.resp)) }\SpecialCharTok{+}
      \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{size=}\FloatTok{1.3}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{geom\_hline}\NormalTok{(}\AttributeTok{yintercept=}\NormalTok{avg\_response\_pcnt, }\AttributeTok{size=}\FloatTok{1.3}\NormalTok{, }\AttributeTok{color=}\StringTok{"darkgray"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{10}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{10}\NormalTok{,}\DecValTok{1}\NormalTok{)) }\SpecialCharTok{+}
      \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.6}\NormalTok{), }\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{,}\FloatTok{0.6}\NormalTok{,}\FloatTok{0.1}\NormalTok{), }\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{percent) }\SpecialCharTok{+}
      \FunctionTok{theme\_minimal}\NormalTok{(}\AttributeTok{base\_family =} \StringTok{"NanumGothic"}\NormalTok{) }\SpecialCharTok{+}
      \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"십분위"}\NormalTok{, }\AttributeTok{y=}\StringTok{"누적 평균 반응율(\%)"}\NormalTok{, }\AttributeTok{title=}\StringTok{"포르투칼 마케팅 캠페인 누적 반응율 그래프"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{images/model_value_cumulative.png}

}

\caption{포르투칼 마케팅 캠페인 누적 반응율 그래프}

\end{figure}

\part{사례연구}

\hypertarget{uxb098uxc774uxd305uxac8cuxc77c}{%
\chapter{나이팅게일}\label{uxb098uxc774uxd305uxac8cuxc77c}}

\hypertarget{uxbc30uxacbd}{%
\section{배경}\label{uxbc30uxacbd}}

크림 전쟁은 1853년부터 1856년까지 일어난 큰 전쟁이었다. 한쪽에는 러시아,
반면 다른 한쪽에는 영국, 프랑스, 오스만 제국 (현대 투르키에), 그리고
나중에 사르디니아 (현대 이탈리아의 일부)가 동맹을 구성하여 전쟁을
치뤘다. 전쟁이 바로 시작된 이유는 러시아가 오스만 제국 내 정교회
신자들을 보호하려 하려는 명분을 내세웠지만, 사실 더많은 영토를 차지하기
위함이였다. 양측간 전쟁은 흑해를 두고 남하하는 러시아에 맞서 동맹군이
크림반도에서 발생하여 ``크림전쟁''(Crimean War)으로 불린다. 영화로
소개된 경기병대의 돌격 (``Charge of the Light Brigade''), 영국 간호사
플로렌스 나이팅게일의 활약, 전신과 철도의 본격적인 도입으로 큰 의미를
갖는 전쟁이기도 하다. 많은 전투와 많은 사람들이 죽은 후, 1856년 파리
조약으로 전쟁은 마무리되어, 러시아 확장은 잠시 멈추게 돼었고, 오스만
제국도 한숨 돌린 계기가 되었다.

크림 전쟁 중 스쿠타리 막사는 투루키에 스쿠타리 병원(Scutari Hospital,
Turkey)은 영국 군 병원으로 개조되었다. 크림전쟁에서 부상을 당한 수많은
병사가 치료를 위해 이곳으로 보내졌지만, 병자와 부상병들을 감당할 수
있도록 설계되지 않았고 제대로된 역할도 수행하지 못했다. 1854년
나이팅게일이 간호사 일행과 함께 도착했을 때, 비위생적인 환경과 고통받는
병사들을 보고 경악했다. 나이팅게일의 스쿠타리 병원에서 경험은 병원과
의료 서비스를 개선하여 이와 같은 고통과 비극이 재발하지 않도록 향후
프로젝트의 중요한 동기와 방향이 되었다.

\begin{figure}

{\centering \includegraphics{images/scutari.jpg}

}

\caption{스쿠타리 병원의 한 병동 석판화 그림 (William Simpson)}

\end{figure}

환자의 사망율을 42\%에서 2\%로 낮추고 집중치료실(ICU)을 설치하여 상태가
중한 환자를 격리하여 집중관리하는 등 근대적인 간호체계를 수립하는 데
기여하였다.

\hypertarget{uxc6d0uxbcf8-uxb370uxc774uxd130}{%
\section{원본 데이터}\label{uxc6d0uxbcf8-uxb370uxc774uxd130}}

크림 전쟁 중 스쿠타리 막사는 투루키에 스쿠타리 병원에서 몇년간에 걸쳐
수작업으로 종이에 분석가능한 형태의 자료를 만들어내는 것은 결코 쉬운
작업이 아니다.

\begin{figure}

{\centering \includegraphics{images/nightingale_raw_data.png}

}

\caption{원본 데이터}

\end{figure}

\hypertarget{uxadf8uxb798uxd504-uxc9c4uxd654}{%
\section{그래프 진화}\label{uxadf8uxb798uxd504-uxc9c4uxd654}}

{\marginnote{\begin{footnotesize}출처:
\href{https://www.scientificamerican.com/article/how-florence-nightingale-changed-data-visualization-forever/}{How
Florence Nightingale Changed Data Visualization Forever - The celebrated
nurse improved public health through her groundbreaking use of graphic
storytelling}\end{footnotesize}}}

복잡한 논거를 제시하는 대신 구체적인 주장에 데이터 시각화와 데이터
스토리텔링(Storytelling)을 통해 청중에 한걸음 더 다가섰다. 나이팅게일의
스토리텔링은 열악한 위생 상태와 과밀로 인해 불필요한 죽음이 얼마나 많이
발생하는지 이해하기 쉬운 비교를 통해 이야기를 구성해서 설득해 나갔다.
예를 들어, 군대 사망률을 민간인 사망률(유사한 환경의 맨체스터)과
비교하는 프레임을 제시하고, 군대 막사에서 생활하는 평시 병사들이 비슷한
연령대 민간인 남성보다 더 높은 비율로 사망하는 것을 제시했다. 이를 통해,
데이터가 보여주는 현실을 부정할 수 없게 만들었고, 군대 행정에 극적인
개혁을 이끌어냈다.

\begin{figure}

\begin{minipage}[t]{0.20\linewidth}

{\centering 

\raisebox{-\height}{

\includegraphics{images/nightingale_graph_01.png}

}

}

\subcaption{\label{fig-barchart}막대그래프}
\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\raisebox{-\height}{

\includegraphics{images/nightingale_graph_02.png}

}

}

\subcaption{\label{fig-circular}맨체스터 사망}
\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\raisebox{-\height}{

\includegraphics{images/nightingale_graph_03.png}

}

}

\subcaption{\label{fig-circular}빅토리아 여왕 보고(I)}
\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\raisebox{-\height}{

\includegraphics{images/nightingale_graph_04.png}

}

}

\subcaption{\label{fig-circular}빅토리아 여왕 보고(II)}
\end{minipage}%
%
\begin{minipage}[t]{0.20\linewidth}

{\centering 

\raisebox{-\height}{

\includegraphics{images/nightingale_graph_05.png}

}

}

\subcaption{\label{fig-circular}빅토리아 여왕 보고(III)}
\end{minipage}%

\caption{\label{fig-nightingale}나이팅게일 그래프 진화과정}

\end{figure}

\hypertarget{uxc124uxb4dd}{%
\section{설득}\label{uxc124uxb4dd}}

나이팅게일은 크림 전쟁 중 병원에서의 위생 문제와 관련된 데이터를
수집하고 분석하여 그 결과를 시각화했고, 병원에서의 사망 원인 중 대부분이
감염성 질병으로 인한 것을 발견했다. 이러한 감염성 질병은 부적절한 위생
조건과 밀접한 관련이 있음을 확인했다.

나이팅게일은 병원의 위생 상태를 개선을 통해 수많은 생명을 구할 수 있다는
사실을 확인했고 연구결과와 권장 사항을 다양한 영국 정부부처에 제출했고,
특히 1858년에 영국의 장관들에게 보고서를 제출했다. 이를 통해서 군 병원의
위생 조건을 개선하는 데 큰 영향을 미쳤다.

\begin{figure}

{\centering \includegraphics{images/nightingale_victoria.jpg}

}

\caption{나이팅게일과 빅토리아 여왕}

\end{figure}

\hypertarget{uxc131uxacfcuxc640-uxc601uxd5a5}{%
\section{성과와 영향}\label{uxc131uxacfcuxc640-uxc601uxd5a5}}

나이팅게일 캠페인이 민간 공중보건에 미친 가장 큰 영향은 실현되기까지
오랜 기간에 걸쳐 다각도로 검토되었고, 마침내 1875년 영국
공중보건법(British Public Health Act)에 법제화되었다. 이 법에는 잘
정비된 하수도, 깨끗한 수돗물, 건축법 규제 등의 요건이 담겨있다. 질병에
대한 면역력을 강화하는 백신과 농작물 수확량을 획기적으로 늘리는 인공비료
개발과 함께 이 제도적인 노력으로 평균 수명을 두 배로 늘리는 원동력이
되었다.

\hypertarget{uxc791uxc5c5uxacfcuxc815}{%
\section{작업과정}\label{uxc791uxc5c5uxacfcuxc815}}

\hypertarget{uxb514uxc9c0uxd138-uxb370uxc774uxd130}{%
\subsection{디지털 데이터}\label{uxb514uxc9c0uxd138-uxb370uxc774uxd130}}

\href{https://github.com/rladies/spain_nightingale}{rladies/spain\_nightingale}
GitHub 저장소에서 엑셀 형태로 된 데이터를 가져와서 전처리할 수 있다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(readxl)}

\NormalTok{death\_raw }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/datos\_florence.xlsx"}\NormalTok{, }\AttributeTok{sheet =} \StringTok{"Sheet1"}\NormalTok{, }\AttributeTok{skip =} \DecValTok{1}\NormalTok{)}

\NormalTok{death\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ death\_raw }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{set\_names}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Month"}\NormalTok{, }\StringTok{"Army"}\NormalTok{, }\StringTok{"Disease"}\NormalTok{, }\StringTok{"Wounds"}\NormalTok{, }\StringTok{"Other"}\NormalTok{, }\StringTok{"Disease.rate"}\NormalTok{, }\StringTok{"Wounds.rate"}\NormalTok{, }\StringTok{"Other.rate"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Date =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{my}\NormalTok{(Month)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate}\NormalTok{(Month, }\AttributeTok{into =} \FunctionTok{c}\NormalTok{(}\StringTok{"Month"}\NormalTok{, }\StringTok{"Year"}\NormalTok{), }\AttributeTok{sep =} \StringTok{" |\_"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(Date, Month, Year, }\FunctionTok{everything}\NormalTok{()) }

\NormalTok{death\_tbl}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 24 x 10
   Date       Month Year   Army Disease Wounds Other Disease.rate Wounds.rate
   <date>     <chr> <chr> <dbl>   <dbl>  <dbl> <dbl>        <dbl>       <dbl>
 1 1854-04-01 Apr   1854   8571       1      0     5          1.4         0  
 2 1854-05-01 May   1854  23333      12      0     9          6.2         0  
 3 1854-06-01 Jun   1854  28333      11      0     6          4.7         0  
 4 1854-07-01 Jul   1854  28722     359      0    23        150           0  
 5 1854-08-01 Aug   1854  30246     828      1    30        328.          0.4
 6 1854-09-01 Sep   1854  30290     788     81    70        312.         32.1
 7 1854-10-01 Oct   1854  30643     503    132   128        197          51.7
 8 1854-11-01 Nov   1854  29736     844    287   106        341.        116. 
 9 1854-12-01 Dec   1854  32779    1725    114   131        632.         41.7
10 1855-01-01 Jan   1855  32393    2761     83   324       1023.         30.7
# i 14 more rows
# i 1 more variable: Other.rate <dbl>
\end{verbatim}

\texttt{HistDate} 패키지에 동일한 데이터셋이 잘 정제되어 있어 이를 바로
활용해도 좋다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(HistData)}

\NormalTok{HistData}\SpecialCharTok{::}\NormalTok{Nightingale }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{as\_tibble}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 24 x 10
   Date       Month  Year  Army Disease Wounds Other Disease.rate Wounds.rate
   <date>     <ord> <int> <int>   <int>  <int> <int>        <dbl>       <dbl>
 1 1854-04-01 Apr    1854  8571       1      0     5          1.4         0  
 2 1854-05-01 May    1854 23333      12      0     9          6.2         0  
 3 1854-06-01 Jun    1854 28333      11      0     6          4.7         0  
 4 1854-07-01 Jul    1854 28722     359      0    23        150           0  
 5 1854-08-01 Aug    1854 30246     828      1    30        328.          0.4
 6 1854-09-01 Sep    1854 30290     788     81    70        312.         32.1
 7 1854-10-01 Oct    1854 30643     503    132   128        197          51.7
 8 1854-11-01 Nov    1854 29736     844    287   106        341.        116. 
 9 1854-12-01 Dec    1854 32779    1725    114   131        632.         41.7
10 1855-01-01 Jan    1855 32393    2761     83   324       1023.         30.7
# i 14 more rows
# i 1 more variable: Other.rate <dbl>
\end{verbatim}

\hypertarget{uxb370uxc774uxd130uxc640-uxc0acuxd22c}{%
\subsection{데이터와 사투}\label{uxb370uxc774uxd130uxc640-uxc0acuxd22c}}

앞서 준비한 \texttt{death\_tbl} 데이터프레임에서 사망 관련 데이터를
처리하고 시각화하기 위한 전처리를 수행하여 시각화를 위한 준비작업을
수행한다. 먼저 \texttt{Date}, \texttt{Disease.rate},
\texttt{Wounds.rate}, \texttt{Other.rate} 칼럼을 선택하고,
\texttt{pivot\_longer} 함수를 사용해 시각화에 적합한 데이터로
재구조화한다. \texttt{str\_replace\_all} 함수를 사용하여 칼럼 이름에서
``.rate''를 제거하고, \texttt{ifelse} 함수를 이용해 날짜를 기준으로
나이팅게일 팀이 준비한 방식을 적용하기 전과후 ``이전''과 ``이후''로
체제로 구분한다. \texttt{factor} 함수를 사용하여 범주 순서를 정의하고,
마지막으로 \texttt{month} 함수를 이용해 날짜에서 해당 월을 추출하고
\texttt{death\_viz}에 저장한다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{death\_viz }\OtherTok{\textless{}{-}}\NormalTok{ death\_tbl }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Date, Disease.rate, Wounds.rate, Other.rate) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Date, }\AttributeTok{names\_to =} \StringTok{"사망원인"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"사망자수"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(사망원인 }\OtherTok{=} \FunctionTok{str\_replace\_all}\NormalTok{(사망원인, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.rate"}\NormalTok{, }\StringTok{""}\NormalTok{), }
\NormalTok{         체제 }\OtherTok{=} \FunctionTok{ifelse}\NormalTok{(Date }\SpecialCharTok{\textless{}=} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}03{-}01"}\NormalTok{), }\StringTok{"조치이전"}\NormalTok{, }\StringTok{"조치이후"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(체제 }\OtherTok{=} \FunctionTok{factor}\NormalTok{(체제, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"조치이전"}\NormalTok{, }\StringTok{"조치이후"}\NormalTok{))) }\SpecialCharTok{\%\textgreater{}\%}  
  \FunctionTok{mutate}\NormalTok{(해당월 }\OtherTok{=} \FunctionTok{month}\NormalTok{(Date, }\AttributeTok{label =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{abbr =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(사망원인 }\OtherTok{=} \FunctionTok{case\_when}\NormalTok{(사망원인 }\SpecialCharTok{==} \StringTok{"Disease"} \SpecialCharTok{\textasciitilde{}} \StringTok{"질병"}\NormalTok{,}
\NormalTok{                              사망원인 }\SpecialCharTok{==} \StringTok{"Wounds"} \SpecialCharTok{\textasciitilde{}} \StringTok{"부상"}\NormalTok{,}
\NormalTok{                              사망원인 }\SpecialCharTok{==} \StringTok{"Other"} \SpecialCharTok{\textasciitilde{}} \StringTok{"기타"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(사망원인 }\OtherTok{=} \FunctionTok{factor}\NormalTok{(사망원인, }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"질병"}\NormalTok{, }\StringTok{"부상"}\NormalTok{, }\StringTok{"기타"}\NormalTok{)))}

\NormalTok{death\_viz}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 72 x 5
   Date       사망원인 사망자수 체제     해당월
   <date>     <fct>       <dbl> <fct>    <ord> 
 1 1854-04-01 질병          1.4 조치이전 4     
 2 1854-04-01 부상          0   조치이전 4     
 3 1854-04-01 기타          7   조치이전 4     
 4 1854-05-01 질병          6.2 조치이전 5     
 5 1854-05-01 부상          0   조치이전 5     
 6 1854-05-01 기타          4.6 조치이전 5     
 7 1854-06-01 질병          4.7 조치이전 6     
 8 1854-06-01 부상          0   조치이전 6     
 9 1854-06-01 기타          2.5 조치이전 6     
10 1854-07-01 질병        150   조치이전 7     
# i 62 more rows
\end{verbatim}

\hypertarget{uxc2dcuxac01uxd654}{%
\section{시각화}\label{uxc2dcuxac01uxd654}}

`ggplot2' 패키지를 이용하여 크림전쟁 나이팅게일 활약상을 담은 데이터를
시각화한다. 나이팅게일 활약 전과 후로 데이터(\texttt{death\_viz})를 나눠
``크림전쟁 병사 사망원인''에 대한 극좌표계 시각화를 통해 이해하기 쉬운
설득력있는 시각화 결과물을 제시하고 있다. 추가적으로, `showtext'
패키지로 구글 ``Noto Serif KR'' 글꼴을 선택적용하고, `hrbrthemes'
라이브러리를 이용하여 뒷 배경 검정색을 사용하여 붉은색 질병으로 인한
사망자수 확연한 감소를 시각적으로 강조한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(hrbrthemes) }
\FunctionTok{library}\NormalTok{(showtext)}
\FunctionTok{showtext.auto}\NormalTok{()}
\FunctionTok{font\_add\_google}\NormalTok{(}\AttributeTok{name =} \StringTok{"Noto Serif KR"}\NormalTok{, }\AttributeTok{family =} \StringTok{"noto\_serif"}\NormalTok{)}
\NormalTok{noto\_font }\OtherTok{\textless{}{-}} \StringTok{"noto\_serif"}

\NormalTok{death\_gg }\OtherTok{\textless{}{-}}\NormalTok{ death\_viz }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ 해당월, }\AttributeTok{y =}\NormalTok{ 사망자수, }\AttributeTok{fill =}\NormalTok{ 사망원인)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey20"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{theme\_modern\_rc}\NormalTok{(}\AttributeTok{base\_family =}\NormalTok{ noto\_font, }\AttributeTok{subtitle\_family =}\NormalTok{ noto\_font) }\SpecialCharTok{+} 
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"firebrick"}\NormalTok{, }\StringTok{"orange"}\NormalTok{, }\StringTok{"\#365181"}\NormalTok{), }\AttributeTok{name =} \StringTok{""}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_sqrt}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ 체제) }\SpecialCharTok{+} 
  \FunctionTok{coord\_equal}\NormalTok{(}\AttributeTok{ratio =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}  
  \FunctionTok{coord\_polar}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"크림전쟁 병사 사망원인"}\NormalTok{, }
       \AttributeTok{subtitle =} \StringTok{"데이터 시각화와 커뮤니케이션"}\NormalTok{, }
       \AttributeTok{caption =} \StringTok{"데이터 출처: 크림전쟁 사망자"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{, }
        \AttributeTok{text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{18}\NormalTok{),}
        \AttributeTok{axis.title.y =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{axis.title.x =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{axis.text.y =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{axis.ticks =} \FunctionTok{element\_blank}\NormalTok{(),}
        \AttributeTok{plot.margin =} \FunctionTok{unit}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FloatTok{0.7}\NormalTok{, }\DecValTok{4}\NormalTok{), }\StringTok{"cm"}\NormalTok{),}
        \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{25}\NormalTok{),}
        \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey70"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{12}\NormalTok{),}
        \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey70"}\NormalTok{, }\AttributeTok{size =} \DecValTok{13}\NormalTok{),}
        \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{),}
        \AttributeTok{strip.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{size =} \DecValTok{25}\NormalTok{, }\AttributeTok{face =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{hjust =} \FloatTok{0.5}\NormalTok{))}

\NormalTok{death\_gg}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_nightingale_files/figure-pdf/unnamed-chunk-4-1.pdf}

}

\end{figure}

\hypertarget{uxc120uxadf8uxb798uxd504}{%
\subsection{선그래프}\label{uxc120uxadf8uxb798uxd504}}

나이팅게일은 간호 분야의 선구자로 잘 알려져 있지만, 통계학자로서
``콕스콤(CoxComb)'' 또는 ``장미 다이어그램''(Rose Diagram)으로 알려진
원그래프를 제시하였지만 현재는 시간의 흐름에 따라 병사 사망자수 변화를
조치 전후로 명확히 하는 방법으로 선그래프가 기본 기법으로 자리잡고 있다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{extrafont}\SpecialCharTok{::}\FunctionTok{loadfonts}\NormalTok{()}

\NormalTok{death\_new\_gg }\OtherTok{\textless{}{-}}\NormalTok{ death\_viz }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Date, }\AttributeTok{y =}\NormalTok{ 사망자수, }\AttributeTok{color =}\NormalTok{ 사망원인)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}03{-}15"}\NormalTok{), }\AttributeTok{linetype=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_ipsum\_pub}\NormalTok{(}\AttributeTok{base\_family =}\NormalTok{ noto\_font, }\AttributeTok{subtitle\_family =}\NormalTok{ noto\_font) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"크림전쟁 병사 사망원인"}\NormalTok{, }
         \AttributeTok{subtitle =} \StringTok{"데이터 시각화와 커뮤니케이션"}\NormalTok{, }
         \AttributeTok{caption =} \StringTok{"데이터 출처: 크림전쟁 사망자"}\NormalTok{,}
         \AttributeTok{x =} \StringTok{"월일"}\NormalTok{) }\SpecialCharTok{+} 
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{comma, }\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1150}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{, }
          \AttributeTok{text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{18}\NormalTok{),}
          \AttributeTok{axis.ticks =} \FunctionTok{element\_blank}\NormalTok{(),}
          \AttributeTok{plot.margin =} \FunctionTok{unit}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FloatTok{0.7}\NormalTok{, }\DecValTok{4}\NormalTok{), }\StringTok{"cm"}\NormalTok{),}
          \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{35}\NormalTok{),}
          \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey10"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{17}\NormalTok{),}
          \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey5"}\NormalTok{, }\AttributeTok{size =} \DecValTok{13}\NormalTok{),}
          \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{geom\_segment}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1854{-}03{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{xend =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}03{-}01"}\NormalTok{), }\AttributeTok{yend =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{color =} \StringTok{"gray70"}\NormalTok{,}
                 \AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{length =} \FunctionTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"inches"}\NormalTok{))) }\SpecialCharTok{+}
    \FunctionTok{geom\_segment}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}04{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{xend =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1856{-}03{-}01"}\NormalTok{), }\AttributeTok{yend =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{color =} \StringTok{"gray15"}\NormalTok{,}
                 \AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{length =} \FunctionTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"inches"}\NormalTok{))) }\SpecialCharTok{+}
    \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1854{-}09{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1140}\NormalTok{, }\AttributeTok{label =} \StringTok{"조치이전"}\NormalTok{,}
             \AttributeTok{size =} \FloatTok{8.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray30"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font) }\SpecialCharTok{+}
    \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}09{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1140}\NormalTok{, }\AttributeTok{label =} \StringTok{"조치이후"}\NormalTok{,}
             \AttributeTok{size =} \FloatTok{8.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray15"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font)          }

\NormalTok{death\_new\_gg}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_nightingale_files/figure-pdf/unnamed-chunk-5-1.pdf}

}

\end{figure}

\hypertarget{uxb9c9uxb300uxadf8uxb798uxd504}{%
\subsection{막대그래프}\label{uxb9c9uxb300uxadf8uxb798uxd504}}

동일한 정보를 막대그래프를 통해 시각화를 할 수도 있다. 원그래프와
비교하여 보면 명확하게 사망자수를 직관적으로 비교할 수 있다는 점에서 큰
장점이 있다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{death\_viz }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_col}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Date, }\AttributeTok{y =}\NormalTok{ 사망자수, }\AttributeTok{fill =}\NormalTok{ 사망원인), }\AttributeTok{colour=}\StringTok{"white"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}03{-}15"}\NormalTok{), }\AttributeTok{linetype=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"firebrick"}\NormalTok{, }\StringTok{"orange"}\NormalTok{, }\StringTok{"\#365181"}\NormalTok{)) }\SpecialCharTok{+} 
    \CommentTok{\# theme\_ipsum\_pub(base\_family = noto\_font, subtitle\_family = noto\_font) +}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"크림전쟁 병사 사망원인"}\NormalTok{, }
         \AttributeTok{subtitle =} \StringTok{"데이터 시각화와 커뮤니케이션"}\NormalTok{, }
         \AttributeTok{caption =} \StringTok{"데이터 출처: 크림전쟁 사망자"}\NormalTok{,}
         \AttributeTok{x =} \StringTok{"월일"}\NormalTok{) }\SpecialCharTok{+} 
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{comma, }\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1150}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{, }
          \AttributeTok{text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{18}\NormalTok{),}
          \AttributeTok{axis.ticks =} \FunctionTok{element\_blank}\NormalTok{(),}
          \AttributeTok{plot.margin =} \FunctionTok{unit}\NormalTok{(}\FunctionTok{rep}\NormalTok{(}\FloatTok{0.7}\NormalTok{, }\DecValTok{4}\NormalTok{), }\StringTok{"cm"}\NormalTok{),}
          \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{35}\NormalTok{),}
          \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey10"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font, }\AttributeTok{size =} \DecValTok{17}\NormalTok{),}
          \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey5"}\NormalTok{, }\AttributeTok{size =} \DecValTok{13}\NormalTok{),}
          \AttributeTok{legend.text =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{, }\AttributeTok{size =} \DecValTok{15}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{geom\_segment}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1854{-}03{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{xend =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}03{-}01"}\NormalTok{), }\AttributeTok{yend =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{color =} \StringTok{"gray70"}\NormalTok{,}
                 \AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{length =} \FunctionTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"inches"}\NormalTok{))) }\SpecialCharTok{+}
    \FunctionTok{geom\_segment}\NormalTok{(}\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}04{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{xend =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1856{-}03{-}01"}\NormalTok{), }\AttributeTok{yend =} \DecValTok{1100}\NormalTok{,}
                 \AttributeTok{color =} \StringTok{"gray15"}\NormalTok{,}
                 \AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{length =} \FunctionTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"inches"}\NormalTok{))) }\SpecialCharTok{+}
    \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1854{-}09{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1140}\NormalTok{, }\AttributeTok{label =} \StringTok{"조치이전"}\NormalTok{,}
             \AttributeTok{size =} \FloatTok{8.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray30"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font) }\SpecialCharTok{+}
    \FunctionTok{annotate}\NormalTok{(}\StringTok{"text"}\NormalTok{, }\AttributeTok{x =} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"1855{-}09{-}01"}\NormalTok{), }\AttributeTok{y =} \DecValTok{1140}\NormalTok{, }\AttributeTok{label =} \StringTok{"조치이후"}\NormalTok{,}
             \AttributeTok{size =} \FloatTok{8.5}\NormalTok{, }\AttributeTok{color =} \StringTok{"gray15"}\NormalTok{, }\AttributeTok{family =}\NormalTok{ noto\_font) }
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_nightingale_files/figure-pdf/unnamed-chunk-6-1.pdf}

}

\end{figure}

\hypertarget{uxd45c-uxbb38uxbc95}{%
\section{표 문법}\label{uxd45c-uxbb38uxbc95}}

데이터 문법, 그래프 문법에 이어 최근 ``표 문법''이 새롭게 자리를
잡아가고 있다. 표 문법에 맞춰 나이팅게일 크림전쟁 사망자수를 조치 이전과
조치 이후로 나눠 요약하면 확연한 차이를 파악할 수 있다.

\texttt{gt}와 \texttt{gtExtras} 패키지를 활용하여 \texttt{death\_viz}
데이터프레임을 사망 원인별 사망자 수를 ``조치 이전''과 ``조치 이후''로
구분하여 표를 두개 생성한다. 각 표은 날짜, 질병, 부상, 기타 범주로
사망자 수와 그 합계를 표시하며, 총 사망자수가 250명을 초과하는 행에 대한
강조 색상을 입히고 나서 두 표를 나란히 배치하여 조치 전후 효과를
시각적으로 비교한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gt)}
\FunctionTok{library}\NormalTok{(gtExtras)}

\NormalTok{before\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ death\_viz }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(체제 }\SpecialCharTok{==} \StringTok{"조치이전"}\NormalTok{)}

\NormalTok{after\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ death\_viz }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(체제 }\SpecialCharTok{==} \StringTok{"조치이후"}\NormalTok{)}

\NormalTok{before\_gt }\OtherTok{\textless{}{-}}\NormalTok{ before\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ 사망원인, }\AttributeTok{values\_from =}\NormalTok{ 사망자수) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(날짜 }\OtherTok{=}\NormalTok{ Date, 질병, 부상, 기타) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(합계 }\OtherTok{=}\NormalTok{ 질병 }\SpecialCharTok{+}\NormalTok{ 부상 }\SpecialCharTok{+}\NormalTok{ 기타) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_538}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_integer}\NormalTok{( }\AttributeTok{columns =}\NormalTok{ 질병}\SpecialCharTok{:}\NormalTok{합계) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"조치 이전"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(질병, 부상, 기타)) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{data\_color}\NormalTok{(}
      \AttributeTok{columns =} \FunctionTok{c}\NormalTok{(질병, 부상, 기타, 합계),}
      \AttributeTok{rows =}\NormalTok{ 합계 }\SpecialCharTok{\textgreater{}} \DecValTok{250}\NormalTok{,      }
      \AttributeTok{method =} \StringTok{"numeric"}\NormalTok{,}
      \AttributeTok{palette =} \StringTok{"ggsci::red\_material"}\NormalTok{)}

\NormalTok{after\_gt }\OtherTok{\textless{}{-}}\NormalTok{ after\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ 사망원인, }\AttributeTok{values\_from =}\NormalTok{ 사망자수) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(날짜 }\OtherTok{=}\NormalTok{ Date, 질병, 부상, 기타) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(합계 }\OtherTok{=}\NormalTok{ 질병 }\SpecialCharTok{+}\NormalTok{ 부상 }\SpecialCharTok{+}\NormalTok{ 기타) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_538}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_integer}\NormalTok{( }\AttributeTok{columns =}\NormalTok{ 질병}\SpecialCharTok{:}\NormalTok{합계) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"조치 이후"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(질병, 부상, 기타)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{data\_color}\NormalTok{(}
    \AttributeTok{columns =} \FunctionTok{c}\NormalTok{(질병, 부상, 기타, 합계),}
    \AttributeTok{rows =}\NormalTok{ 합계 }\SpecialCharTok{\textgreater{}} \DecValTok{250}\NormalTok{,      }
    \AttributeTok{method =} \StringTok{"numeric"}\NormalTok{,}
    \AttributeTok{palette =} \StringTok{"ggsci::red\_material"}\NormalTok{)}

\NormalTok{gtExtras}\SpecialCharTok{::}\FunctionTok{gt\_two\_column\_layout}\NormalTok{(}\FunctionTok{list}\NormalTok{(before\_gt, after\_gt))}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxcee4uxbba4uxb2c8uxcf00uxc774uxc158}{%
\section{커뮤니케이션}\label{uxcee4uxbba4uxb2c8uxcf00uxc774uxc158}}

데이터를 기반으로 뭔가 유용한 것을 창출한 후에 이를 알리기 위해
커뮤니케이션 단계를 거치게 된다. 가장 흔히 사용하는 방식은 엑셀, 워드,
파워포인트와 같은 MS 오피스 제품을 활용하는 방식이다. 과거 SAS, SPSS,
미니탭 등 외산 통계 팩키지로 데이터를 분석하고 유용한 모형 등을 찾아낸
후에 이를 커뮤니케이션하기 위해 MS 오피스 제품을 통해 커뮤니케이션을
하기도 했다. 하지만, 각각은 별개의 시스템으로 분리되어 있어 일일이
사람손이 가는 번거러움이 많았다. 이를 해결하기 하는 방법은 하나의 도구
혹은 언어로 모든 작업을 처리하는 것이다. {[}\^{}meghan{]}

{[}\^{}meghan{]} :
\href{https://meghan.rbind.io/slides/rstudio/hall_rstudio_2021}{Meghan
Hall (June 15, 2021), ``Extending R Markdown'', RStudio: R in Sports
Analytics,}

우선 엑셀은 \texttt{tidyverse} 로 대체가 되고, 워드는 R 마크다운을 거쳐
쿼토(Quarto), 파워포인트도 R 마크다운(\texttt{xaringan} 등)에서 진화한
\texttt{reveal.js} 기반 쿼토 슬라이드가 빠르게 자리를 잡아가고 있다.

\begin{figure}

{\centering \includegraphics{images/nightingale_office.png}

}

\caption{오피스 기반 커뮤니케이션 현재 상태점검}

\end{figure}

데이터 과학을 커뮤니케이션하는 방식은 다양한 방식이 존재하지만 직장상사
뿐만 아니라 집단지성을 넘어 AI를 적극 도입하여 데이터 분석 역량을
고도화하는데 동료 개발자 및 협업하시는 분들과 커뮤니케이션 뿐만 아니라
불특정 다수를 대상으로 한 인터넷에 공개와 공유를 통해 새로운 관계를
맺어가는 것도 그 중요성을 더해가고 있다.

\begin{itemize}
\tightlist
\item
  동료 개발자나 협업하시는 분: \texttt{.qmd} 파일
\item
  직장상사

  \begin{itemize}
  \tightlist
  \item
    PDF 파일: \texttt{quarto}, \texttt{pandoc}
  \item
    파워포인트 슬라이스덱: \texttt{reveal.js} 기반 \texttt{quarto}
  \item
    대쉬보드: \texttt{flexdashboard}
  \end{itemize}
\item
  일반 공개

  \begin{itemize}
  \tightlist
  \item
    웹사이트: \texttt{distill}을 지나 \texttt{quarto}
  \item
    블로그: \texttt{blogdown}을 지나 \texttt{quarto}
  \item
    책: \texttt{bookdown}을 지나 \texttt{quarto}
  \end{itemize}
\end{itemize}

\includegraphics{images/nightingale_communication.jpg}

\hypertarget{uxb098uxd3f4uxb808uxc639-uxb7ecuxc2dcuxc544-uxce68uxacf5}{%
\chapter{나폴레옹 러시아
침공}\label{uxb098uxd3f4uxb808uxc639-uxb7ecuxc2dcuxc544-uxce68uxacf5}}

나폴레옹의 러시아 원정은 1812년, 대륙봉쇄령을 강화하려는 의도로
시작되었다. 영국의 경제를 약화시키기 위해 대륙봉쇄령을 시행하는
나폴레옹은 유럽 주요 국가들에게 영국과 거래 중단을 요청하였으나,
러시아는 이에 따르지 않았다. 이로 인해 두 국가 간의 긴장이 고조되어
나폴레옹은 대대적인 군사 원정을 계획하게 되었다.

1812년 6월, 나폴레옹은 약 600,000명의 병력을 동원하여 러시아에 침공했다.
러시아의 청야전술과 광활한 황무지는 군대에 큰 시련을 줬다. 나폴레옹
군대가 모스크바에 도착했을 때 이미 모스코바는 화재로 도시 기능을 잃었고,
러시아가 평화 협상에 응하지 않아 기대했던 성과도 거둘 수 없었다. 결국,
군사적 실패와 식량 부족, 추운 날씨, 러시아군의 계속되는 습격에 시달리며
병력 대부분을 잃고 귀환했고, 원정은 실패로 일달락 되었다. 러시아 원정은
나폴레옹 제국 몰락을 앞당긴 결정적 순간으로 기록되었다.

\begin{figure}

{\centering \includegraphics{images/about_napoleon.png}

}

\caption{나폴레옹 최대 영토}

\end{figure}

\hypertarget{uxbbf8uxb098uxb974-uxc9c0uxb3c4}{%
\section{미나르 지도}\label{uxbbf8uxb098uxb974-uxc9c0uxb3c4}}

찰스 조셉 미나르(Charles Joseph Minard)가 제작한 1869년 지도는
나폴레옹의 1812년 러시아 원정을 시각적으로 표현한 것으로, 다양한 데이터
시각화의 원칙과 기술을 혁신적으로 보여주는 명작으로 평가받고 있다.
나폴레옹 군대가 러시아로 진군하고 다시 귀환하는 과정에서 병력이 얼마나
줄어들었는지를 선의 두께로 표시했을 뿐만 아니라, 지도에는 군대 이동
경로, 위치, 날짜, 온도 등 다양한 정보가 함께 표시되어, 단순한 지리적
정보를 넘어서 시간과 조건에 따른 변화까지 한 눈에 파악할 수 있다.

미나르의 지도는 데이터 시각화의 중요성과 효과를 입증하는 고전으로
여겨진다. 복잡하고 다양한 데이터를 단순하면서도 명확하게 표현함으로써,
복잡한 사건과 현상을 이해하기 쉽게 제작했다. 나폴레옹 군대의 군사적 실패
뿐만 아니라, 병참, 전략, 날씨가 군사 작전에 미치는 영향을 진군과 후퇴를
색상을 달리하여 표현하는 등 시각화를 통해 잘 보여주고 있다.

\begin{figure}

{\centering \includegraphics{images/Minard.png}

}

\caption{나폴레옹 러시아 원정 미나르 지도}

\end{figure}

저자를 포함한 많은 분들이 프랑스 파리에서 출발하여 러시아 원정이
시작되었다고 잘못알고 있으나, 1812년 러시아 원정 시작지는 니멘 강(Neman
River)을 건너는 지점으로 니멘 강은 당시 러시아와 프랑스 연합국인
프러시아(당시 동유럽에 위치) 사이에서 경계를 형성하고 있었다. 1812년 6월
24일, 나폴레옹의 대군이 이 강을 건너면서 러시아 침공을 시작됐다.

\begin{figure}

{\centering \includegraphics{images/minard-actual-map.png}

}

\caption{미나르 지도를 현재 지도와 매핑}

\end{figure}

\hypertarget{uxb370uxc774uxd130}{%
\section{데이터}\label{uxb370uxc774uxd130}}

\hypertarget{uxc0dduxc874uxbcd1uxc0ac-uxc218}{%
\subsection{생존병사 수}\label{uxc0dduxc874uxbcd1uxc0ac-uxc218}}

\texttt{HistData} 패키지에 나폴레옹 러시아 원정 데이터셋이 포함되어
있다. 원데이터셋은
\href{https://www.cs.uic.edu/~wilkinson/TheGrammarOfGraphics/minard.txt}{\texttt{minard.txt}}
파일에서 바로 얻을 수 있다.

\texttt{HistData}, \texttt{tidyverse}, \texttt{gt}, \texttt{gtExtras}
패키지를 활용하여 나폴레옹 러시아 원정 데이터를 표형태로 출력한다.

먼저 필요한 패키지를 불러온 다음, 병사 이동
경로(\texttt{Minard.troops}), 도시 정보(\texttt{Minard.cities}), 기온
데이터(\texttt{Minard.temp})를 적재하고, \texttt{filter()} 함수를
사용하여 진격과 후퇴 상황에 따라 데이터를 나눠 \texttt{attack\_tbl}과
\texttt{retreat\_tbl}에 저장한다.

\texttt{gt()} 함수로 데이터프레임을 표로 변화시키는데,
\texttt{gt\_theme\_hangul()} 함수는 한글 테마를 적용하고,
\texttt{fmt\_integer()}는 정수 형태로 천단위 넘는 숫자 가독성을 높이고,
\texttt{cols\_align()} 함수로 칼럼을 가운데 정렬하고,
\texttt{cols\_label()}로 칼럼 라벨을 영어에서 한글로 변환한다.
\texttt{tab\_header()} 함수로 진격과 후퇴 제목을 설정하여
\texttt{attack\_gt}와 \texttt{retreat\_gt}에 각각 저장한다. 마지막으로
\texttt{gtExtras::gt\_two\_column\_layout()} 함수를 사용하여 두 표를
병합하여 마무리한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(HistData)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(gt)}
\FunctionTok{library}\NormalTok{(gtExtras)}

\FunctionTok{data}\NormalTok{(Minard.troops) }
\FunctionTok{data}\NormalTok{(Minard.cities)}
\FunctionTok{data}\NormalTok{(Minard.temp)}

\NormalTok{attack\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ Minard.troops }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(direction }\SpecialCharTok{==} \StringTok{"A"}\NormalTok{)}

\NormalTok{retreat\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ Minard.troops }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(direction }\SpecialCharTok{==} \StringTok{"R"}\NormalTok{)}

\NormalTok{attack\_gt }\OtherTok{\textless{}{-}}\NormalTok{ attack\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_integer}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ survivors) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_label}\NormalTok{(}
      \AttributeTok{long =} \StringTok{"경도"}\NormalTok{,}
      \AttributeTok{lat =} \StringTok{"위도"}\NormalTok{,}
      \AttributeTok{survivors =}  \StringTok{"생존병사수"}\NormalTok{,}
      \AttributeTok{direction =} \StringTok{"진격방향"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{tab\_header}\NormalTok{(}\AttributeTok{title =} \StringTok{"진격경로"}\NormalTok{)}

\NormalTok{retreat\_gt }\OtherTok{\textless{}{-}}\NormalTok{ retreat\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_integer}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ survivors) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_label}\NormalTok{(}
      \AttributeTok{long =} \StringTok{"경도"}\NormalTok{,}
      \AttributeTok{lat =} \StringTok{"위도"}\NormalTok{,}
      \AttributeTok{survivors =}  \StringTok{"생존병사수"}\NormalTok{,}
      \AttributeTok{direction =} \StringTok{"진격방향"}
\NormalTok{    )  }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{tab\_header}\NormalTok{(}\AttributeTok{title =} \StringTok{"후퇴"}\NormalTok{)}

\NormalTok{gtExtras}\SpecialCharTok{::}\FunctionTok{gt\_two\_column\_layout}\NormalTok{(}\FunctionTok{list}\NormalTok{(attack\_gt, retreat\_gt))}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxd6c4uxd1f4-uxae30uxc628}{%
\subsection{후퇴 기온}\label{uxd6c4uxd1f4-uxae30uxc628}}

\texttt{Minard.temp} 데이터셋을 사용하여 후퇴 시점의 온도 정보를 표로
제작한다. 먼저 \texttt{mutate()} 함수를 통해 \texttt{date} 칼럼 값을
문자열로 변환하고, ``1812'' 연도를 추가해 날짜 정보를 완성한다.
\texttt{mdy()} 함수를 사용해 날짜 문자열을 \texttt{Date} 자료형으로
변환하는데, \texttt{quiet\ =\ TRUE} 옵션을 설정해 경고 메시지를 표시하지
않게 한다.

이후에는 \texttt{gt()} 함수를 사용해 데이터 프레임을 테이블로 변환하게
된다. \texttt{gt\_theme\_hangul()}을 통해 테이블에 한국어 테마를
적용하고, \texttt{cols\_align("center")}로 모든 칼럼을 가운데 정렬한다.
\texttt{cols\_label()} 함수를 통해 각 칼럼에 적절한 한국어 레이블을
지정한다. 만약

\texttt{gt()} 함수로 데이터프레임을 표로 변화시키는데,
\texttt{gt\_theme\_hangul()} 함수는 한글 테마를 적용하고,
\texttt{fmt\_integer()}는 정수 형태로 천단위 넘는 숫자 가독성을 높이고,
\texttt{cols\_align()} 함수로 칼럼을 가운데 정렬하고,
\texttt{cols\_label()}로 칼럼 라벨을 영어에서 한글로 변환한다. 관측날짜
칼럼에 누락된 값이 있으면,
\texttt{fmt\_missing(missing\_text\ =\ "-")}를 사용하여 누락된 값을
``-''로 표시한다.

\texttt{fmt\_date()} 함수를 사용하여 \texttt{date} 칼럼의 날짜 형식을
\texttt{date\_style\ =\ "yMMMd"}와 \texttt{locale\ =\ "ko"}를 설정하여
연도, 월, 일을 대한민국 기준에 맞춘다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Minard.temp }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{as.character}\NormalTok{(date), }\CommentTok{\# date를 문자열로 변환}
         \AttributeTok{date =} \FunctionTok{str\_glue}\NormalTok{(}\StringTok{"\{date\}/1812"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{mdy}\NormalTok{(date, }\AttributeTok{quiet =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{|\textgreater{}}  \CommentTok{\# quiet = TRUE로 경고 메시지 방지}

  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \CommentTok{\# fmt\_integer(columns = survivors) |\textgreater{} }
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_label}\NormalTok{(  }
      \AttributeTok{long =} \StringTok{"위도"}\NormalTok{,}
      \AttributeTok{temp =} \StringTok{"기온"}\NormalTok{,}
      \AttributeTok{days =} \StringTok{"후퇴날짜"}\NormalTok{,}
      \AttributeTok{date =} \StringTok{"관측날짜"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{tab\_header}\NormalTok{(}\AttributeTok{title =} \StringTok{"후퇴 온도"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{    gt}\SpecialCharTok{::}\FunctionTok{fmt\_missing}\NormalTok{(}\AttributeTok{missing\_text =} \StringTok{"{-}"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_date}\NormalTok{(}
      \AttributeTok{columns =}\NormalTok{ date,}
      \AttributeTok{date\_style  =} \StringTok{"yMMMd"}\NormalTok{,}
      \AttributeTok{locale =} \StringTok{"ko"}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{cccc}
\caption*{
{\large 후퇴 온도}
} \\ 
\toprule
위도 & 기온 & 후퇴날짜 & 관측날짜 \\ 
\midrule
37.6 & 0 & 6 & 1812년 10월 18일 \\ 
36.0 & 0 & 6 & 1812년 10월 24일 \\ 
33.2 & -9 & 16 & 1812년 11월 9일 \\ 
32.0 & -21 & 5 & 1812년 11월 14일 \\ 
29.2 & -11 & 10 & - \\ 
28.5 & -20 & 4 & 1812년 11월 28일 \\ 
27.2 & -24 & 3 & 1812년 12월 1일 \\ 
26.7 & -30 & 5 & 1812년 12월 6일 \\ 
25.3 & -26 & 1 & 1812년 12월 7일 \\ 
\bottomrule
\end{longtable*}

\hypertarget{uxc2dcuxac01uxd654-1}{%
\section{시각화}\label{uxc2dcuxac01uxd654-1}}

나폴레옹의 러시아 침공을 앞선 데이터셋을 바탕으로 시각화한다.
\texttt{HistData} 패키지에서 제공하는 \texttt{Minard} 데이터셋을
이용하여 병력의 이동 경로와 생존 병사 수를
그리고(\texttt{plot\_troops}), 주요 도시의 위치를
표시한다(\texttt{plot\_cities}). 두 그래프를 합쳐 하나의
그래프(\texttt{plot\_minard})로 만들고, 그 위에 온도
변화(\texttt{plot\_temp})까지 표시한다. 마지막으로 \texttt{grid.arrange}
함수를 사용해 두 그래프를 하나로 합치고, 이를 이미지 파일로 저장한다.

병력 이동, 생존자 수, 도시 위치, 그리고 온도 변화, 진격과 후퇴 색상을
달리하여 나폴레옹 러시아 침공에 대한 전반적인 사항을 한눈에 볼 수 있는
시각화 그래프를 제작했다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(HistData)}
\FunctionTok{library}\NormalTok{(ggrepel)}
\FunctionTok{require}\NormalTok{(scales)}
\FunctionTok{require}\NormalTok{(gridExtra)}

\FunctionTok{data}\NormalTok{(Minard.troops)}
\FunctionTok{data}\NormalTok{(Minard.cities)}
\FunctionTok{data}\NormalTok{(Minard.temp)}

\FunctionTok{levels}\NormalTok{(Minard.cities}\SpecialCharTok{$}\NormalTok{city) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Bobr"}\NormalTok{, }\StringTok{"Chjat"}\NormalTok{, }\StringTok{"Dorogobouge"}\NormalTok{, }\StringTok{"Gloubokoe"}\NormalTok{, }\StringTok{"Kowno"}\NormalTok{, }\StringTok{"Malo{-}Jarosewii"}\NormalTok{, }
                                \StringTok{"Minsk"}\NormalTok{, }\StringTok{"Mohilow"}\NormalTok{, }\StringTok{"Moiodexno"}\NormalTok{, }\StringTok{"Mojaisk"}\NormalTok{, }\StringTok{"모스코바"}\NormalTok{, }\StringTok{"Orscha"}\NormalTok{, }
                                \StringTok{"Polotzk"}\NormalTok{, }\StringTok{"Smolensk"}\NormalTok{, }\StringTok{"Smorgoni"}\NormalTok{, }\StringTok{"Studienska"}\NormalTok{, }\StringTok{"Tarantino"}\NormalTok{, }
                                \StringTok{"Wilna"}\NormalTok{, }\StringTok{"Witebsk"}\NormalTok{, }\StringTok{"Wixma"}\NormalTok{)}

\CommentTok{\# 병력 이동 경로와 도시 이름을 레이어에 올린다.}
\NormalTok{plot\_troops }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(Minard.troops, }\FunctionTok{aes}\NormalTok{(long, lat)) }\SpecialCharTok{+}
    \FunctionTok{geom\_path}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{size =}\NormalTok{ survivors, }\AttributeTok{colour =}\NormalTok{ direction, }\AttributeTok{group =}\NormalTok{ group),}
               \AttributeTok{lineend =} \StringTok{"round"}\NormalTok{, }\AttributeTok{linejoin =} \StringTok{"round"}\NormalTok{)}
\NormalTok{plot\_cities }\OtherTok{\textless{}{-}} \FunctionTok{geom\_text}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ city), }\AttributeTok{size =} \DecValTok{4}\NormalTok{, }\AttributeTok{data =}\NormalTok{ Minard.cities)}
 
\CommentTok{\# 눈금 정보, 라벨을 추가}
\CommentTok{\# 온도를 맞추도록 경도에 대한 x축 명시적 설정.}

\NormalTok{breaks }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{) }\SpecialCharTok{*} \DecValTok{10}\SpecialCharTok{\^{}}\DecValTok{5} 

\NormalTok{plot\_minard }\OtherTok{\textless{}{-}}\NormalTok{ plot\_troops }\SpecialCharTok{+}\NormalTok{ plot\_cities }\SpecialCharTok{+}
    \FunctionTok{scale\_size}\NormalTok{(}\StringTok{"생존병사수"}\NormalTok{, }\AttributeTok{range =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{), }
                \AttributeTok{breaks =}\NormalTok{ breaks, }\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\FunctionTok{comma}\NormalTok{(breaks)) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\StringTok{"진격방향"}\NormalTok{, }
                     \AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"grey50"}\NormalTok{, }\StringTok{"red"}\NormalTok{), }
                     \AttributeTok{labels=}\FunctionTok{c}\NormalTok{(}\StringTok{"진격"}\NormalTok{, }\StringTok{"후퇴"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{24}\NormalTok{, }\DecValTok{38}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"경도"}\NormalTok{,}
       \AttributeTok{title =} \StringTok{"나폴레옹 러시아 침공"}\NormalTok{,}
       \AttributeTok{subtitle =} \StringTok{"1812년 6월 24일 \textasciitilde{} 1813년 1월 5일"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_korean}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position=}\FunctionTok{c}\NormalTok{(.}\DecValTok{8}\NormalTok{, .}\DecValTok{2}\NormalTok{), }\AttributeTok{legend.box=}\StringTok{"horizontal"}\NormalTok{)}
 
\NormalTok{plot\_temp }\OtherTok{\textless{}{-}}\NormalTok{ Minard.temp }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{case\_when}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(date, }\StringTok{"Oct"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{str\_replace}\NormalTok{(date, }\StringTok{"Oct"}\NormalTok{, }\StringTok{"10월"}\NormalTok{),}
                          \FunctionTok{str\_detect}\NormalTok{(date, }\StringTok{"Nov"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{str\_replace}\NormalTok{(date, }\StringTok{"Nov"}\NormalTok{, }\StringTok{"11월"}\NormalTok{),}
                          \FunctionTok{str\_detect}\NormalTok{(date, }\StringTok{"Dec"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{str\_replace}\NormalTok{(date, }\StringTok{"Dec"}\NormalTok{, }\StringTok{"12월"}\NormalTok{),}
                           \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}} \StringTok{"미상"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =}\NormalTok{ glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"\{date\}일"}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{date =} \FunctionTok{ifelse}\NormalTok{(date }\SpecialCharTok{==} \StringTok{"미상일"}\NormalTok{, }\StringTok{"미상"}\NormalTok{, date)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(long, temp)) }\SpecialCharTok{+}
    \FunctionTok{geom\_path}\NormalTok{(}\AttributeTok{color=}\StringTok{"grey"}\NormalTok{, }\AttributeTok{size=}\FloatTok{1.5}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{size=}\DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_text\_repel}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{label=}\NormalTok{glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"\{date\}"}\NormalTok{)) ) }\SpecialCharTok{+}
    \FunctionTok{xlab}\NormalTok{(}\StringTok{"위도"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{ylab}\NormalTok{(}\StringTok{"기온"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{24}\NormalTok{, }\DecValTok{38}\NormalTok{)) }\SpecialCharTok{+} 
    \FunctionTok{theme\_korean}\NormalTok{()}
    
\CommentTok{\# 그래프 결합}
\NormalTok{minard\_g }\OtherTok{\textless{}{-}} \FunctionTok{grid.arrange}\NormalTok{(plot\_minard, plot\_temp, }\AttributeTok{nrow=}\DecValTok{2}\NormalTok{, }\AttributeTok{heights=}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{1}\NormalTok{))}

\FunctionTok{ggsave}\NormalTok{( glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"images/나폴레옹\_러시아.png"}\NormalTok{) , }
\NormalTok{        minard\_g,}
        \AttributeTok{device =}\NormalTok{ ragg}\SpecialCharTok{::}\NormalTok{agg\_png, }
        \AttributeTok{width =} \DecValTok{297}\NormalTok{, }\AttributeTok{height =} \DecValTok{210}\NormalTok{, }\AttributeTok{units =} \StringTok{"mm"}\NormalTok{, }\AttributeTok{res =} \DecValTok{600}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{images/나폴레옹_러시아.png}

}

\end{figure}

\hypertarget{uxc720uxbcf4uxb4dc}{%
\chapter{유보드}\label{uxc720uxbcf4uxb4dc}}

\autocite{hendron2016germany}

\href{https://uboat.net/}{uboat.net}에서 제2차 세계대전 모든 독일 U보트,
지휘관, 공격한 연합군 함선을 포함한 작전, 기술 정보 등이 정리되어 있다.
Kaden Hendron은 독일 유보드 데이터를
\href{https://github.com/kadenhendron/uboat-data}{kadenhendron/uboat-data}
저장소에 포트폴리오와 함께 정리해뒀다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{download.file}\NormalTok{(}\AttributeTok{url =} \StringTok{"https://raw.githubusercontent.com/kadenhendron/uboat{-}data/master/data/uboat{-}data.csv"}\NormalTok{, }
              \AttributeTok{destfile =} \StringTok{"data/uboat{-}data.csv"}\NormalTok{, }\AttributeTok{model =} \StringTok{"w"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxc720uxbcf4uxd2b8-uxb370uxc774uxd130}{%
\section{유보트 데이터}\label{uxc720uxbcf4uxd2b8-uxb370uxc774uxd130}}

총 1,153대 유보트가 활동했으며 전쟁이 끝난 후에 유보트 운명을 표로
정리하면 다음과 같다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(gt)}
\FunctionTok{library}\NormalTok{(gtExtras)}

\NormalTok{uboat\_raw }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/uboat{-}data.csv"}\NormalTok{)}

\NormalTok{fate\_type\_eng }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Sunk"}\NormalTok{, }\StringTok{"Scuttled"}\NormalTok{, }\StringTok{"Surrendered"}\NormalTok{, }\StringTok{"Decommissioned"}\NormalTok{, }\StringTok{"Missing"}\NormalTok{, }
\StringTok{"Given"}\NormalTok{, }\StringTok{"Damaged"}\NormalTok{, }\StringTok{"Captured"}\NormalTok{, }\StringTok{"Grounded"}\NormalTok{, }\StringTok{"Destroyed"}\NormalTok{)}

\NormalTok{fate\_type\_kor }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"침몰"}\NormalTok{, }\StringTok{"자침"}\NormalTok{, }\StringTok{"항복"}\NormalTok{, }\StringTok{"해체"}\NormalTok{, }\StringTok{"실종"}\NormalTok{, }\StringTok{"기증"}\NormalTok{, }\StringTok{"손상"}\NormalTok{, }\StringTok{"포획"}\NormalTok{, }\StringTok{"좌초"}\NormalTok{, }\StringTok{"파괴"}\NormalTok{)}

\NormalTok{fate\_translation }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{fate\_type =}\NormalTok{ fate\_type\_eng,}
                           \AttributeTok{fate\_type\_kor =}\NormalTok{ fate\_type\_kor)}

\NormalTok{uboat\_raw }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(fate\_type, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{name =} \StringTok{"대수"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fate\_kor =} \FunctionTok{c}\NormalTok{(}\StringTok{"침몰"}\NormalTok{, }\StringTok{"자침"}\NormalTok{, }\StringTok{"항복"}\NormalTok{, }\StringTok{"해체"}\NormalTok{, }\StringTok{"실종"}\NormalTok{, }\StringTok{"기증"}\NormalTok{, }\StringTok{"손상"}\NormalTok{, }\StringTok{"포획"}\NormalTok{, }\StringTok{"좌초"}\NormalTok{, }\StringTok{"파괴"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(비율 }\OtherTok{=}\NormalTok{ 대수 }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(대수)) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{relocate}\NormalTok{(fate\_kor, }\AttributeTok{.after =}\NormalTok{ fate\_type) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}}   
    \FunctionTok{cols\_label}\NormalTok{(}
        \AttributeTok{fate\_type =} \FunctionTok{md}\NormalTok{(}\StringTok{"**fate type**"}\NormalTok{),}
        \AttributeTok{fate\_kor =} \FunctionTok{md}\NormalTok{(}\StringTok{"**유보트 운명**"}\NormalTok{),}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{grand\_summary\_rows}\NormalTok{(}
      \AttributeTok{columns =}\NormalTok{ 대수,}
      \AttributeTok{fns =}  \FunctionTok{list}\NormalTok{(}\AttributeTok{label =} \StringTok{"합계"}\NormalTok{, }\AttributeTok{id=}\StringTok{\textquotesingle{}totals\textquotesingle{}}\NormalTok{, }\AttributeTok{fn =} \StringTok{"sum"}\NormalTok{),}
      \AttributeTok{fmt =} \SpecialCharTok{\textasciitilde{}} \FunctionTok{fmt\_integer}\NormalTok{(.),}
      \AttributeTok{side =} \StringTok{"bottom"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{grand\_summary\_rows}\NormalTok{(}
      \AttributeTok{columns =}\NormalTok{ 비율,}
      \AttributeTok{fns =}  \FunctionTok{list}\NormalTok{(}\AttributeTok{label =} \StringTok{"합계"}\NormalTok{, }\AttributeTok{fn =} \StringTok{"sum"}\NormalTok{),}
      \AttributeTok{fmt =} \SpecialCharTok{\textasciitilde{}} \FunctionTok{fmt\_percent}\NormalTok{(., }\AttributeTok{decimals =} \DecValTok{0}\NormalTok{),}
      \AttributeTok{side =} \StringTok{"bottom"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_percent}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ 비율, }\AttributeTok{decimals =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{tab\_header}\NormalTok{(}
      \AttributeTok{title =} \StringTok{"유보트 유형별 운명"}\NormalTok{,}
      \AttributeTok{subtitle =} \StringTok{"자료출처: uboat.net"}
\NormalTok{    )}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{l|cccc}
\caption*{
{\large 유보트 유형별 운명} \\ 
{\small 자료출처: uboat.net}
} \\ 
\toprule
\multicolumn{1}{l}{} & \textbf{fate type} & \textbf{유보트 운명} & 대수 & 비율 \\ 
\midrule
 & Sunk & 침몰 & 640 & $55.5\%$ \\ 
 & Scuttled & 자침 & 218 & $18.9\%$ \\ 
 & Surrendered & 항복 & 154 & $13.4\%$ \\ 
 & Decommissioned & 해체 & 55 & $4.8\%$ \\ 
 & Missing & 실종 & 46 & $4.0\%$ \\ 
 & Given & 기증 & 16 & $1.4\%$ \\ 
 & Damaged & 손상 & 12 & $1.0\%$ \\ 
 & Captured & 포획 & 5 & $0.4\%$ \\ 
 & Grounded & 좌초 & 4 & $0.3\%$ \\ 
 & Destroyed & 파괴 & 3 & $0.3\%$ \\ 
\midrule 
\midrule 
합계 & — & — & $1,153$ & $100\%$ \\ 
\bottomrule
\end{longtable*}

\hypertarget{uxc720uxbcf4uxd2b8-uxc131uxacfc}{%
\subsection{유보트 성과}\label{uxc720uxbcf4uxd2b8-uxc131uxacfc}}

유보트가 침몰시킨 선박수(\texttt{ships\_sunk}) 정보가 담겨있어 이를
바탕으로 활동성과를 분석해보자.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uboat\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ uboat\_raw }\SpecialCharTok{|\textgreater{}} 
  \CommentTok{\# filter( fate\_type == "Sunk") |\textgreater{} }
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fate\_date =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{mdy}\NormalTok{(fate)) }

\NormalTok{uboat\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(fate\_type) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(침몰선박수 }\OtherTok{=} \FunctionTok{sum}\NormalTok{(ships\_sunk),}
\NormalTok{            유보트수 }\OtherTok{=} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(비율 }\OtherTok{=}\NormalTok{ 침몰선박수 }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(침몰선박수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(침몰선박수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(fate\_translation) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(fate\_type\_kor, }\AttributeTok{.after =}\NormalTok{ fate\_type) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(유보트수, }\AttributeTok{.after =}\NormalTok{ fate\_type\_kor) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  gt}\SpecialCharTok{::}\FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  gt}\SpecialCharTok{::}\FunctionTok{tab\_header}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"유보트 운명유형별 침몰선박수"}\NormalTok{, }
    \AttributeTok{subtitle =} \StringTok{"자료출처: uboat.net"}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_label}\NormalTok{(}
        \AttributeTok{fate\_type =} \FunctionTok{md}\NormalTok{(}\StringTok{"**fate type**"}\NormalTok{),}
        \AttributeTok{fate\_type\_kor =} \FunctionTok{md}\NormalTok{(}\StringTok{"**유보트 운명**"}\NormalTok{),}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{grand\_summary\_rows}\NormalTok{(}
      \AttributeTok{columns =}\NormalTok{ 침몰선박수,}
      \AttributeTok{fns =}  \FunctionTok{list}\NormalTok{(}\AttributeTok{label =} \StringTok{"합계"}\NormalTok{, }\AttributeTok{id=}\StringTok{\textquotesingle{}totals\textquotesingle{}}\NormalTok{, }\AttributeTok{fn =} \StringTok{"sum"}\NormalTok{),}
      \AttributeTok{fmt =} \SpecialCharTok{\textasciitilde{}} \FunctionTok{fmt\_integer}\NormalTok{(.),}
      \AttributeTok{side =} \StringTok{"bottom"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{grand\_summary\_rows}\NormalTok{(}
      \AttributeTok{columns =}\NormalTok{ 비율,}
      \AttributeTok{fns =}  \FunctionTok{list}\NormalTok{(}\AttributeTok{label =} \StringTok{"합계"}\NormalTok{, }\AttributeTok{fn =} \StringTok{"sum"}\NormalTok{),}
      \AttributeTok{fmt =} \SpecialCharTok{\textasciitilde{}} \FunctionTok{fmt\_percent}\NormalTok{(., }\AttributeTok{decimals =} \DecValTok{0}\NormalTok{),}
      \AttributeTok{side =} \StringTok{"bottom"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_percent}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ 비율, }\AttributeTok{decimals =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_integer}\NormalTok{(침몰선박수) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"침몰선박"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(침몰선박수, 비율))}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{l|ccccc}
\caption*{
{\large 유보트 운명유형별 침몰선박수} \\ 
{\small 자료출처: uboat.net}
} \\ 
\toprule
\multicolumn{1}{l}{} &  &  &  & \multicolumn{2}{c}{침몰선박} \\ 
\cmidrule(lr){5-6}
\multicolumn{1}{l}{} & \textbf{fate type} & \textbf{유보트 운명} & 유보트수 & 침몰선박수 & 비율 \\ 
\midrule
 & Sunk & 침몰 & 640 & $1,809$ & $65.8\%$ \\ 
 & Decommissioned & 해체 & 55 & $373$ & $13.6\%$ \\ 
 & Scuttled & 자침 & 218 & $265$ & $9.6\%$ \\ 
 & Surrendered & 항복 & 154 & $131$ & $4.8\%$ \\ 
 & Missing & 실종 & 46 & $101$ & $3.7\%$ \\ 
 & Given & 기증 & 16 & $41$ & $1.5\%$ \\ 
 & Damaged & 손상 & 12 & $16$ & $0.6\%$ \\ 
 & Captured & 포획 & 5 & $12$ & $0.4\%$ \\ 
 & Destroyed & 파괴 & 3 & $2$ & $0.1\%$ \\ 
 & Grounded & 좌초 & 4 & $1$ & $0.0\%$ \\ 
\midrule 
\midrule 
합계 & — & — & — & $2,751$ & $100\%$ \\ 
\bottomrule
\end{longtable*}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# extrafont::font\_import(pattern = "NanumSquare", prompt = FALSE)}
\NormalTok{extrafont}\SpecialCharTok{::}\FunctionTok{loadfonts}\NormalTok{()}

\NormalTok{uboat\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{fate\_yearmon =} \FunctionTok{floor\_date}\NormalTok{(fate\_date, }\StringTok{"month"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(fate\_yearmon) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(침몰선박수 }\OtherTok{=} \FunctionTok{sum}\NormalTok{(ships\_sunk)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(침몰선박수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ fate\_yearmon, }\AttributeTok{y =}\NormalTok{ 침몰선박수)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =}\StringTok{""}\NormalTok{,}
         \AttributeTok{title =} \StringTok{"월별 유보트 침몰선박수"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{u_boats_files/figure-pdf/unnamed-chunk-5-1.pdf}

}

\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(giscoR)}
\FunctionTok{library}\NormalTok{(sf)}

\NormalTok{world }\OtherTok{\textless{}{-}} \FunctionTok{gisco\_get\_countries}\NormalTok{()}

\NormalTok{sunk\_sf }\OtherTok{\textless{}{-}}\NormalTok{ uboat\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(fate\_type  }\SpecialCharTok{==} \StringTok{"Sunk"}\NormalTok{)  }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sunk\_year =} \FunctionTok{year}\NormalTok{(fate\_date)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(name, fat\_lon, fate\_lat, sunk\_year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\FunctionTok{across}\NormalTok{(fat\_lon}\SpecialCharTok{:}\NormalTok{fate\_lat, as.numeric)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sunk\_year =} \FunctionTok{as.factor}\NormalTok{(sunk\_year)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{drop\_na}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{st\_as\_sf}\NormalTok{(}\AttributeTok{coords =} \FunctionTok{c}\NormalTok{(}\StringTok{"fat\_lon"}\NormalTok{, }\StringTok{"fate\_lat"}\NormalTok{), }\AttributeTok{crs =}\NormalTok{ sf}\SpecialCharTok{::}\FunctionTok{st\_crs}\NormalTok{(world))}

\NormalTok{sunk\_sf }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{sunk\_year =} \FunctionTok{case\_when}\NormalTok{(sunk\_year }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1939}\NormalTok{, }\DecValTok{1940}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"1939{-}40"}\NormalTok{,}
                   \ConstantTok{TRUE} \SpecialCharTok{\textasciitilde{}}\NormalTok{ sunk\_year)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_sf}\NormalTok{(}\AttributeTok{size =} \FloatTok{0.5}\NormalTok{, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ sunk\_year)) }\SpecialCharTok{+}
    \FunctionTok{geom\_sf}\NormalTok{(}\AttributeTok{data =}\NormalTok{ world) }\SpecialCharTok{+}
    \FunctionTok{facet\_wrap}\NormalTok{( }\SpecialCharTok{\textasciitilde{}}\NormalTok{ sunk\_year ) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"연도별 침몰 유보트 좌표"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{u_boats_files/figure-pdf/unnamed-chunk-6-1.pdf}

}

\end{figure}

\hypertarget{uxbaa9uxd45cuxc120uxbc15-uxb370uxc774uxd130}{%
\section{목표선박
데이터}\label{uxbaa9uxd45cuxc120uxbc15-uxb370uxc774uxd130}}

GitHub 저장소에 침몰선박에 대한 정보도 확인해보자.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{download.file}\NormalTok{(}\AttributeTok{url =} \StringTok{"https://raw.githubusercontent.com/kadenhendron/uboat{-}data/master/data/uboat{-}target{-}data.csv"}\NormalTok{, }
              \AttributeTok{destfile =} \StringTok{"data/uboat{-}target{-}data.csv"}\NormalTok{, }\AttributeTok{model =} \StringTok{"w"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

국적별 총 침몰선박수를 표로 작성한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(gt)}
\FunctionTok{library}\NormalTok{(gtExtras)}
\FunctionTok{library}\NormalTok{(countrycode)}

\NormalTok{target\_raw }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/uboat{-}target{-}data.csv"}\NormalTok{)}

\NormalTok{target\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ target\_raw }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{attack\_date =}\NormalTok{ lubridate}\SpecialCharTok{::}\FunctionTok{mdy}\NormalTok{(attack\_date)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{yearmon =} \FunctionTok{floor\_date}\NormalTok{(attack\_date, }\StringTok{"month"}\NormalTok{)) }

\NormalTok{ships\_nationality }\OtherTok{\textless{}{-}}\NormalTok{ target\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{nationality =} \FunctionTok{fct\_lump}\NormalTok{(nationality, }\AttributeTok{n =} \DecValTok{9}\NormalTok{, }\AttributeTok{other\_level =} \StringTok{"기타국가"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(nationality) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(선박수 }\OtherTok{=} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(선박수))}

\NormalTok{top10\_iso }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\StringTok{"nationality"}\NormalTok{, }\SpecialCharTok{\textasciitilde{}}\StringTok{"iso3c"}\NormalTok{, }\SpecialCharTok{\textasciitilde{}}\StringTok{"country\_name"}\NormalTok{, }\SpecialCharTok{\textasciitilde{}}\StringTok{"country\_name\_kr"}\NormalTok{,}
\StringTok{"British"}\NormalTok{, }\StringTok{"GBR"}\NormalTok{,  }\StringTok{"United Kingdom"}\NormalTok{, }\StringTok{"영국"}\NormalTok{,}
\StringTok{"American"}\NormalTok{, }\StringTok{"USA"}\NormalTok{,  }\StringTok{"United States"}\NormalTok{, }\StringTok{"미국"}\NormalTok{,}
\StringTok{"기타국가"}\NormalTok{, }\StringTok{""}\NormalTok{, }\StringTok{"ETC"}\NormalTok{, }\StringTok{"기타"}\NormalTok{,}
\StringTok{"Norwegian"}\NormalTok{, }\StringTok{"NOR"}\NormalTok{,  }\StringTok{"Norway"}\NormalTok{, }\StringTok{"노르웨이"}\NormalTok{,}
\StringTok{"Dutch"}\NormalTok{, }\StringTok{"NLD"}\NormalTok{,  }\StringTok{"Denmark"}\NormalTok{, }\StringTok{"덴마크"}\NormalTok{, }\CommentTok{\# 주의: Dutch는 네덜란드 사람을 나타내며, Denmark는 덴마크를 의미합니다.}
\StringTok{"Greek"}\NormalTok{, }\StringTok{"GRC"}\NormalTok{,  }\StringTok{"Greece"}\NormalTok{, }\StringTok{"그리스"}\NormalTok{,}
\StringTok{"Soviet"}\NormalTok{, }\StringTok{"SUN"}\NormalTok{, }\StringTok{"Russia"}\NormalTok{, }\StringTok{"러시아"}\NormalTok{, }\CommentTok{\# 주의: Soviet는 소비에트 연방을 나타냅니다. 현대의 러시아와는 다름니다.}
\StringTok{"Swedish"}\NormalTok{, }\StringTok{"SWE"}\NormalTok{,  }\StringTok{"Sweden"}\NormalTok{, }\StringTok{"스웨덴"}\NormalTok{,}
\StringTok{"Panamanian"}\NormalTok{, }\StringTok{"PAN"}\NormalTok{,  }\StringTok{"Panama"}\NormalTok{, }\StringTok{"파나마"}\NormalTok{,}
\StringTok{"Canadian"}\NormalTok{, }\StringTok{"CAN"}\NormalTok{,  }\StringTok{"Canada"}\NormalTok{, }\StringTok{"캐나다"}\NormalTok{)}

\NormalTok{target\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{nationality =} \FunctionTok{fct\_lump}\NormalTok{(nationality, }\AttributeTok{n =} \DecValTok{9}\NormalTok{, }\AttributeTok{other\_level =} \StringTok{"기타국가"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(nationality, yearmon) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(선박수 }\OtherTok{=} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(nationality) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{ships\_data =} \FunctionTok{list}\NormalTok{(선박수)) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{left\_join}\NormalTok{(ships\_nationality) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(선박수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(top10\_iso) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{iso\_2 =} \FunctionTok{countrycode}\NormalTok{(country\_name, }\AttributeTok{origin =} \StringTok{"country.name"}\NormalTok{, }\StringTok{"iso2c"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(iso\_2, }\AttributeTok{.before =}\NormalTok{ nationality) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(iso\_2, 국가명 }\OtherTok{=}\NormalTok{ country\_name\_kr, 선박수, ships\_data) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(비율 }\OtherTok{=}\NormalTok{ 선박수 }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(선박수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(비율, }\AttributeTok{.after =}\NormalTok{ 선박수) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
\NormalTok{    gtExtras}\SpecialCharTok{::}\FunctionTok{gt\_plt\_sparkline}\NormalTok{(ships\_data) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_flag}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ iso\_2) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_label}\NormalTok{(}
      \AttributeTok{iso\_2 =} \StringTok{""}\NormalTok{,}
\NormalTok{      선박수 }\OtherTok{=} \StringTok{"총 침몰선박수"}\NormalTok{,}
      \AttributeTok{ships\_data =} \StringTok{"월별 선박침몰"}
\NormalTok{    )  }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
\NormalTok{    gt}\SpecialCharTok{::}\FunctionTok{tab\_header}\NormalTok{(}
      \AttributeTok{title =} \StringTok{"국가별 피해 침몰선박수"}\NormalTok{, }
      \AttributeTok{subtitle =} \StringTok{"자료출처: uboat.net"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
      \FunctionTok{grand\_summary\_rows}\NormalTok{(}
        \AttributeTok{columns =}\NormalTok{ 선박수,}
        \AttributeTok{fns =}  \FunctionTok{list}\NormalTok{(}\AttributeTok{label =} \StringTok{"합계"}\NormalTok{, }\AttributeTok{id=}\StringTok{\textquotesingle{}totals\textquotesingle{}}\NormalTok{, }\AttributeTok{fn =} \StringTok{"sum"}\NormalTok{),}
        \AttributeTok{fmt =} \SpecialCharTok{\textasciitilde{}} \FunctionTok{fmt\_integer}\NormalTok{(.),}
        \AttributeTok{side =} \StringTok{"bottom"}
\NormalTok{      ) }\SpecialCharTok{|\textgreater{}} 
      \FunctionTok{grand\_summary\_rows}\NormalTok{(}
        \AttributeTok{columns =}\NormalTok{ 비율,}
        \AttributeTok{fns =}  \FunctionTok{list}\NormalTok{(}\AttributeTok{label =} \StringTok{"합계"}\NormalTok{, }\AttributeTok{fn =} \StringTok{"sum"}\NormalTok{),}
        \AttributeTok{fmt =} \SpecialCharTok{\textasciitilde{}} \FunctionTok{fmt\_percent}\NormalTok{(., }\AttributeTok{decimals =} \DecValTok{0}\NormalTok{),}
        \AttributeTok{side =} \StringTok{"bottom"}
\NormalTok{      ) }\SpecialCharTok{|\textgreater{}} 
      \FunctionTok{fmt\_percent}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ 비율, }\AttributeTok{decimals =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
      \FunctionTok{fmt\_integer}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ 선박수) }\SpecialCharTok{|\textgreater{}} 
      \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{      gt}\SpecialCharTok{::}\FunctionTok{fmt\_missing}\NormalTok{(}\AttributeTok{missing\_text =} \StringTok{"{-}"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{l|ccccc}
\caption*{
{\large 국가별 피해 침몰선박수} \\ 
{\small 자료출처: uboat.net}
} \\ 
\toprule
\multicolumn{1}{l}{} &  & 국가명 & 총 침몰선박수 & 비율 & 월별 선박침몰 \\ 
\midrule
 & GB & 영국 & $1,655$ & $47.9\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.77' y='13.82' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>2.0</text><polyline points='4.55,7.30 5.46,9.54 6.37,9.96 7.29,9.82 8.20,10.52 9.11,9.82 10.02,11.36 10.93,11.78 11.85,11.36 12.76,8.70 13.67,9.40 14.58,6.74 15.50,6.32 16.41,5.90 17.32,8.98 18.23,7.86 19.14,10.80 20.06,7.72 20.97,8.28 21.88,7.86 22.79,5.90 23.71,7.58 24.62,10.38 25.53,9.54 26.44,6.46 27.35,7.72 28.27,10.52 29.18,10.24 30.09,8.84 31.00,8.14 31.92,7.58 32.83,9.12 33.74,6.74 34.65,7.30 35.56,7.16 36.48,4.92 37.39,5.76 38.30,2.54 39.21,1.84 40.13,5.06 41.04,9.82 41.95,7.72 42.86,3.10 43.77,8.00 44.69,9.26 45.60,11.08 46.51,8.84 47.42,11.22 48.33,11.36 49.25,10.66 50.16,11.50 51.07,11.36 51.98,10.80 52.90,9.96 53.81,10.94 54.72,12.20 55.63,11.50 56.54,11.78 57.46,10.94 58.37,9.68 59.28,11.64 60.19,11.92 61.11,11.50 62.02,11.36 62.93,10.80 63.84,11.36 64.75,11.08 65.67,12.20 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.67' cy='12.20' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='54.72' cy='12.20' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.67' cy='12.20' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='39.21' cy='1.84' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & US & 미국 & $549$ & $15.9\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.75' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='4.95,12.34 6.39,11.92 7.84,12.20 9.28,11.08 10.73,9.68 12.17,7.44 13.62,8.14 15.06,5.62 16.51,5.34 17.95,7.86 19.40,9.82 20.84,10.38 22.29,9.54 23.73,8.42 25.18,12.06 26.62,10.80 28.07,9.40 29.51,7.44 30.96,10.94 32.40,11.08 33.85,11.50 35.29,9.82 36.74,11.78 38.18,11.22 39.63,11.50 41.07,12.20 42.52,11.64 43.96,11.64 45.41,11.92 46.85,11.64 48.30,11.92 49.74,11.64 51.19,11.64 52.63,11.92 54.08,11.50 55.52,12.06 56.97,12.20 58.41,11.64 59.86,11.64 61.30,11.64 62.75,11.78 64.19,11.50 65.64,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.64' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='4.95' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.64' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='16.51' cy='5.34' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & - & 기타 & $342$ & $9.9\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.77' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='4.60,11.36 5.59,11.50 6.57,11.50 7.56,11.22 8.54,10.94 9.53,10.66 10.51,10.94 11.50,12.20 12.48,11.50 13.47,10.80 14.45,11.78 15.44,12.06 16.42,11.92 17.41,12.34 18.39,12.34 19.38,11.64 20.36,12.34 21.35,12.34 22.33,11.92 23.32,12.06 24.30,11.64 25.29,11.78 26.27,12.20 27.25,12.34 28.24,12.20 29.22,12.34 30.21,11.64 31.19,11.92 32.18,11.92 33.16,11.36 34.15,11.36 35.13,10.66 36.12,9.26 37.10,10.24 38.09,9.82 39.07,10.38 40.06,11.78 41.04,12.06 42.03,11.64 43.01,11.78 44.00,11.22 44.98,11.22 45.97,11.78 46.95,11.92 47.94,11.78 48.92,11.92 49.91,11.92 50.89,12.20 51.88,12.06 52.86,11.92 53.85,12.34 54.83,11.78 55.81,12.34 56.80,12.34 57.78,12.20 58.77,12.34 59.75,12.34 60.74,11.64 61.72,12.34 62.71,12.34 63.69,12.20 64.68,12.20 65.66,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.66' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='17.41' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='18.39' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='20.36' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='21.35' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='27.25' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='29.22' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='53.85' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='55.81' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='56.80' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='58.77' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='59.75' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='61.72' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='62.71' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.66' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='36.12' cy='9.26' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & NO & 노르웨이 & $311$ & $9.0\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.76' y='13.82' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>2.0</text><polyline points='4.68,12.20 5.77,12.34 6.86,12.20 7.95,11.36 9.04,9.96 10.13,11.50 11.22,12.34 12.30,12.06 13.39,11.50 14.48,12.20 15.57,11.92 16.66,11.64 17.75,11.50 18.84,12.06 19.93,12.06 21.01,12.34 22.10,11.64 23.19,11.92 24.28,11.78 25.37,11.92 26.46,11.78 27.55,12.34 28.64,11.92 29.73,11.50 30.81,11.92 31.90,12.06 32.99,10.94 34.08,10.80 35.17,11.22 36.26,11.22 37.35,10.66 38.44,10.10 39.53,11.36 40.61,11.08 41.70,11.08 42.79,11.36 43.88,11.08 44.97,11.78 46.06,11.50 47.15,10.52 48.24,11.50 49.33,12.06 50.41,11.64 51.50,12.20 52.59,12.34 53.68,12.06 54.77,11.78 55.86,12.06 56.95,12.34 58.04,12.06 59.12,12.34 60.21,12.34 61.30,11.78 62.39,12.20 63.48,12.20 64.57,12.06 65.66,12.20 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.66' cy='12.20' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='5.77' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='11.22' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='21.01' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='27.55' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='52.59' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='56.95' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='59.12' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='60.21' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='9.04' cy='9.96' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & DK & 덴마크 & $137$ & $4.0\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.75' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='4.95,12.34 6.39,12.34 7.84,12.34 9.28,12.34 10.73,11.78 12.17,11.92 13.62,12.06 15.06,12.06 16.51,12.20 17.95,12.20 19.40,11.92 20.84,12.20 22.29,12.20 23.73,12.20 25.18,11.78 26.62,12.20 28.07,11.92 29.51,11.50 30.96,12.34 32.40,12.20 33.85,12.20 35.29,12.06 36.74,12.34 38.18,12.06 39.63,11.36 41.07,11.78 42.52,12.06 43.96,10.66 45.41,11.92 46.85,12.06 48.30,11.50 49.74,11.92 51.19,11.92 52.63,11.36 54.08,11.92 55.52,12.34 56.97,12.20 58.41,12.20 59.86,12.34 61.30,12.34 62.75,12.20 64.19,12.34 65.64,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.64' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='4.95' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='6.39' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='7.84' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='9.28' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='30.96' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='36.74' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='55.52' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='59.86' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='61.30' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='64.19' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.64' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='43.96' cy='10.66' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & GR & 그리스 & $122$ & $3.5\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.75' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='4.92,11.92 6.34,12.34 7.75,12.20 9.16,11.78 10.57,12.34 11.98,12.34 13.40,12.34 14.81,10.94 16.22,11.78 17.63,11.92 19.04,12.06 20.46,11.78 21.87,12.20 23.28,12.34 24.69,12.34 26.10,12.34 27.52,12.20 28.93,12.20 30.34,11.50 31.75,12.34 33.17,12.20 34.58,11.78 35.99,12.34 37.40,12.06 38.81,12.34 40.23,11.92 41.64,12.34 43.05,12.06 44.46,12.06 45.87,11.92 47.29,12.06 48.70,11.22 50.11,12.20 51.52,12.20 52.93,12.06 54.35,12.20 55.76,12.06 57.17,12.20 58.58,12.06 59.99,12.34 61.41,12.34 62.82,12.20 64.23,12.34 65.64,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.64' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='6.34' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='10.57' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='11.98' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='13.40' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='23.28' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='24.69' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='26.10' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='31.75' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='35.99' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='38.81' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='41.64' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='59.99' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='61.41' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='64.23' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.64' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='14.81' cy='10.94' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & RU & 러시아 & $106$ & $3.1\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.74' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='5.13,12.20 6.81,12.34 8.49,11.78 10.17,12.20 11.85,12.34 13.53,12.34 15.21,12.20 16.89,12.34 18.57,12.20 20.25,12.34 21.93,12.34 23.61,11.36 25.29,12.34 26.97,12.20 28.65,12.34 30.34,12.20 32.02,12.20 33.70,12.34 35.38,12.34 37.06,11.92 38.74,11.22 40.42,12.20 42.10,11.78 43.78,12.20 45.46,12.34 47.14,12.20 48.82,12.06 50.50,12.06 52.18,11.36 53.86,11.50 55.54,12.06 57.23,12.20 58.91,12.06 60.59,11.22 62.27,12.06 63.95,12.20 65.63,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.63' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='6.81' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='11.85' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='13.53' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='16.89' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='20.25' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='21.93' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='25.29' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='28.65' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='33.70' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='35.38' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='45.46' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.63' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='38.74' cy='11.22' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /><circle cx='60.59' cy='11.22' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & SE & 스웨덴 & $89$ & $2.6\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.74' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='5.09,11.78 6.73,12.20 8.36,12.34 10.00,11.64 11.64,11.22 13.27,11.50 14.91,12.34 16.55,12.34 18.18,12.34 19.82,12.34 21.45,12.20 23.09,11.64 24.73,12.34 26.36,12.06 28.00,12.20 29.63,11.92 31.27,12.20 32.91,11.92 34.54,12.34 36.18,12.34 37.82,12.34 39.45,12.34 41.09,12.06 42.72,12.34 44.36,12.34 46.00,12.20 47.63,12.34 49.27,12.34 50.91,12.06 52.54,12.20 54.18,12.20 55.81,12.20 57.45,12.20 59.09,12.20 60.72,12.34 62.36,12.34 63.99,12.20 65.63,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.63' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='8.36' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='14.91' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='16.55' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='18.18' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='19.82' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='24.73' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='34.54' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='36.18' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='37.82' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='39.45' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='42.72' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='44.36' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='47.63' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='49.27' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='60.72' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='62.36' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.63' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='11.64' cy='11.22' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & PA & 파나마 & $81$ & $2.3\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.73' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='5.32,12.34 7.27,12.34 9.21,12.34 11.16,12.34 13.10,12.34 15.05,12.34 16.99,11.92 18.94,12.34 20.88,12.20 22.83,11.92 24.77,11.78 26.72,11.92 28.66,11.78 30.61,11.78 32.55,11.36 34.50,11.50 36.44,12.20 38.39,11.78 40.33,12.06 42.28,11.92 44.22,12.34 46.17,12.20 48.11,12.06 50.06,12.20 52.00,12.34 53.95,12.34 55.89,12.34 57.84,12.34 59.78,12.34 61.73,12.34 63.67,12.34 65.61,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.61' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='5.32' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='7.27' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='9.21' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='11.16' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='13.10' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='15.05' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='18.94' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='44.22' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='52.00' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='53.95' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='55.89' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='57.84' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='59.78' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='61.73' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='63.67' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.61' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='32.55' cy='11.36' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
 & CA & 캐나다 & $66$ & $1.9\%$ & <?xml version='1.0' encoding='UTF-8' ?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='svglite' width='85.04pt' height='14.17pt' viewBox='0 0 85.04 14.17'><defs>  <style type='text/css'><![CDATA[    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {      fill: none;      stroke: #000000;      stroke-linecap: round;      stroke-linejoin: round;      stroke-miterlimit: 10.00;    }    .svglite text {      white-space: pre;    }  ]]></style></defs><rect width='100%' height='100%' style='stroke: none; fill: none;'/><defs>  <clipPath id='cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3'>    <rect x='0.00' y='0.00' width='85.04' height='14.17' />  </clipPath></defs><g clip-path='url(#cpMC4wMHw4NS4wNHwwLjAwfDE0LjE3)'><text x='68.73' y='13.96' style='font-size: 5.69px; font-family: "Arial";' textLength='10.24px' lengthAdjust='spacingAndGlyphs'>1.0</text><polyline points='5.20,12.34 6.98,12.34 8.75,12.34 10.53,12.20 12.31,12.34 14.08,12.34 15.86,12.34 17.64,12.34 19.42,12.34 21.19,12.20 22.97,11.78 24.75,12.20 26.52,12.34 28.30,11.22 30.08,12.34 31.86,12.20 33.63,12.34 35.41,11.36 37.19,12.20 38.97,12.20 40.74,12.34 42.52,12.34 44.30,12.34 46.07,12.34 47.85,12.34 49.63,12.34 51.41,12.20 53.18,12.20 54.96,12.34 56.74,12.06 58.51,12.34 60.29,12.20 62.07,12.20 63.85,12.34 65.62,12.34 ' style='stroke-width: 1.07; stroke-linecap: butt;' /><circle cx='65.62' cy='12.34' r='0.89' style='stroke-width: 0.71; fill: #000000;' /><circle cx='5.20' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='6.98' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='8.75' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='12.31' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='14.08' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='15.86' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='17.64' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='19.42' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='26.52' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='30.08' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='33.63' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='40.74' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='42.52' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='44.30' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='46.07' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='47.85' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='49.63' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='54.96' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='58.51' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='63.85' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='65.62' cy='12.34' r='0.89' style='stroke-width: 0.71; stroke: #A020F0; fill: #A020F0;' /><circle cx='28.30' cy='11.22' r='0.89' style='stroke-width: 0.71; stroke: #00FF00; fill: #00FF00;' /></g></svg> \\ 
\midrule 
\midrule 
합계 & — & — & $3,458$ & $100\%$ & — \\ 
\bottomrule
\end{longtable*}

\hypertarget{uxc720uxbcf4uxd2b8-uxc0acuxb839uxad00}{%
\section{유보트 사령관}\label{uxc720uxbcf4uxd2b8-uxc0acuxb839uxad00}}

{\marginnote{\begin{footnotesize}\href{https://bjnnowak.netlify.app/2021/10/04/r-beautiful-tables-with-gt-and-gtextras/}{Riding
tables with \{gt\} and \{gtExtras\}}\end{footnotesize}}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{commander\_uboat }\OtherTok{\textless{}{-}}\NormalTok{ target\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(commander, name) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(commander) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(잠수함 }\OtherTok{=} \FunctionTok{str\_c}\NormalTok{(name, }\AttributeTok{collapse =} \StringTok{","}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(잠수함 }\OtherTok{=} \FunctionTok{str\_split}\NormalTok{(잠수함, }\AttributeTok{pattern =} \StringTok{","}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest}\NormalTok{(잠수함) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(commander) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(잠수함 }\OtherTok{=} \FunctionTok{str\_c}\NormalTok{(잠수함, }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{))}

\NormalTok{target\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(commander) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(선박수 }\OtherTok{=} \FunctionTok{n}\NormalTok{(),}
\NormalTok{            사망자수 }\OtherTok{=} \FunctionTok{sum}\NormalTok{(dead, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\NormalTok{            톤수 }\OtherTok{=} \FunctionTok{sum}\NormalTok{(tonnage, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(선박수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(선박수\_그래프 }\OtherTok{=}\NormalTok{ 선박수) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(commander\_uboat) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{slice\_max}\NormalTok{(}\AttributeTok{order\_by =}\NormalTok{ 선박수, }\AttributeTok{n =} \DecValTok{10}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \CommentTok{\# 시각화 }
\NormalTok{  gt}\SpecialCharTok{::}\FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_label}\NormalTok{(}
      \AttributeTok{commander =} \StringTok{"유보트 선장"}\NormalTok{,}
\NormalTok{      선박수 }\OtherTok{=} \StringTok{"선박수"}\NormalTok{,}
\NormalTok{      잠수함 }\OtherTok{=} \StringTok{"탑승 잠수함"}\NormalTok{,}
\NormalTok{      선박수\_그래프 }\OtherTok{=} \StringTok{"그래프"}
\NormalTok{    )  }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_hangul}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
\NormalTok{    gt}\SpecialCharTok{::}\FunctionTok{tab\_header}\NormalTok{(}
      \AttributeTok{title =} \StringTok{"상위 10 유보트 선장"}\NormalTok{, }
      \AttributeTok{subtitle =} \StringTok{"자료출처: uboat.net"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{    gtExtras}\SpecialCharTok{::}\FunctionTok{gt\_merge\_stack}\NormalTok{(}\AttributeTok{col1 =}\NormalTok{ commander, }\AttributeTok{col2 =}\NormalTok{ 잠수함) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_width}\NormalTok{(}
\NormalTok{      commander }\SpecialCharTok{\textasciitilde{}} \FunctionTok{px}\NormalTok{(}\DecValTok{130}\NormalTok{),}
\NormalTok{      선박수\_그래프 }\SpecialCharTok{\textasciitilde{}} \FunctionTok{px}\NormalTok{(}\DecValTok{100}\NormalTok{)}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{fmt\_integer}\NormalTok{(}\AttributeTok{columns =}\NormalTok{ is.numeric) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_plt\_bar\_pct}\NormalTok{(}\AttributeTok{column =}\NormalTok{ 선박수\_그래프, }\AttributeTok{scaled =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{fill =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{background =} \StringTok{"lightblue"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{    gt}\SpecialCharTok{::}\FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"총 침몰선박"}\NormalTok{, }\AttributeTok{columns =} \FunctionTok{c}\NormalTok{(선박수, 선박수\_그래프)) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{ccccc}
\caption*{
{\large 상위 10 유보트 선장} \\ 
{\small 자료출처: uboat.net}
} \\ 
\toprule
 & \multicolumn{2}{c}{총 침몰선박} &  &  \\ 
\cmidrule(lr){2-3}
유보트 선장 & 선박수 & 그래프 & 사망자수 & 톤수 \\ 
\midrule
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Otto Kretschmer</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-23, U-99</span></div> & $56$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $846$ & $355,371$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Wolfgang L<fc>th</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-138, U-181, U-43, U-9</span></div> & $49$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $1,097$ & $243,099$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Joachim Schepke</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-100, U-19, U-3</span></div> & $40$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $468$ & $169,690$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Erich Topp</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-552, U-57</span></div> & $39$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $848$ & $217,286$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Heinrich Liebe</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-38</span></div> & $35$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $418$ & $200,090$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Viktor Sch<fc>tze</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-103, U-25</span></div> & $35$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $780$ & $180,073$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Georg Lassen</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-160</span></div> & $33$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $343$ & $205,843$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>G<fc>nther Prien</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-47</span></div> & $33$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $1,945$ & $197,376$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Johann Mohr</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-124</span></div> & $32$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $978$ & $153,031$ \\ 
<div style='line-height:14px'><span style='font-weight:bold;font-variant:small-caps;color:#000000;font-size:14px'>Ernst Bauer</div>
<div style='line-height:10px'><span style ='font-weight:bold;color:#BEBEBE;font-size:10px'>U-126</span></div> & $29$ & <div style='flex-grow:1;margin-left:8px;background:lightblue;'><div style='background:blue;width:0%;height:16px;'></div></div> & $196$ & $142,021$ \\ 
\bottomrule
\end{longtable*}

\hypertarget{uxc720uxbcf4uxd2b8uxc640-uxc120uxbc15}{%
\section{유보트와 선박}\label{uxc720uxbcf4uxd2b8uxc640-uxc120uxbc15}}

침몰된 선박과 유보트 손실을 월별 시각화를 통해서 1943년을 기점으로
유보트에 대한 연합국의 대응이 효과를 발휘하여 선박손실을 급격히 줄어든
반면 유보트 손실이 급격히 올라간 것을 확인할 수 있다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{uboat\_yearmon }\OtherTok{\textless{}{-}}\NormalTok{ uboat\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(년월 }\OtherTok{=} \FunctionTok{floor\_date}\NormalTok{(fate\_date, }\StringTok{"month"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(년월) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(유보트수 }\OtherTok{=} \FunctionTok{n}\NormalTok{())}

\NormalTok{target\_yearmon }\OtherTok{\textless{}{-}}\NormalTok{ target\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(년월 }\OtherTok{=} \FunctionTok{floor\_date}\NormalTok{(attack\_date, }\StringTok{"month"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(년월) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(침몰수 }\OtherTok{=} \FunctionTok{n}\NormalTok{()) }

\NormalTok{uboat\_yearmon }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(target\_yearmon) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =}\NormalTok{ 유보트수}\SpecialCharTok{:}\NormalTok{침몰수, }\AttributeTok{names\_to =} \StringTok{"구분"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"선박수"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ 년월, }\AttributeTok{y =}\NormalTok{ 선박수, }\AttributeTok{color =}\NormalTok{ 구분)) }\SpecialCharTok{+}
    \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"침몰 유보트와 침몰 선박수 추세"}\NormalTok{,}
         \AttributeTok{x =} \StringTok{""}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"침몰선박수"}\NormalTok{,}
         \AttributeTok{caption =} \StringTok{"자료출처: uboats.net"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"blue"}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{u_boats_files/figure-pdf/unnamed-chunk-10-1.pdf}

}

\end{figure}

\hypertarget{uxd504uxb85cuxc774uxc13c-uxae30uxbcd1}{%
\chapter{프로이센 기병}\label{uxd504uxb85cuxc774uxc13c-uxae30uxbcd1}}

\hypertarget{uxad50uxd1b5uxc0acuxace0}{%
\section{교통사고}\label{uxad50uxd1b5uxc0acuxace0}}

포아송은 미래에 발생할 경우의 수를 예측하기 위해서 포아송 분포를
창안했다. 좀더 구체적으로 고정된 시간 범위에 발생할 사건을 예측하기
위해서다.

한가지 사례로 한국 R 사용자회 페이스북 그룹에 매주 페이스북 게시글을
올리는데 좋아요를 누르는 평균 회원수가 10명이다. 새로운 페이스북
게시글을 올렸는데 좋아요를 누른 회원이 15명이 될 확률은 얼마나 될까?

이와 같이 다음주(미래) 좋아요를 누른(사건) 회원수가 15명(5, 10, 20,
\ldots)이 될 확률을 알고 싶은 것이다.

\hypertarget{uxd3ecuxc544uxc1a1-uxbd84uxd3ec-uxc218uxb834}{%
\subsection{포아송 분포
수렴}\label{uxd3ecuxc544uxc1a1-uxbd84uxd3ec-uxc218uxb834}}

다음 조건을 만족할 때 이항분포가 포아송 분포로 수렴되어 근사할 수 있다.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  시행 횟수 \(n\) 이 매우 크다.
\item
  성공 확률 \(p\) 가 매우 작다.
\item
  따라서, \(\lambda = n \times p\) 가 일정하다.
\end{enumerate}

이항분포 \(Bin(n, p)\)는 포아송 분포 \(Poi(\lambda)\)에 근사한다.

전체 제품 중에서 고장확률이 매우 작은 전자제품을 사례로 들어보자. 예를
들어, 어떤 공장에서 10,000개의 제품을 제조했을 때, 각 제품이 고장날
확률이 0.0001이라고 가정하면 이항분포로 전체 제품 중 1개 고장확률을
계산할 수 있지만, 제품 수가 매우 크고 고장 확률이 매우 작기 때문에
\(\lambda = np = 10,000 \times 0.0001 = 1\)를 갖는 포아송 분포를
사용하여 근사할 수 있다.

\hypertarget{uxc6d4uxac04-uxad50uxd1b5uxc0acuxace0}{%
\subsection{월간 교통사고}\label{uxc6d4uxac04-uxad50uxd1b5uxc0acuxace0}}

한 도시의 주요 교차로에서, 지난 1년 동안의 데이터를 기반으로 하루 평균
3건의 교통 사고가 발생했다고 가정하자. 이 정보를 바탕으로 특정 날에 교통
사고가 발생할 횟수의 확률 분포를 예측해보자.

포아송 분포의 평균은 \(\lambda\)이며, 이 경우에는 하루 평균 교통 사고
횟수인 3으로 설정할 수 있다.

이제 포아송 분포의 확률 질량 함수를 사용하여, 특정 날에 교통 사고가 k번
발생할 확률을 계산할 수 있다.

\[
P(X=k) = \frac{\lambda^k e^{-\lambda}}{k!}
\]

여기서, \(e\)는 자연상수입니다.

예를 들어, 특정 날에 교통 사고가 정확히 2번 발생할 확률을 계산하려면:

\[P(X=2) = \frac{3^2 e^{-3}}{2!} = 0.224\]

한걸음 더 들어가 실세
\href{https://taas.koroad.or.kr/}{교통사고분석시스템(TAAS)} 웹사이트에서
2022년 월별 교통사고 데이터를 얻을 수 있다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(readxl)}

\NormalTok{accident\_raw }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/2022년\_월별\_교통사고.xlsx"}\NormalTok{, }\AttributeTok{sheet =} \StringTok{"2022년도 월별 교통사고"}\NormalTok{, }\AttributeTok{skip =} \DecValTok{2}\NormalTok{)}

\NormalTok{accident\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ accident\_raw }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{(}\AttributeTok{ascii =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(월, 사고건수 }\OtherTok{=}\NormalTok{ 사고건수\_건) }

\NormalTok{accident\_tbl}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 12 x 2
   월    사고건수
   <chr>    <dbl>
 1 01월     15894
 2 02월     12362
 3 03월     13620
 4 04월     16472
 5 05월     18065
 6 06월     16481
 7 07월     17115
 8 08월     16496
 9 09월     17216
10 10월     18508
11 11월     17578
12 12월     17029
\end{verbatim}

월별 평균 사고건수를 \texttt{mean()} 함수를 사용해서 계산할 수 있다.
교통량은 상당히 크고, 교통사고 확률은 매우 낮기 때문에 포아송 분포로
근사를 하는 것이 가능하다. 교통사고 건수가 많기 때문에 단위를 천대
기준으로 조정하여 포아송 분포 모수 \(\lambda\)를 계산한다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{accident\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(accident\_tbl}\SpecialCharTok{$}\NormalTok{사고건수) }\SpecialCharTok{/} \DecValTok{1000}

\NormalTok{accident\_mean}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 16.403
\end{verbatim}

월별로 2만대 이상 교통사고가 발생될 경우 교통사고 환자수가 급증하여
병원에 큰 부하가 걸려 사회적 문제가 된다는 가정하에 월별로 2만대 이상
교통사고가 발생할 확률을 계산해보자.

\(P(X \geq 20)\) 확률값은 전체 경우의 수에서 0 \textasciitilde{} 1.9
만대 사고건수가 발생할 확률을 빼주면 계산이 가능하고 다음과 같이
수식으로 표현할 수 있다.

\[
P(X \geq 20) = 1 - (P(X=0) + P(X=1) + \ldots + P(X=19))
\]

이를 R 코드로 작성하면 다음과 같이 함수형 프로그래밍 \texttt{purrr}
패키지 \texttt{map\_dbl()} 함수와 포아송 함수에 \(\lambda = 16.403\)를
넣어 계산이 가능하거나 내장 함수 \texttt{ppois()}로 직접 동일한
계산작업을 수행할 수 있다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}

\NormalTok{accident\_prob }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{sum}\NormalTok{(}\FunctionTok{map\_dbl}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{19}\NormalTok{, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ (accident\_mean}\SpecialCharTok{\^{}}\NormalTok{.x }\SpecialCharTok{*} \FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{accident\_mean)) }\SpecialCharTok{/} \FunctionTok{factorial}\NormalTok{(.x)))}
\CommentTok{\# 1 {-} ppois(19, lambda = 16.403)}

\NormalTok{accident\_prob}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.2169535
\end{verbatim}

\hypertarget{uxd504uxb85cuxc774uxc13c-uxae30uxbcd1-uxc0acuxb9dduxc790}{%
\section{프로이센 기병
사망자}\label{uxd504uxb85cuxc774uxc13c-uxae30uxbcd1-uxc0acuxb9dduxc790}}

프로이센 기병대에서 말 발길질로 사망한 병사의 수를 1875년부터
1894년까지, 14개의 기병 군단을 대상으로 수집한
데이터(\href{https://www.randomservices.org/random/data/HorseKicks.html}{Prussian
Horse-Kick Data})가 포아송 분포에 잘 적합되는 것으로 유명하다.

\includegraphics{images/horse_kicks.jpg}

원본 데이터를 디지털로 복원한 후에 고정된 기간 말 발차기 사망자수를
빈도통계를 통해 표로 정리할 수 있다. 총 관측 횟수는
\(14 \times 20 = 280\) (즉, 1875년부터 1894년까지 20년간 프로이센 군단
14개를 관측), 총 사망자 병사수가 196명으로부터 평균 사망병사수를
\(\lambda = \frac{196}{280} = 0.7\) 으로 계산할 수 있다. 다음으로
포아송분포에 적합시켜서 분포로부터 말 발차기 사망자수 빈도수를 계산한다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(rvest)}
\FunctionTok{library}\NormalTok{(gt)}
\FunctionTok{library}\NormalTok{(gtExtras)}

\NormalTok{kick\_raw }\OtherTok{\textless{}{-}} \FunctionTok{read\_html}\NormalTok{(}\AttributeTok{x =} \StringTok{\textquotesingle{}https://www.randomservices.org/random/data/HorseKicks.html\textquotesingle{}}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_node}\NormalTok{(}\StringTok{"table"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_table}\NormalTok{()}

\CommentTok{\# kick\_raw |\textgreater{} }
\CommentTok{\#   write\_csv("data/horse\_kick.csv")}

\NormalTok{kick\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ kick\_raw }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Year, }\AttributeTok{names\_to =} \StringTok{"군단"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"병사수"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(사망횟수 }\OtherTok{=}\NormalTok{ 병사수, }\AttributeTok{name =} \StringTok{"빈도수"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(사망자수 }\OtherTok{=}\NormalTok{ 사망횟수 }\SpecialCharTok{*}\NormalTok{ 빈도수)  }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(포아송적합 }\OtherTok{=} \FunctionTok{map\_dbl}\NormalTok{(사망횟수, dpois, }\AttributeTok{lambda =} \DecValTok{196}\SpecialCharTok{/}\DecValTok{280}\NormalTok{) }\SpecialCharTok{*} \DecValTok{280}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(포아송적합 }\OtherTok{=} \FunctionTok{round}\NormalTok{(포아송적합, }\AttributeTok{digits =} \DecValTok{0}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{adorn\_totals}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"row"}\NormalTok{), }\AttributeTok{name =} \StringTok{"합계"}\NormalTok{)}

\NormalTok{kick\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt\_theme\_538}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{cols\_align}\NormalTok{(}\StringTok{"center"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  gt}\SpecialCharTok{::}\FunctionTok{tab\_spanner}\NormalTok{(}\AttributeTok{label =} \StringTok{"데이터"}\NormalTok{, }
                  \AttributeTok{columns =} \FunctionTok{c}\NormalTok{(사망횟수, 빈도수))}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{cccc}
\toprule
\multicolumn{2}{c}{데이터} &  &  \\ 
\cmidrule(lr){1-2}
사망횟수 & 빈도수 & 사망자수 & 포아송적합 \\ 
\midrule
0 & 144 & 0 & 139 \\ 
1 & 91 & 91 & 97 \\ 
2 & 32 & 64 & 34 \\ 
3 & 11 & 33 & 8 \\ 
4 & 2 & 8 & 1 \\ 
합계 & 280 & 196 & 279 \\ 
\bottomrule
\end{longtable*}

시각적으로 실제 관측한 빈도수와 포아송 분포로부터 추정한 값을 함께 겹칠
경우 일부 차이가 있긴 하지만 대체로 포아송 분포에 잘 적합됨을 확인할 수
있다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{kick\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(사망횟수 }\SpecialCharTok{!=} \StringTok{"합계"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ 사망횟수, }\AttributeTok{xend =}\NormalTok{ 사망횟수, }\AttributeTok{y =} \DecValTok{0}\NormalTok{, }\AttributeTok{yend=}\NormalTok{빈도수),}
                 \AttributeTok{linewidth=} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(사망횟수, 포아송적합), }\AttributeTok{size=}\DecValTok{3}\NormalTok{, }\AttributeTok{color=}\StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"말 발차기로 사망한 병사 수"}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"빈도수"}\NormalTok{,}
         \AttributeTok{title =} \StringTok{"말 발길질로 인한 프로이센 병사 사망"}\NormalTok{,}
         \AttributeTok{subtitle =} \StringTok{"실제 관측 데이터와 포아송분포 적합 기대값"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_prussia_files/figure-pdf/unnamed-chunk-5-1.pdf}

}

\end{figure}

\hypertarget{v2-rocket}{%
\section{런던 투하 V2 로켓}\label{v2-rocket}}

2차 세계대전 중 독일은 신형 무기 V1, V2 로켓을 개발하여 전쟁 막판에 영국
런던을 폭격하여 반전을 노렸다. 독일 신형폭탄의 공격을 받은 영국에서는
독일에서 발사한 신형 폭탄이 정밀 타격한 것인지 아니면 무작위로 대충
발사를 한 것인지 데이터를 통해 검정을 하고자 한다. \footnote{\href{}{R.
  D. Clarke, ``An Application of the Poisson Distribution,'' Journal of
  the Institute of Actuaries, Vol. 72 (1946), p.~481; V-2}} \footnote{\href{http://data.princeton.edu/wws509/notes/c4s1.html}{Generalized
  Linear Models - 4. Poisson Models for Count Data}}

\hypertarget{v2-data}{%
\subsection{데이터}\label{v2-data}}

가장 먼저 데이터를 준비한다. 데이터는
\href{https://www.actuaries.org.uk/system/files/documents/pdf/0481.pdf}{R.D.
Clarke, ``An Applicatin of the Poisson Distribution''}을 참조한다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 1. 기본 데이터 {-}{-}{-}{-}{-}{-}{-}{-}{-} }

\NormalTok{bombs }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"0 개"}\NormalTok{,}\StringTok{"1 개"}\NormalTok{, }\StringTok{"2 개"}\NormalTok{,}\StringTok{"3 개"}\NormalTok{,}\StringTok{"4 개"}\NormalTok{,}\StringTok{"5 개 이상"}\NormalTok{)}
\NormalTok{hit }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{229}\NormalTok{, }\DecValTok{211}\NormalTok{, }\DecValTok{93}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{expected }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{226.74}\NormalTok{, }\FloatTok{211.39}\NormalTok{, }\FloatTok{98.54}\NormalTok{, }\FloatTok{30.62}\NormalTok{, }\FloatTok{7.14}\NormalTok{, }\FloatTok{1.57}\NormalTok{)}

\NormalTok{bomb\_df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(bombs, hit, expected)}
\NormalTok{bomb\_df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt\_theme\_538}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{lrr}
\toprule
bombs & hit & expected \\ 
\midrule
0 개 & 229 & 226.74 \\ 
1 개 & 211 & 211.39 \\ 
2 개 & 93 & 98.54 \\ 
3 개 & 35 & 30.62 \\ 
4 개 & 7 & 7.14 \\ 
5 개 이상 & 1 & 1.57 \\ 
\bottomrule
\end{longtable*}

\hypertarget{v2-poisson}{%
\subsection{포아송 분포}\label{v2-poisson}}

런던에 떨어진 폭탄이 포아송 분포, 즉 무작위로 떨어진 것이라고 가정하고
시각화를 한다. 포아송 분포는 모수가 \(\lambda\) 하나만 추정하면 되기
때문에 데이터에서 모수를 추정한다.

\[P(\text{ 해당 구간에서 발생한 k개 사건(k events in interval)}) = e^{-\lambda}\frac{\lambda^k}{k!}\]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 2. 포아송 분포 {-}{-}{-}{-}{-}{-}{-}{-}{-} }

\NormalTok{hit }\OtherTok{\textless{}{-}} \DecValTok{537}
\NormalTok{area }\OtherTok{\textless{}{-}} \DecValTok{576}

\NormalTok{(lambda }\OtherTok{\textless{}{-}}\NormalTok{ hit}\SpecialCharTok{/}\NormalTok{area)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.9322917
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(bomb\_df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{bombs,}\AttributeTok{xend=}\NormalTok{bombs, }\AttributeTok{y=}\DecValTok{0}\NormalTok{, }\AttributeTok{yend=}\NormalTok{hit)) }\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\AttributeTok{size=}\FloatTok{1.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(bombs, expected), }\AttributeTok{size=}\DecValTok{2}\NormalTok{, }\AttributeTok{color=}\StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{"런던 지역에 투하된 폭탄 수"}\NormalTok{, }\AttributeTok{y=}\StringTok{"런던 지역 숫자"}\NormalTok{, }\AttributeTok{title=}\StringTok{"영국 런던에 떨어진 V2 로켓 폭탄"}\NormalTok{,}
       \AttributeTok{subtitle=}\StringTok{"실제 투하 폭탄수와 포아송 분포로 추정한 폭탄수"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_prussia_files/figure-pdf/v2-viz-1.pdf}

}

\end{figure}

모수(\(\lambda\))는 0.9322917로 추정된다. 이를 실제 데이터와 포아송
분포에서 나온 데이터와 겹쳐 시각화한다.

예를 들어, 폭탄이 투하되지 않을 확률은 다음과 같다.

\[P(x=0) = e^{-0.9322917}\frac{0.9322917^0}{0!} = 0.3936506\]

이를 R 코드로 표현하면 다음과 같다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lambda}\SpecialCharTok{\^{}}\DecValTok{0} \SpecialCharTok{*}\FunctionTok{exp}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{lambda) }\SpecialCharTok{/} \FunctionTok{factorial}\NormalTok{(}\DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 0.3936506
\end{verbatim}

\hypertarget{v2-goodness-of-fit}{%
\subsection{가설 검정}\label{v2-goodness-of-fit}}

시각적으로 살펴봤지만, 통계적 가설검정을 통해 다시 한번 런던에 투척된
폭탄이 포아송 분포를 따르는 것인지 검정해본다.

\begin{itemize}
\tightlist
\item
  귀무가설(\(H_0\)): 런던에 투하된 폭탄은 무작위로 떨어진 것이다. 즉,
  폭탄이 떨어진 분포는 포아송 분포다.
\item
  대립가설(\(H_A\)): 폭탄이 떨어진 것은 의도를 갖고 특정지역에 투하된
  것이다.
\end{itemize}

유의수준을 설정하고 검정통계량 \(\chi^2\)을 정의해서 계산하면 귀무가설을
채택하게 된다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 3. 통계적 검정 {-}{-}{-}{-}{-}{-}{-}{-}{-} }

\FunctionTok{chisq.test}\NormalTok{(bomb\_df}\SpecialCharTok{$}\NormalTok{hit, }\AttributeTok{p=}\NormalTok{bomb\_df}\SpecialCharTok{$}\NormalTok{expected, }\AttributeTok{rescale.p=}\ConstantTok{TRUE}\NormalTok{, }\AttributeTok{simulate.p.value=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

    Chi-squared test for given probabilities with simulated p-value (based
    on 2000 replicates)

data:  bomb_df$hit
X-squared = 1.1709, df = NA, p-value = 0.951
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 4. 최종 데이터 {-}{-}{-}{-}{-}{-}{-}{-}{-}}

\NormalTok{bomb\_df}\SpecialCharTok{$}\NormalTok{r\_expected }\OtherTok{\textless{}{-}} \DecValTok{573} \SpecialCharTok{*} \FunctionTok{c}\NormalTok{( }\FunctionTok{dpois}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, lambda), }\DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{sum}\NormalTok{(}\FunctionTok{dpois}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, lambda)))}

\NormalTok{bomb\_df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{gt}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{gt\_theme\_538}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{longtable*}{lrrr}
\toprule
bombs & hit & expected & r\_expected \\ 
\midrule
0 개 & 229 & 226.74 & 225.561771 \\ 
1 개 & 211 & 211.39 & 210.289359 \\ 
2 개 & 93 & 98.54 & 98.025509 \\ 
3 개 & 35 & 30.62 & 30.462788 \\ 
4 개 & 7 & 7.14 & 7.100051 \\ 
5 개 이상 & 1 & 1.57 & 1.560522 \\ 
\bottomrule
\end{longtable*}

\hypertarget{v2-spatial}{%
\subsection{지리정보를 통한 이해}\label{v2-spatial}}

공간정보를 활용한 사례로 이를 공간정보에 시각화하면 다음과 같다. 물론
정확한 데이터가 없어 런던 남부에 떨어진 폭탄이 포아송 분포를 따른다고
가정하고 576개 구획으로 나눈 것에 임의로 폭탄이 떨어진 것을 시각화하면
다음과 같다.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 5. 지리정보 {-}{-}{-}{-}{-}{-}{-}{-}{-}}
\FunctionTok{library}\NormalTok{(spatstat)}
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{4}\NormalTok{))}

\CommentTok{\# 24*24 = 576}
\NormalTok{south\_london }\OtherTok{\textless{}{-}} \FunctionTok{rpoispp}\NormalTok{(lambda, }\AttributeTok{win =} \FunctionTok{owin}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{24}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{24}\NormalTok{)))}
\FunctionTok{plot}\NormalTok{(south\_london, }\AttributeTok{main=}\StringTok{""}\NormalTok{, }\AttributeTok{cex=}\FloatTok{0.5}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h =} \DecValTok{0}\SpecialCharTok{:}\DecValTok{24}\NormalTok{, }\AttributeTok{v =} \DecValTok{0}\SpecialCharTok{:}\DecValTok{24}\NormalTok{, }\AttributeTok{col =} \StringTok{"lightgray"}\NormalTok{, }\AttributeTok{lty =} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_prussia_files/figure-pdf/v2-spatial-viz-1.pdf}

}

\end{figure}

포아송 분포를 가정하고 통계적 검정도 물론 가능하다. \texttt{spatstat}
팩키지의 함수를 활용하여 통계적 검정을 해도 동일한 결론에 도달하게 된다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bomb\_test }\OtherTok{\textless{}{-}} \FunctionTok{quadrat.test}\NormalTok{(south\_london, }\AttributeTok{nx =} \DecValTok{24}\NormalTok{, }\AttributeTok{ny =} \DecValTok{24}\NormalTok{, }\AttributeTok{method=}\StringTok{"Chisq"}\NormalTok{)}
\NormalTok{bomb\_test}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

    Chi-squared test of CSR using quadrat counts

data:  south_london
X2 = 536.7, df = 575, p-value = 0.256
alternative hypothesis: two.sided

Quadrats: 24 by 24 grid of tiles
Tessellation is marked
\end{verbatim}

\hypertarget{uxb3c5uxc77c-uxd0f1uxd06c-uxbb38uxc81c}{%
\chapter{독일 탱크 문제}\label{uxb3c5uxc77c-uxd0f1uxd06c-uxbb38uxc81c}}

2차 세계대전에서 탱크는 전술적 전략의 중심 요소로 부상했다.
\textbf{전격전(Blitzkrieg)} 같은 기동 전술에서 빠른 전진과 방어선 돌파
능력은 전투흐름을 크게 바꿨다. 강한 화력과 갑옷 보호로 인해 탱크는
전선에서 공격 및 병력 지원에 매우 효과적이었고, 탱크의 존재만으로도 적의
사기를 떨어뜨리는 심리적 효과가 컸을 뿐만 아니라, 독일 Tiger와 Panther
탱크, 소련 T-34와 IS 시리즈와 같은 혁신적인 설계를 적용한 기술발전도
눈부셨다.

2차 세계대전 전후 독일에서 선보인 전격전의 핵심전력으로 활약한 탱크를
연도별로 정리하면 다음과 같다.

\begin{figure}[H]

{\centering \includegraphics[width=3.17in,height=9.1in]{cs_german_tank_files/figure-latex/mermaid-figure-1.png}

}

\end{figure}

위키백과
\href{https://en.wikipedia.org/wiki/Military_production_during_World_War_II}{Military
production during World War II} 웹사이트에서 제2차 세계대전 국가별 탱크
및 SPG 생산량을 확인할 수 있다. 독일이 팬저 및 타이거 등 고성능 탱크를
생산했지만 생산대수에서 연합국에 한참 밀린 것이 확인된다.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(rvest)}
\FunctionTok{library}\NormalTok{(ggrepel)}

\NormalTok{tank\_html }\OtherTok{\textless{}{-}} \FunctionTok{read\_html}\NormalTok{(}\AttributeTok{x =} \StringTok{\textquotesingle{}https://en.wikipedia.org/wiki/Military\_production\_during\_World\_War\_II\textquotesingle{}}\NormalTok{)}

\NormalTok{tank\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ tank\_html }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_elements}\NormalTok{(}\StringTok{".wikitable"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  .[[}\DecValTok{5}\NormalTok{]] }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}tanks\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}power\textquotesingle{}}\NormalTok{))) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(탱크수}\OtherTok{=}\NormalTok{ tanks\_sp\_gs, 생산국가}\OtherTok{=}\NormalTok{power ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(탱크수 }\OtherTok{=} \FunctionTok{parse\_number}\NormalTok{(탱크수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{drop\_na}\NormalTok{()  }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(구분 }\OtherTok{=} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    생산국가 }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"British Empire"}\NormalTok{, }\StringTok{"USA and territories"}\NormalTok{, }\StringTok{"USSR"}\NormalTok{, }\StringTok{"Allies"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"연합국"}\NormalTok{,}
\NormalTok{    생산국가 }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"Germany and territories"}\NormalTok{, }\StringTok{"Hungary"}\NormalTok{, }\StringTok{"Romania"}\NormalTok{, }\StringTok{"Italian Empire"}\NormalTok{, }
\StringTok{"Japanese Empire"}\NormalTok{, }\StringTok{"Axis"}\NormalTok{) }\SpecialCharTok{\textasciitilde{}} \StringTok{"추축국"}
\NormalTok{  )) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{생산국가 }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"Allies"}\NormalTok{, }\StringTok{"Axis"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(생산국가 }\OtherTok{=} \FunctionTok{str\_remove}\NormalTok{(생산국가, }\StringTok{"( and territories)|( Empire)"}\NormalTok{))}

\NormalTok{tank\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_reorder}\NormalTok{(구분, 탱크수), }\AttributeTok{y =}\NormalTok{ 탱크수, }\AttributeTok{fill =}\NormalTok{ 생산국가)) }\SpecialCharTok{+}
    \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{coord\_flip}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{comma) }\SpecialCharTok{+}  
    \FunctionTok{geom\_text\_repel}\NormalTok{(}\AttributeTok{data =}\NormalTok{ tank\_tbl }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(구분 }\SpecialCharTok{==} \StringTok{"연합국"}\NormalTok{), }
              \FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ 생산국가), }\AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =}\NormalTok{ .}\DecValTok{4}\NormalTok{)) }\SpecialCharTok{+}
    \FunctionTok{geom\_text\_repel}\NormalTok{(}\AttributeTok{data =}\NormalTok{ tank\_tbl }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(구분 }\SpecialCharTok{==} \StringTok{"추축국"}\NormalTok{), }
              \FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ 생산국가), }\AttributeTok{position =} \FunctionTok{position\_stack}\NormalTok{(}\AttributeTok{vjust =}\NormalTok{ .}\DecValTok{4}\NormalTok{)) }\SpecialCharTok{+}  
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =}\StringTok{""}\NormalTok{,}
         \AttributeTok{y =} \StringTok{"생산 탱크수"}\NormalTok{,}
         \AttributeTok{title =} \StringTok{"제2차 세계대전 연합국과 추축국 탱크 생산대수 비교"}\NormalTok{,}
         \AttributeTok{caption =} \StringTok{"데이터 출처: 위키백과, https://en.wikipedia.org/wiki/Military\_production\_during\_World\_War\_II"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{()   }\SpecialCharTok{+}
    \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{scale\_fill\_brewer}\NormalTok{(}\AttributeTok{type =} \StringTok{"qual"}\NormalTok{, }\AttributeTok{palette =} \StringTok{"Set2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_german_tank_files/figure-pdf/unnamed-chunk-3-1.pdf}

}

\end{figure}

\begin{figure}

{\centering \includegraphics{images/german_tank.jpg}

}

\caption{위키백과 실린 독일 탱크공장}

\end{figure}

\hypertarget{uxc911uxc694uxc131}{%
\section{중요성}\label{uxc911uxc694uxc131}}

제2차 세계대전에서 독일 탱크 생산대수의 정확한 추정은 연합국의 전략적,
전술적 결정 및 심리적 전쟁을 주도하는 데 결정적인 역할을 했다.

독일의 탱크 생산능력은 그들의 군사 능력과 전쟁 지속 능력을 나타내는
중요한 지표였다. 이를 통해 연합국은 한정된 자원을 어떻게 효율적으로
사용할지 결정할 수 있었다. 만약 독일이 대규모의 탱크를 적극적으로 생산
중이라는 정보를 획득하면, 연합국은 빠르게 자신들의 탱크 생산을
증대시키거나 대탱크 무기의 개발에 투자하는 등의 전략적 대응을 준비했다.

탱크 생산대수와 탱크종류는 독일군이 다음에 취할 전략과 전술을 예측하는
데 귀중한 정보를 제공했다. 이러한 정보는 전장에서의 우위를 확보하고 적의
움직임을 선제적으로 차단하는 데 도움을 줬고, 심리적 측면에서도 탱크의
생산 정보는 중요했다. 독일의 실제 탱크 생산 능력을 과소 평가하거나 과대
평가하는 것은 연합국의 사기와 전략에 큰 영향을 미쳤다.

전쟁이 종료된 이후에도, 독일의 탱크 및 기타 군사 장비의 생산 정보는 평화
협정의 조건을 결정하는 데 중요한 자료로 활용되었으며, 독일의 잠재적 군사
능력을 평가하고 장래의 안전 보장을 위한 조치를 결정하는 데 필수적인
정보자산이 되었다.

\hypertarget{uxb370uxc774uxd130-uxc218uxc9d1}{%
\section{데이터 수집}\label{uxb370uxc774uxd130-uxc218uxc9d1}}

제2차 세계대전 중 독일 탱크의 시리얼 번호 획득은 연합국의 미묘한 정보
수집 작업 중 하나였다. 전투 중 파괴되거나 포획된 독일 탱크들은 대부분
고유의 시리얼 번호가 달려있었으며, 시리얼 번호는 탱크 생산 순서와
일련번호를 나타냈기 때문에, 연합국은 이러한 번호를 꼼꼼히 수집했다.
파손된 탱크 부품에서도 이러한 번호를 발견할 수 있었고, 이를 통해 전체
탱크 생산 규모의 일부를 엿볼 수 있었다. 이런 정보들은 전쟁 중 독일의
탱크 생산 능력을 추정하는 데 매우 중요한 열쇠로 작용했다.

\begin{figure}

{\centering \includegraphics[width=6.29167in,height=\textheight]{images/german_tank_serial.jpg}

}

\end{figure}

\hypertarget{uxc6d4uxbcc4-uxd0f1uxd06cuxc0dduxc0b0uxb300uxc218}{%
\section{월별
탱크생산대수}\label{uxc6d4uxbcc4-uxd0f1uxd06cuxc0dduxc0b0uxb300uxc218}}

제2차 세계대전 기간 독일 탱크의 생산 대수를 분석한 표에 따르면, 다양한
추정치와 실제 생산된 탱크의 수를 비교할 수 있다. 1940년 6월에는 통계적
방법을 통해 169대의 탱크가 생산되었다고 추정되었으나, 정보기관은
1,000대로 추정했다. 그러나 실제로는 122대만 생산되었다. 이어서 1941년
6월에는 통계적으로는 244대, 정보기관에서는 1,550대로 추정되었고,
실제로는 271대가 생산되었다. 마지막으로 1942년 8월에는 통계적 추정치가
327대, 정보기관의 추정치가 1,550대로 나왔으며, 실제 생산된 탱크는
342대였다. 이를 통해 보면, 통계적 방법으로 추정한 생산 대수가 정보기관의
추정보다 실제 생산량에 더 가까웠음을 알 수 있다.

\begin{longtable}[]{@{}cccc@{}}
\toprule\noalign{}
년월 & 통계 추정 & 정보기관 추정 & 독일 생산대수 \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1940년 6월 & 169 & 1,000 & 122 \\
1941년 6월 & 244 & 1,550 & 271 \\
1942년 8월 & 327 & 1,550 & 342 \\
\end{longtable}

\hypertarget{uxd1b5uxacc4-uxcd94uxc815uxbc29uxbc95}{%
\section{통계 추정방법}\label{uxd1b5uxacc4-uxcd94uxc815uxbc29uxbc95}}

MLE를 사용하여 독일 탱크의 총 생산 수를 추정하는 방법은 관측된 탱크의
일련 번호 간의 평균 간격을 기준으로 한다.

예를 들어, 탱크 \(k\) 대를 관측했을 때, 가장 큰 일련 번호가 \(m\)이면,
평균적으로 탱크 사이의 간격은 \(\frac{m}{k}\)이다. 이 간격을 기반으로,
번호 \(m\) 이후에 아직 관측되지 않은 탱크는 대략 \(\frac{m}{k}\) 대가 더
있을 것으로 예상된다.

이 정보를 토대로, 전체 탱크 수에 대한 추정치 \(N\)는 다음의 공식으로
구할 수 있다:

\[
N_{\text{추정치}} = m + \frac{m}{k} - 1
\]

독일군에서 5대의 탱크를 포획하였다고 상상해보자. 포획한 탱크의 일련
번호는 2, 5, 7, 20, 그리고 31이다. 여기서, 최대 일련 번호 \(m\)은
31이고, 포획된 탱크의 총 수 \(k\)는 5대이다.

이 정보를 사용하여 탱크의 총 생산 수 \(N\)을 추정하면:

\[
N_{\text{추정치}} = m + \frac{m}{k} - 1 = 31 + \frac{31}{5} - 1
\]

따라서, \(N_{\text{추정}}\)의 값은 36.2로, 총 탱크 수는 대략 36 또는
37대로 추정될 수 있다.

\hypertarget{uxd3eduxaca9uxbe44uxd589uxae30}{%
\chapter{폭격비행기}\label{uxd3eduxaca9uxbe44uxd589uxae30}}

\href{http://www.andrewclem.com/War/}{andrewclem} 웹사이트에 2차
세계대전 유럽전선과 태평양전선에 대한 전황지도가 공개되어 있어 이를
연도별로 취합하여 \texttt{.gif} 파일로 제작한다.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{europe\_names }\OtherTok{\textless{}{-}}\NormalTok{ glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"Europe\_\{1939:1945\}"}\NormalTok{)}
\NormalTok{pacific\_names }\OtherTok{\textless{}{-}}\NormalTok{ glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"Pacific\_\{c(1937, 1939, 1941:1945)\}"}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(europe\_names)) \{}
  \CommentTok{\# cat(europe\_names[i], "\textbackslash{}n")}
  \CommentTok{\# download.file(url = glue::glue("http://www.andrewclem.com/War/Maps/\{europe\_names[i]\}.gif"),}
  \CommentTok{\#             destfile = glue::glue("\{here::here()\}/fig/world\_war/\{europe\_names[i]\}.png"), mode = "wb" )}
  \FunctionTok{cat}\NormalTok{(pacific\_names[i], }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{download.file}\NormalTok{(}\AttributeTok{url =}\NormalTok{ glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"http://www.andrewclem.com/War/Maps/\{pacific\_names[i]\}.gif"}\NormalTok{),}
              \AttributeTok{destfile =}\NormalTok{ glue}\SpecialCharTok{::}\FunctionTok{glue}\NormalTok{(}\StringTok{"\{here::here()\}/fig/world\_war/\{pacific\_names[i]\}.png"}\NormalTok{), }\AttributeTok{mode =} \StringTok{"wb"}\NormalTok{ )}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(magick)}

\NormalTok{world\_war\_files }\OtherTok{\textless{}{-}}\NormalTok{ fs}\SpecialCharTok{::}\FunctionTok{dir\_ls}\NormalTok{(}\AttributeTok{path =} \StringTok{"fig/world\_war"}\NormalTok{, }\AttributeTok{glob =} \StringTok{"*.png"}\NormalTok{)}

\NormalTok{europe\_files }\OtherTok{\textless{}{-}}\NormalTok{ world\_war\_files[}\FunctionTok{str\_detect}\NormalTok{(world\_war\_files, }\StringTok{"Europe"}\NormalTok{)]}
\NormalTok{pacific\_files }\OtherTok{\textless{}{-}}\NormalTok{ world\_war\_files[}\SpecialCharTok{!}\FunctionTok{str\_detect}\NormalTok{(world\_war\_files, }\StringTok{"Europe"}\NormalTok{)]}

\DocumentationTok{\#\# 유럽 전황 }
\NormalTok{europe\_m }\OtherTok{\textless{}{-}}\NormalTok{ magick}\SpecialCharTok{::}\FunctionTok{image\_read}\NormalTok{(pacific\_files[}\DecValTok{1}\NormalTok{])}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(europe\_files)) \{}
\NormalTok{  europe\_m }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(europe\_m, magick}\SpecialCharTok{::}\FunctionTok{image\_read}\NormalTok{(europe\_files[i]))}
\NormalTok{\}}

\NormalTok{europe\_ani }\OtherTok{\textless{}{-}}\NormalTok{ magick}\SpecialCharTok{::}\FunctionTok{image\_animate}\NormalTok{(europe\_m, }\AttributeTok{fps =} \DecValTok{1}\NormalTok{, }\AttributeTok{loop =} \DecValTok{0}\NormalTok{, }\AttributeTok{dispose =} \StringTok{"previous"}\NormalTok{)}
\NormalTok{magick}\SpecialCharTok{::}\FunctionTok{image\_write}\NormalTok{(europe\_ani, }\StringTok{"fig/world\_war\_europe.gif"}\NormalTok{)}

\DocumentationTok{\#\# 태평양 전황 }
\NormalTok{pacific\_m }\OtherTok{\textless{}{-}}\NormalTok{ magick}\SpecialCharTok{::}\FunctionTok{image\_read}\NormalTok{(pacific\_files[}\DecValTok{1}\NormalTok{])}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(pacific\_files)) \{}
\NormalTok{  pacific\_m }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(pacific\_m, magick}\SpecialCharTok{::}\FunctionTok{image\_read}\NormalTok{(pacific\_files[i]))}
\NormalTok{\}}

\NormalTok{pacific\_ani }\OtherTok{\textless{}{-}}\NormalTok{ magick}\SpecialCharTok{::}\FunctionTok{image\_animate}\NormalTok{(pacific\_m, }\AttributeTok{fps =} \DecValTok{1}\NormalTok{, }\AttributeTok{loop =} \DecValTok{0}\NormalTok{, }\AttributeTok{dispose =} \StringTok{"previous"}\NormalTok{)}
\NormalTok{magick}\SpecialCharTok{::}\FunctionTok{image\_write}\NormalTok{(pacific\_ani, }\StringTok{"fig/world\_war\_pacific.gif"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{uxc138uxacc4uxb300uxc804}{%
\section{세계대전}\label{uxc138uxacc4uxb300uxc804}}

\hypertarget{uxc720uxb7fduxc804uxc120}{%
\subsection{유럽전선}\label{uxc720uxb7fduxc804uxc120}}

\includegraphics{images/world_war_europe.gif}

\hypertarget{uxd0dcuxd3c9uxc591-uxc804uxc120}{%
\subsection{태평양 전선}\label{uxd0dcuxd3c9uxc591-uxc804uxc120}}

\includegraphics{images/world_war_pacific.gif}

\hypertarget{uxb300uxacf5uxd3ec}{%
\section{대공포}\label{uxb300uxacf5uxd3ec}}

\url{https://www.youtube.com/embed/48zE-hRAYEA}

\hypertarget{uxd3eduxaca9uxae30-uxb370uxc774uxd130}{%
\section{폭격기 데이터}\label{uxd3eduxaca9uxae30-uxb370uxc774uxd130}}

생존자 편향(Survivorship Bias)의 오류는 실패한 사례나 숨겨진 요인을
고려하지 않고 오직 `생존' 혹은 `성공' 사례만을 분석하여 일반화하는
과정에서 발생하여 데이터나 결과 해석을 왜곡시킬 수 있다.

아브라함 왈드(Abraham Wald)는 제2차 세계대전 동안 컬럼비아 대학
통계연구그룹(Statistical Research Group)에서 일했다. 전투기와 같은 군사
장비가 적으로부터 얼마나 많은 피해를 입을 수 있는지에 대한 분석을
수행했으며, 특히 \textbf{`생존자 편향(Survivorship Bias)'} 문제를 고려한
통계적 방법을 제안하여 중요한 기여를 했다.

전투기가 전투에서 돌아올 때 어떤 부분이 가장 많이 손상되는지에 대한
데이터가 있었다. 대부분의 사람들은 데이터를 보고 손상이 가장 많이 발생한
부분을 강화해야 한다고 생각했지만, 왈드는 이와는 반대의 접근을 택했는데,
돌아오지 못한 전투기에 대한 데이터가 누락되어 있으므로, 이를 고려하지
않으면 편향된 결론을 내릴 수 있다고 지적했다. 즉, 손상이 적게 발생한
부분이 전투기 귀환에 오히려 더 중요할 수 있다는 것이다.

\begin{figure}

{\centering \includegraphics[width=6.98958in,height=\textheight]{images/Survivorship-bias.png}

}

\caption{귀환한 폭격기 피탄 위치}

\end{figure}

전폭기를 크게 4가지 부분으로 나눠 데이터를 임의로 생성해보자.

\begin{itemize}
\tightlist
\item
  Wing\_Hits : 전폭기 날개
\item
  Fuselage\_Hits : 전폭기 주 몸체
\item
  Engine\_Hits : 전폭기 엔진
\item
  Cockpit\_Hits : 전폭기 조종석
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# tidyverse 패키지 불러오기}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# 난수 생성을 위한 seed 설정}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# 100대의 전투기 데이터 생성}
\NormalTok{n\_planes }\OtherTok{\textless{}{-}} \DecValTok{100}

\CommentTok{\# 데이터프레임 생성}
\NormalTok{plane\_raw }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{Plane\_ID =} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n\_planes,}
  \AttributeTok{Wing\_Hits =} \FunctionTok{sample}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{20}\NormalTok{, n\_planes, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{Fuselage\_Hits =} \FunctionTok{sample}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, n\_planes, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{Engine\_Hits =} \FunctionTok{sample}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, n\_planes, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{Cockpit\_Hits =} \FunctionTok{sample}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, n\_planes, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{) }
  
\NormalTok{plane\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ plane\_raw }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Plane\_ID, }\AttributeTok{names\_to =} \StringTok{"피탄부위"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"피탄수"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(부위 }\OtherTok{=} \FunctionTok{case\_match}\NormalTok{(피탄부위,}
                         \StringTok{"Wing\_Hits"}     \SpecialCharTok{\textasciitilde{}} \StringTok{"날개"}\NormalTok{,}
                         \StringTok{"Fuselage\_Hits"} \SpecialCharTok{\textasciitilde{}} \StringTok{"주 몸체"}\NormalTok{,}
                         \StringTok{"Engine\_Hits"}   \SpecialCharTok{\textasciitilde{}} \StringTok{"엔진"}\NormalTok{,}
                         \StringTok{"Cockpit\_Hits"}  \SpecialCharTok{\textasciitilde{}} \StringTok{"조종석"}\NormalTok{))}

\CommentTok{\# 각 부위별 총 타격 수 계산}
\NormalTok{summary\_tbl }\OtherTok{\textless{}{-}}\NormalTok{ plane\_tbl }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(피탄부위, 부위) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(총피탄수 }\OtherTok{=} \FunctionTok{sum}\NormalTok{(피탄수)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(총피탄수))}

\NormalTok{summary\_tbl}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 4 x 3
# Groups:   피탄부위 [4]
  피탄부위      부위    총피탄수
  <chr>         <chr>      <int>
1 Wing_Hits     날개        1066
2 Fuselage_Hits 주 몸체      597
3 Engine_Hits   엔진         226
4 Cockpit_Hits  조종석       105
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# 계산 결과 확인}

\NormalTok{summary\_tbl }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_reorder}\NormalTok{(부위, 총피탄수), }\AttributeTok{y =}\NormalTok{ 총피탄수)) }\SpecialCharTok{+}
    \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{coord\_flip}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{x=}\StringTok{""}\NormalTok{,}
         \AttributeTok{title =} \StringTok{"제2차 세계대전 폭격기 부위별 피탄수"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =}\NormalTok{ scales}\SpecialCharTok{::}\NormalTok{comma)}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{cs_bomber_files/figure-pdf/unnamed-chunk-4-1.pdf}

}

\end{figure}

\hypertarget{uxbcf4uxac15}{%
\section{보강}\label{uxbcf4uxac15}}

날개(Wing) 부분이 가장 많이 타격을 받아 이 부분과 그 다음 주 몸체를
보강해야 된다고 볼 수도 있다. 이는 생존한 전투기만 고려한 전형적인
생존자 편향으로 실제로 엔진과 조종석을 보강해야 더 큰 효과를 볼 수 있다.

\begin{figure}

{\centering \includegraphics{images/survivorship_bias_plane.png}

}

\caption{폭격기 보강 전략}

\end{figure}

\bookmarksetup{startatroot}

\hypertarget{uxcc38uxace0uxbb38uxd5cc}{%
\chapter*{참고문헌}\label{uxcc38uxace0uxbb38uxd5cc}}
\addcontentsline{toc}{chapter}{참고문헌}

\markboth{참고문헌}{참고문헌}

\printbibliography[heading=none]




\end{document}
